(()=>{var t={6627:()=>{window.frag.Animation=function(e,t,n){const r={stopAfter:0,isRunning:!1},o=t||{};o.__private=r;const a=100;return o.dispose=function(){e.removeAnimation(o)},o.getIsRunning=function(){return r.isRunning},o.setDuration=function(e){return o.duration=e,o},o.setInterval=function(e){return o.interval=e,o},o.action=function(t,n,i){if(void 0!==r.stopAfter&&(r.stopAt=n+r.stopAfter,delete r.stopAfter),void 0!==r.stopAt&&n>=r.stopAt){if(r.sequence){let e=r.sequence[r.sequenceIndex];e&&e.stop&&e.stop(o,n)}return e.deactivateAnimation(o),r.disposeOnStop&&o.dispose(),void(r.isRunning=!1)}if(r.sequence){let e=r.sequence[r.sequenceIndex];r.nextStepTick?n>=r.nextStepTick&&(e.stop&&e.stop(o,n),r.sequenceIndex++,r.sequenceIndex===r.sequence.length?r.autoRestart?(r.sequenceIndex=0,e=r.sequence[r.sequenceIndex],e.start&&e.start(o,n),r.nextStepTick=n+(e.duration||a)):r.stopAt=n:(e=r.sequence[r.sequenceIndex],e.start&&e.start(o,n),o.interval=e.interval,r.nextStepTick=n+(e.duration||a))):(e.start&&e.start(o,n),r.nextStepTick=n+(e.duration||a)),r.action=e.action,o.nextGameTick=n+(e.interval||5)}else void 0!==r.frameRepeat?o.nextFrameTick=i+r.frameRepeat:void 0!==r.tickRepeat&&(o.nextGameTick=n+r.tickRepeat);r.action&&r.action(o,n,i)},o.sequence=function(e,t){Array.isArray(e)?r.sequence=e:r.sequence=[e],r.sequenceIndex=0,r.autoRestart=t;let n=0;for(let e=0;e<r.sequence.length;e++){const t=r.sequence[e];void 0!==t.duration?n+=t.duration:n+=a}return o.duration=n,o},o.perform=function(e,t){return o.sequence(e,t)},o.start=function(){return delete r.nextStepTick,delete r.stopAfter,delete r.stopAt,e.activateAnimation(o),r.isRunning=!0,o},o.stop=function(){return r.stopAfter=0,o},o.repeatTicks=function(e,t){return delete r.autoRestart,delete r.frameRepeat,delete r.sequence,r.tickRepeat=t||e.interval||20,r.action=e,o},o.repeatFrames=function(e,t){return delete r.autoRestart,delete r.tickRepeat,delete r.sequence,r.frameRepeat=t||1,r.action=e,o},o.stopAfter=function(e){return r.stopAfter=e,delete r.stopAt,o},o.disposeOnStop=function(e){return r.disposeOnStop=void 0===e||e,o},n||e.addAnimation(o),o}},4600:()=>{window.frag.KeyframeAnimationAction=function(e){const t={startTick:void 0,currentFrame:void 0,keyframes:{}},n={__private:t,interval:10,frames:100,start:function(e,r){return t.startTick=r,t.currentFrame=-1,n},action:function(e,r){let o=Math.floor((r-t.startTick)/n.interval);for(;t.currentFrame<o;){t.currentFrame++;const e=t.keyframes[t.currentFrame];if(e)for(let n=0;n<e.length;n++)e[n].action(t.currentFrame,e[n].data,r)}return n},setFrames:function(e,t){return n.interval=e,n.frames=t||n.frames,n.duration=n.interval*n.frames,n},add:function(e,r,o){let a=t.keyframes[e];return a||(a=[],t.keyframes[e]=a),a.push({action:r,data:o}),n},dispose:function(){}};return n}},5363:()=>{window.frag.ModelAnimation=function(e){const t={loop:!1,interval:10,frames:50,channelGraphs:[],name:""},n={__private:t,getChannelGraphs:function(){return t.channelGraphs},name:function(e){return t.name=e,n},getName:function(){return t.name},loop:function(e){return t.loop=e,n},getLoop:function(){return t.loop},interval:function(e){return t.interval=e,n},getInterval:function(){return t.interval},frames:function(e){return t.frames=e,n},getFrames:function(){return t.frames}},r=function(e){const n=[];let r;n.length=t.frames;let o=0;for(let a=0;a<t.frames;a++){const t=e[a];if(void 0!==t){if(r=t.value,"linear"===t.transition){const e=n[o],t=(r-e)/(a-o);for(let r=o+1;r<a;r++)n[r]=e+(r-o)*t}o=a}n[a]=r}return n};return n.addChannel=function(e){t.channelGraphs.push({pattern:e.pattern,channel:e.channel,frameValues:r(e.keyframes)})},n.dispose=function(){},n}},9023:()=>{window.frag.ObjectAnimationState=function(e){const t={__private:{},location:window.frag.Location(),getMatrix:function(){return t.location.getMatrix()},getUpdateFunction:function(e){switch(e){case"translate-x":return function(e){t.location.translateX=e,t.location.isModified=!0};case"translate-y":return function(e){t.location.translateY=e,t.location.isModified=!0};case"translate-z":return function(e){t.location.translateZ=e,t.location.isModified=!0};case"scale-x":return function(e){t.location.scaleX=e,t.location.isModified=!0};case"scale-y":return function(e){t.location.scaleY=e,t.location.isModified=!0};case"scale-z":return function(e){t.location.scaleZ=e,t.location.isModified=!0};case"rotate-x":return function(e){t.location.rotateX=e,t.location.isModified=!0};case"rotate-y":return function(e){t.location.rotateY=e,t.location.isModified=!0};case"rotate-z":return function(e){t.location.rotateZ=e,t.location.isModified=!0}}return console.warn("Unsupported animation channel "+e),function(){}},dispose:function(){}};return t}},9622:()=>{window.frag.ParallelAnimationAction=function(e,[t]){const n={actions:t},r={__private:n,duration:30,interval:5,setDuration:function(e){return r.duration=e,r},setInterval:function(e){return r.interval=e,r},start:function(e,t){return n.actions.forEach((n=>{n.start&&n.start(e,t)})),r},action:function(e,t){return n.actions.forEach((n=>{n.action&&n.action(e,t)})),r},stop:function(e,t){n.actions.forEach((n=>{n.stop&&n.stop(e,t)}))},dispose:function(){}};return r}},2201:()=>{window.frag.PositionAnimationAction=function(e,t,n,r){const o=window.frag.Vector,a={scenePosition:t,invLinearVelocity:n,invAngularVelocity:r,startLocation:void 0,startRotate:void 0,moveBy:void 0,rotateBy:void 0,moveTo:void 0,rotateTo:void 0},i={__private:a,setInterval:function(e){return i.interval=e,i},moveBy:function(e,t){t=t||a.invLinearVelocity||1;let n=o.length(e);return i.duration=Math.floor(t*n+1),a.moveBy=e,i},moveTo:function(e,t){return t&&(a.invAngularVelocity=void 0),a.invLinearVelocity=t||a.invLinearVelocity||1,a.moveTo=e,i},rotateBy:function(e,t){t=t||a.invAngularVelocity||10;let n=o.length(e);return i.duration=Math.floor(t*n+1),a.rotateBy=e,i},rotateTo:function(e,t){return t&&(a.invLinearVelocity=void 0),a.invAngularVelocity=t||a.invAngularVelocity||10,a.rotateTo=e,i},moveByXYZ:function(e,t,n,r){return i.moveBy([e,t,n],r)},moveByXY:function(e,t,n){return i.moveBy([e,t,0],n)},moveToXYZ:function(e,t,n,r){return i.moveTo([e,t,n],r)},moveToXY:function(e,t,n){return i.moveTo([e,t,0],n)},rotateByXYZ:function(e,t,n,r){return i.rotateBy([e,t,n],r)},rotateByXY:function(e,t,n){return i.rotateBy([e,t,0],n)},rotateToXYZ:function(e,t,n,r){return i.rotateTo([e,t,n],r)},rotateToXY:function(e,t,n){return i.rotateTo([e,t,0],n)},onStart:function(e){return a.onStart=e,i},onStop:function(e){return a.onStop=e,i},start:function(e,t){if(a.startLocation=a.scenePosition.getLocation(),a.startRotate=a.scenePosition.getRotate(),a.rotateTo&&a.invAngularVelocity){a.rotateDelta=function(e,t){const n=o.sub(e,t);for(let e=0;e<n.length;e++){for(;n[e]<-Math.PI;)n[e]+=2*Math.PI;for(;n[e]>Math.PI;)n[e]-=2*Math.PI}return n}(a.rotateTo,a.startRotate);const e=o.length(a.rotateDelta);i.duration=Math.floor(a.invAngularVelocity*e+1)}if(a.moveTo&&a.invLinearVelocity){a.moveDelta=(n=a.moveTo,r=a.startLocation,o.sub(n,r));const e=o.length(a.moveDelta);i.duration=Math.floor(a.invLinearVelocity*e+1)}var n,r;return a.startTick=t,a.endTick=t+i.duration,a.onStart&&a.onStart(e,i,t),i},action:function(e,t){const n=(t-a.startTick)/i.duration;let r=a.moveBy,s=a.rotateBy;return a.moveDelta&&(r=a.moveDelta),a.rotateDelta&&(s=a.rotateDelta),r&&a.scenePosition.location(o.add(a.startLocation,o.mult(r,n))),s&&a.scenePosition.rotate(o.add(a.startRotate,o.mult(s,n))),i},stop:function(e,t){return a.onStop&&a.onStop(e,i,t),i},dispose:function(){i.stop()}};return i}},666:()=>{window.frag.RepeatAnimationAction=function(e,t,n){return{duration:t.duration*n,interval:t.interval,start:t.start,stop:t.stop,action:t.action,dispose:function(){}}}},3890:()=>{window.frag.SceneObjectAnimation=function(e,t,n){const r=t.modelAnimation,o=t.childAnimations,a=[];for(let e=0;e<o.length;e++){const t=o[e],r=t.model.getName();if(animationState=n[r],animationState){const e=t.graph,n=animationState.getUpdateFunction(e.channel);a.push((function(t){n(e.frameValues[t])}))}}const i=function(e){for(let t=0;t<a.length;t++)a[t](e)},s=window.frag.KeyframeAnimationAction(e).setFrames(r.getInterval(),r.getFrames());for(let e=0;e<r.getFrames();e++)s.add(e,i);return window.frag.Animation(e).perform(s,r.getLoop())}},9889:()=>{window.frag.ValueAnimationAction=function(e){const t={},n={__private:t,duration:30,interval:5,setDuration:function(e){return n.duration=e,n},setInterval:function(e){return n.interval=e,n},onStart:function(e){return t.onStart=e,n},onStop:function(e){return t.onStop=e,n},onStep:function(e){return t.onStep=e,n},start:function(e,r){return t.startTick=r,t.endTick=r+n.duration,t.onStart&&t.onStart(e,n,r),n},action:function(e,r){if(t.onStep){const o=(r-t.startTick)/n.duration;t.onStep(e,o,n,r)}return n},stop:function(e,r){return t.onStop&&t.onStop(e,n,r),n},dispose:function(){n.stop()}};return n}},2588:()=>{window.frag.FrustumCamera=function(e){const t={zNear:100,zFar:200,xScale:100},n={};return window.frag.cameraMixin(e,t,n),n.frustum=function(e,r,o){return r<=0&&console.error("You cannot include things that are behind the camera in the cameras field of view. zNear must be greater than zero"),r>=o&&console.error("The camera zFar must be greater than zNear"),e<=0&&console.error("Camera x-scale must be greater than zero"),t.xScale=e,t.zNear=r,t.zFar=o,t.frustumChanged=!0,n},t.updateFrustum=function(){t.frustumChanged&&(t.projectionMatrix=window.frag.Matrix.frustum(-t.xScale,t.xScale,-t.xScale/t.aspectRatio,t.xScale/t.aspectRatio,t.zNear,t.zFar),t.frustumChanged=!1,t.transformChanged=!0)},n}},3014:()=>{window.frag.OrthographicCamera=function(e){const t={zNear:100,zFar:200,xScale:100},n={};return window.frag.cameraMixin(e,t,n),n.frustum=function(e,r,o){return r<=0&&console.error("You cannot include things that are behind the camera in the cameras field of view. zNear must be greater than zero"),r>=o&&console.error("The camera zFar must be greater than zNear"),e<=0&&console.error("Camera x-scale must be greater than zero"),t.xScale=e,t.zNear=r,t.zFar=o,t.frustumChanged=!0,n},t.updateFrustum=function(){t.frustumChanged&&(t.projectionMatrix=window.frag.Matrix.orthographic(-t.xScale,t.xScale,-t.xScale/aspectRatio,t.xScale/aspectRatio,t.zNear,t.zFar),t.frustumChanged=!1,t.transformChanged=!0)},n}},3906:()=>{window.frag.PerspectiveCamera=function(e){const t={fov:45*Math.PI/180,zNear:100,zFar:200,aspectRatio:1},n={};return window.frag.cameraMixin(e,t,n),n.frustum=function(e,r,o){return e<=0&&console.error("Camera field of view must be greater than zero"),e>=.5*Math.PI&&console.error("Camera field of view must be less than 90 degrees"),r<=0&&console.error("You cannot include things that are behind the camera in the cameras field of view. zNear must be greater than zero"),r>=o&&console.error("The camera zFar must be greater than zNear"),t.fov=e,t.zNear=r,t.zFar=o,t.frustumChanged=!0,n},t.updateFrustum=function(){t.frustumChanged&&(t.projectionMatrix=window.frag.Matrix.perspective(t.fieldOfView,t.aspectRatio,t.zNear,t.zFar),t.frustumChanged=!1,t.transformChanged=!0)},n}},3270:()=>{window.frag.UiCamera=function(e){const t={aspectRatio:1},n={worldToClipTransform:window.frag.Transform2D(e).identity(),scaleX:function(e){var r=n.worldToClipTransform.getMatrix();return r[0]=1/e,n.worldToClipTransform.setMatrix(r),t.aspectRatio=-1,n},setViewport:function(){const t=e.gl;return t.viewport(0,0,t.canvas.clientWidth,t.canvas.clientHeight),t.canvas.width=t.canvas.clientWidth,t.canvas.height=t.canvas.clientHeight,n.adjustToViewport()},adjustToViewport:function(){const r=e.gl,o=r.drawingBufferWidth/r.drawingBufferHeight;if(t.aspectRatio!=o){const e=n.worldToClipTransform.getMatrix();e[4]=e[0]*o,n.worldToClipTransform.setMatrix(e),t.aspectRatio=o}return n},dispose:function(){}};return n}},6611:()=>{window.frag.cameraMixin=function(e,t,n){t.worldTransform=window.frag.Transform3D(e),t.position=window.frag.ScenePosition(e),t.parentPosition=null,t.parentLocation=null,t.projectionMatrix=null,t.worldMatrix=null,t.transformChanged=!0,t.positionChanged=!0,t.frustumChanged=!0,t.aspectRatio=1,n.__private=t,n.worldToClipTransform=window.frag.Transform3D(e),n.dispose=function(){n.parent(null),t.position.observableLocation.unsubscribe(t.onPositionChanged),t.worldToClipTransform.dispose(),t.position.dispose()},t.onPositionChanged=function(){t.positionChanged=!0},t.position.observableLocation.subscribe(t.onPositionChanged),n.getPosition=function(){return t.position},t.updateAspect=function(){const n=e.gl.drawingBufferWidth/e.gl.drawingBufferHeight;n!==t.aspectRatio&&(t.aspectRatio=n,t.frustumChanged=!0)},t.updateWorld=function(){if(t.positionChanged){let e=t.position.getMatrix();if(t.parentLocation){const n=t.parentLocation.getMatrix();e=window.frag.Matrix.m4Xm4(n,e)}t.worldMatrix=window.frag.Matrix.m4Invert(e),t.positionChanged=!1,t.transformChanged=!0}},n.setViewport=function(){const t=e.gl;return t.viewport(0,0,t.canvas.clientWidth,t.canvas.clientHeight),t.canvas.width=t.canvas.clientWidth,t.canvas.height=t.canvas.clientHeight,n.adjustToViewport()},n.adjustToViewport=function(){e.gl;const r=window.frag.Matrix;return t.updateAspect(),t.updateFrustum(),t.updateWorld(),t.transformChanged&&(n.worldToClipTransform.setMatrix(r.m4Xm4(t.projectionMatrix,t.worldMatrix)),t.transformChanged=!1),n},t.parentPositionChanged=function(e){t.parentLocation=e,t.positionChanged=!0},n.parent=function(e){return t.parentPosition&&t.parentPosition.observableLocation.unsubscribe(t.parentPositionChanged),e&&e.getPosition&&(e=e.getPosition()),t.parentPosition=e,e?e.observableLocation.subscribe(t.parentPositionChanged):t.parentPositionChanged(null),n}}},3163:()=>{window.frag=window.frag||{},window.frag.Engine=function(e){e=e||{};const t={startFunctions:[],scenes:[],activeAnimations:{},inactiveAnimations:{},running:!1,startTime:performance.now(),gameTick:0,frameTick:0,mainScene:null,nextAnimationId:0,currentFrameCount:0,frameCounts:[],frameCountsSum:0,nextFpsPush:0,hitTestShader:null,nextTextureUnit:0},n={__private:t,canvas:e.canvas||document.getElementById("scene"),renderInterval:e.renderInterval||15,gameTickMs:e.gameTickMs||10,debugPackageLoader:void 0!==e.debugPackageLoader&&e.debugPackageLoader,debugShaderBuilder:void 0!==e.debugShaderBuilder&&e.debugShaderBuilder,debugAnimations:void 0!==e.debugAnimations&&e.debugAnimations,debugMeshes:void 0!==e.debugMeshes&&e.debugMeshes,debugInputs:void 0!==e.debugInputs&&e.debugInputs,transparency:void 0!==e.transparency&&e.transparency,fps:0};n.gl=n.canvas.getContext("webgl"),n.correctClock=function(e){let r=e-t.gameTick;r>0?t.startTime+=n.gameTickMs:r<0&&(t.startTime-=n.gameTickMs)},n.allocateTextureUnit=function(){const e=t.nextTextureUnit;return t.nextTextureUnit=(t.nextTextureUnit+1)%n.maxTextureUnits,e},n.mainScene=function(e){return t.mainScene&&t.mainScene.dispose(),t.mainScene=e,n},n.getMainScene=function(){return t.mainScene},n.addScene=function(e){return t.scenes.push(e),n},n.removeScene=function(e){for(let n=0;n<t.scenes.length;n++)if(t.scenes[n]===e)return t.scenes.splice(n,1),!0;return!1},n.activateAnimation=function(e){return t.activeAnimations[e.id]=e,delete t.inactiveAnimations[e.id],n},n.deactivateAnimation=function(e){return t.inactiveAnimations[e.id]=e,delete t.activeAnimations[e.id],n},n.addAnimation=function(e){return e.id=t.nextAnimationId++,t.inactiveAnimations[e.id]=e,n},n.removeAnimation=function(e){return delete t.inactiveAnimations[e.id],delete t.activeAnimations[e.id],n},t.playAnimations=function(){for(let e in t.activeAnimations){let n=t.activeAnimations[e];void 0!==n.nextFrameTick?t.frameTick>=n.nextFrameTick&&(n.nextFrameTick=t.frameTick+10,n.action(null,t.gameTick,t.frameTick)):null!=n.nextGameTick?t.gameTick>=n.nextGameTick&&(n.nextGameTick=t.gameTick+5,n.action(null,t.gameTick,t.frameTick)):n.nextGameTick=t.gameTick+5}},n.hitTest=function(e,r,o,a,i){if(o=o||n.canvas.clientWidth,a=a||n.canvas.clientHeight,i=i||n.getMainScene(),!t.hitTestShader){const e="attribute vec4 a_position;\nuniform mat4 u_clipMatrix;\nvoid main() {;\n  gl_Position = u_clipMatrix * a_position;\n}",r="precision mediump float;\nuniform vec4 u_color;\nvoid main() {;\n  gl_FragColor = u_color;\n}";t.hitTestShader=frag.CustomShader(n).name("Hit test").source(e,r).attribute("position").uniform("clipMatrix").uniform("color")}const s=n.gl,c=s.createTexture();s.bindTexture(s.TEXTURE_2D,c),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,o,a,0,s.RGBA,s.UNSIGNED_BYTE,null);const u=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,u),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,c,0);const l=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,l),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_COMPONENT16,o,a),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,l),s.viewport(0,0,o,a),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);const d=frag.DrawContext(n).forHitTest(t.hitTestShader);if(s.disable(s.BLEND),Array.isArray(i))for(let e=0;e<i.length;e++)i[e].adjustToViewport(),i[e].draw(d);else i.adjustToViewport(),i.draw(d);const f=new Uint8Array(4);s.readPixels(e,a-r,1,1,s.RGBA,s.UNSIGNED_BYTE,f),s.bindFramebuffer(s.FRAMEBUFFER,null),engine.transparency&&s.enable(s.BLEND);const m=f[0],g=f[1],h=f[2],v=f[3]|h<<8|(15&g)<<16,p=(240&g)>>4|m<<4;return v<d.models.length&&p<d.sceneObjects.length?{sceneObject:d.sceneObjects[p],model:d.models[v]}:null},n.render=function(){if(!t.mainScene)return n;const e=performance.now();t.gameTick=Math.floor((e-t.startTime)/n.gameTickMs),t.frameTick++,t.playAnimations();const r=n.gl;r.bindFramebuffer(r.FRAMEBUFFER,null),t.mainScene.setViewport(),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);const o=frag.DrawContext(n).forRender();t.mainScene.draw(o);for(let e=0;e<t.scenes.length;e++)t.scenes[e].adjustToViewport(),t.scenes[e].draw(o);const a=performance.now();return t.currentFrameCount++,a>t.nextFpsPush&&(t.nextFpsPush=a+100,t.frameCountsSum+=t.currentFrameCount,t.frameCounts.push(t.currentFrameCount),t.currentFrameCount=0,t.frameCounts.length>20&&(t.frameCountsSum-=t.frameCounts.shift()),n.fps=10*t.frameCountsSum/t.frameCounts.length),n},t.renderLoop=function(){n.render(),t.running&&setTimeout(t.renderLoop,n.renderInterval)},n.onStart=function(e){return t.startFunctions.push(e),n},n.initialize=function(){for(var e=0;e<t.startFunctions.length;e++)t.startFunctions[e](n)},n.start=function(){return n.initialize(),t.running=!0,t.renderLoop(),n},n.stop=function(){return t.running=!1,n},n.dispose=function(){n.stop()},n.onStart((function(e){e.canvas.addEventListener("contextmenu",(e=>e.preventDefault()));const t=e.gl;return e.maxTextureUnits=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),t.clearColor(1,1,1,1),t.enable(t.CULL_FACE),t.enable(t.DEPTH_TEST),e.transparency&&(t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)),n}));const r=function(e){n[e]=function(){const t=Array.prototype.slice.call(arguments);return t.unshift(n),frag[e].apply(null,t)}};return r("Observable"),r("Transform"),r("Transform2D"),r("Transform3D"),r("Location"),r("CustomShader"),r("Shader"),r("UiShader"),r("FontShader"),r("Texture"),r("Font"),r("Material"),r("VertexData"),r("Mesh"),r("MeshOptimizer"),r("Model"),r("ScenePosition"),r("SceneObject"),r("Scene"),r("DrawContext"),r("PositionLink"),r("UiCamera"),r("OrthographicCamera"),r("PerspectiveCamera"),r("FrustumCamera"),r("Animation"),r("ObjectAnimationState"),r("ModelAnimation"),r("SceneObjectAnimation"),r("ValueAnimationAction"),r("KeyframeAnimationAction"),r("ParallelAnimationAction"),r("RepeatAnimationAction"),r("PositionAnimationAction"),r("Cube"),r("Cylinder"),r("Disc"),r("Plane"),r("Sphere"),r("AssetCatalog"),r("PackageLoader"),r("InputMethod"),r("DigitalState"),r("AnalogState"),r("DigitalInput"),r("AnalogInput"),r("DigitalAction"),r("AnalogAction"),n}},1821:()=>{window.frag.Location=function(e,t){const n={is3d:t,isModified:!1,matrix:null,translateX:0,translateY:0,translateZ:0,scaleX:1,scaleY:1,scaleZ:1,rotateX:0,rotateY:0,rotateZ:0,dispose:function(){},clone:function(){const t=window.frag.Location(e,n.is3d);return t.isModified=n.isModified,t.matrix=n.matrix,t.translateX=n.translateX,t.translateY=n.translateY,t.translateZ=n.translateZ,t.scaleX=n.scaleX,t.scaleY=n.scaleY,t.scaleZ=n.scaleZ,t.rotateX=n.rotateX,t.rotateY=n.rotateY,t.rotateZ=n.rotateZ,t},add:function(e){return n.translateX+=e.translateX,n.translateY+=e.translateY,n.translateZ+=e.translateZ,n.scaleX*=e.scaleX,n.scaleY*=e.scaleY,n.scaleZ*=e.scaleZ,n.rotateX+=e.rotateX,n.rotateY+=e.rotateY,n.rotateZ+=e.rotateZ,n.isModified=!0,n},getMatrix:function(){if(n.matrix&&!n.isModified)return n.matrix;let t;return t=n.is3d?window.frag.Transform3D(e).translateXYZ(n.translateX,n.translateY,n.translateZ).rotateXYZ(n.rotateX,n.rotateY,n.rotateZ).scaleXYZ(n.scaleX,n.scaleY,n.scaleZ):window.frag.Transform2D(e).translateXY(n.translateX,n.translateY).rotate(n.rotateZ).scaleXY(n.scaleX,n.scaleY),n.matrix=t.getMatrix(),n.isModified=!1,n.matrix}};return n}},9607:()=>{window.frag.Observable=function(e,t){const n={notify:t,observers:[]};return{__private:n,dispose:function(){},subscribe:function(e){n.observers.push(e),n.notify(e)},unsubscribe:function(e){for(let t=0;t<n.observers.length;t++)if(n.observers[t]===e)return n.observers.splice(t,1),!0;return!1},notify:function(e){e=e||n.notify||function(e){e()};for(let t=0;t<n.observers.length;t++)e(n.observers[t])}}},window.frag.ObservableValue=function(){let e=null;const t=frag.Observable(engine,(t=>{t(e)}));return{get:function(){return e},set:function(n){e=n,t.notify()},subscribe:function(e){return t.subscribe(e)},unsubscribe:function(e){return t.unsubscribe(e)}}}},1346:()=>{window.frag.Transform=function(e,t){return t&&9===t.length?window.frag.Transform2D(e,t):window.frag.Transform3D(e,t)}},9670:()=>{window.frag.Transform2D=function(e,t){const n=window.frag,r={matrix:t},o={__private:r,observableMatrix:window.frag.Observable(e,(e=>{e(r.matrix)})),is3d:!1,dispose:function(){o.observableMatrix.dispose()},clone:function(t){return window.frag.Transform2D(e,t||r.matrix)},getMatrix:function(){return r.matrix},setMatrix:function(e){return r.matrix=e,o.observableMatrix.notify(),o},transform:function(e){return r.matrix?o.setMatrix(n.Matrix.m3Xm3(r.matrix,e)):o.setMatrix(e)},identity:function(){return o.setMatrix([1,0,0,0,1,0,0,0,1])},scale:function(e){return o.transform([e,0,0,0,e,0,0,0,1])},scaleXY:function(e,t){return o.transform([e,0,0,0,t,0,0,0,1])},translateX:function(e){return o.transform([1,0,0,0,1,0,e,0,1])},translateY:function(e){return o.transform([1,0,0,0,1,0,0,e,1])},translateXY:function(e,t){return o.transform([1,0,0,0,1,0,e,t,1])},rotate:function(e){var t=Math.cos(e),n=Math.sin(e);return o.transform([t,-n,0,n,t,0,0,0,1])},apply:function(t){return void 0!==t&&e.gl.uniformMatrix3fv(t,!1,o.getMatrix()),o}};return o}},7008:()=>{window.frag.Transform3D=function(e,t){const n=window.frag,r={matrix:t},o={__private:r,observableMatrix:window.frag.Observable(e,(e=>{e(r.matrix)})),is3d:!0,dispose:function(){o.observableMatrix.dispose()},clone:function(t){return window.frag.Transform3D(e,t||r.matrix)},getMatrix:function(){return r.matrix},setMatrix:function(e){return r.matrix=e,o.observableMatrix.notify(),o},transform:function(e){return r.matrix?o.setMatrix(n.Matrix.m4Xm4(r.matrix,e)):o.setMatrix(e)},identity:function(){return o.setMatrix([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},scale:function(e){return o.transform([e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1])},scaleX:function(e){return o.transform([e,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},scaleY:function(e){return o.transform([1,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1])},scaleZ:function(e){return o.transform([1,0,0,0,0,1,0,0,0,0,e,0,0,0,0,1])},scaleXY:function(e,t){return o.transform([e,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1])},scaleXYZ:function(e,t,n){return o.transform([e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1])},translateX:function(e){return o.transform([1,0,0,0,0,1,0,0,0,0,1,0,e,0,0,1])},translateY:function(e){return o.transform([1,0,0,0,0,1,0,0,0,0,1,0,0,e,0,1])},translateZ:function(e){return o.transform([1,0,0,0,0,1,0,0,0,0,1,0,0,0,e,1])},translateXY:function(e,t){return o.transform([1,0,0,0,0,1,0,0,0,0,1,0,e,t,0,1])},translateXYZ:function(e,t,n){return o.transform([1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1])},rotateX:function(e){var t=Math.cos(e),n=Math.sin(e);return o.transform([1,0,0,0,0,t,n,0,0,-n,t,0,0,0,0,1])},rotateY:function(e){var t=Math.cos(e),n=Math.sin(e);return o.transform([t,0,-n,0,0,1,0,0,n,0,t,0,0,0,0,1])},rotateZ:function(e){var t=Math.cos(e),n=Math.sin(e);return o.transform([t,n,0,0,-n,t,0,0,0,0,1,0,0,0,0,1])},rotateXYZ:function(e,t,n){return e&&o.rotateX(e),t&&o.rotateY(t),n&&o.rotateZ(n),o},apply:function(t){return void 0!==t&&e.gl.uniformMatrix4fv(t,!1,o.getMatrix()),o}};return o}},5217:()=>{window.frag.AnalogAction=function(e,t,n){const r=t.split("-");let o="move",a="z";for(let e=0;e<r.length;e++)/^move$/i.test(r[e])&&(o="move"),/^rotate$/i.test(r[e])&&(o="rotate"),/^scale$/i.test(r[e])&&(o="scale"),/^x$/i.test(r[e])&&(a="x"),/^y$/i.test(r[e])&&(a="y"),/^z$/i.test(r[e])&&(a="z"),/^right$/i.test(r[e])&&(a="right"),/^up$/i.test(r[e])&&(a="up"),/^forward$/i.test(r[e])&&(a="forward");const i=function(e){if("move"===o){if("x"===a)return function(t){e().locationX(t.value)};if("y"===a)return function(t){e().locationY(t.value)};if("z"===a)return function(t){e().locationZ(t.value)}}if("rotate"===o){if("x"===a)return function(t){e().rotateX(t.value)};if("y"===a)return function(t){e().rotateY(t.value)};if("z"===a)return function(t){e().rotateZ(t.value)}}return null};return/camera/i.test(t)?i((function(){return e.getMainScene().getCamera().getPosition()})):n&&n.sceneObject&&/sceneobject/i.test(t)?i(n.sceneObject.getPosition):null}},280:()=>{window.frag.AnalogInput=function(t,n,r,o){void 0===(o=o||{}).scale&&(o.scale=1);const a={inputName:n,analogState:r},i={__private:a,dispose:function(){i.disable()}},s=n.split("-");if(/mouse/i.test(n)){let e,n,r=0,c=!1,u=!1,l=!1;for(let e=0;e<s.length;e++)/^horizontal$/.test(s[e])&&(c=!1),/^vertical$/.test(s[e])&&(c=!0),/^inverted$/.test(s[e])&&(u=!0),/^wheel$/.test(s[e])&&(l=!0),/^left$/.test(s[e])&&(r=1),/^right$/.test(s[e])&&(r=2),/^middle$/.test(s[e])&&(r=4),/^back$/.test(s[e])&&(r=8),/^forward$/.test(s[e])&&(r=16),/^any$/.test(s[e])&&(r=255);const d=function(i){if(0===r){let e=c?(t.canvas.clientHeight-i.clientY)/t.canvas.clientHeight:i.clientX/t.canvas.clientWidth;e*=o.scale,e>1&&(e=1),u&&(e=1-e);const n=(a.analogState.maxValue-a.analogState.minValue)*e+a.analogState.minValue;t.debugInputs&&console.log("Analog input",a.inputName,"=",n),a.analogState.setValue(i,n,!0)}else if(0!=(i.buttons&r)){let r=c?(u?i.clientY-e:e-i.clientY)/t.canvas.clientHeight:(u?e-i.clientX:i.clientX-e)/t.canvas.clientWidth;r*=o.scale,r>1&&(r=1);const s=n+(a.analogState.maxValue-a.analogState.minValue)*r;t.debugInputs&&console.log("Analog input",a.inputName,"=",s),a.analogState.setValue(i,s,!0)}return!0},f=function(t){0!=(t.buttons&r)&&(e=c?t.clientY:t.clientX,n=a.analogState.getValue())},m=function(e){return t.debugInputs&&console.log("Analog input",a.inputName,"delta",e.deltaY),u?e.deltaY>0?a.analogState.decrement(e):a.analogState.increment(e):e.deltaY<0?a.analogState.decrement(e):a.analogState.increment(e),e.preventDefault(),!0};return i.enable=function(){return l?t.canvas.addEventListener("wheel",m,!1):(t.canvas.addEventListener("mousemove",d,!1),0!==r&&t.canvas.addEventListener("mousedown",f,!1)),i},i.disable=function(){return l?t.canvas.removeEventListener("wheel",m,!1):(t.canvas.removeEventListener("mousemove",d,!1),0!==r&&t.canvas.removeEventListener("mousedown",f,!1)),i},i}if(/keys/i.test(s[0])){let e="ArrowLeft",n="ArrowRight";s.length>1&&(e=s[1]),s.length>2&&(n=s[2]);const r=function(r){return r.key===e?(t.debugInputs&&console.log("Analog input",a.inputName,"decrement"),a.analogState.decrement(r),r.preventDefault()):r.key===n&&(t.debugInputs&&console.log("Analog input",a.inputName,"increment"),a.analogState.increment(r),r.preventDefault()),!0};return i.enable=function(){return document.addEventListener("keydown",r,!1),i},i.disable=function(){return document.removeEventListener("keydown",r,!1),i},i}if(/touch/i.test(n)){let e,n,r,c,u="horizontal",l=!1,d=!1,f=0;for(let e=0;e<s.length;e++)/^horizontal$/.test(s[e])&&(u="horizontal"),/^vertical$/.test(s[e])&&(u="vertical"),/^pinch$/.test(s[e])&&(u="pinch"),/^rotate$/.test(s[e])&&(u="rotate"),/^inverted$/.test(s[e])&&(l=!0),/^plus$/.test(s[e])&&(d=!0),/^1$/.test(s[e])&&(f=0),/^2$/.test(s[e])&&(f=1),/^3$/.test(s[e])&&(f=2);let m=null,g=null;if("horizontal"===u&&(m=function(i){if(d&&i.touches.length>f||i.touches.length===f+1){const s=i.touches.item(f);let u=(l?e-s.clientX:s.clientX-e)/r;u*=o.scale,u>1&&(u=1);const d=n+c*u;t.debugInputs&&console.log("Analog input",a.inputName,"=",d),a.analogState.setValue(i,d,!0)}return!0},g=function(o){if(o.touches.length===f+1){const i=o.touches.item(f);e=i.clientX,n=a.analogState.getValue(),c=a.analogState.maxValue-a.analogState.minValue,r=t.canvas.clientWidth}return!0}),"vertical"===u&&(m=function(i){if(d&&i.touches.length>f||i.touches.length===f+1){const s=i.touches.item(f);let u=(l?s.clientY-e:e-s.clientY)/r;u*=o.scale,u>1&&(u=1);const d=n+c*u;t.debugInputs&&console.log("Analog input",a.inputName,"=",d),a.analogState.setValue(i,d,!0)}return!0},g=function(o){if(o.touches.length===f+1){const i=o.touches.item(f);e=i.clientY,n=a.analogState.getValue(),c=a.analogState.maxValue-a.analogState.minValue,r=t.canvas.clientHeight}return!0}),"pinch"===u){const i=function(e){const t=e.touches.item(0),n=e.touches.item(1),r=n.clientX-t.clientX,o=n.clientY-t.clientY;return Math.sqrt(r*r+o*o)};m=function(s){if(d&&s.touches.length>1||2===s.touches.length){let u=(i(s)-e)/r;u*=o.scale,u>1&&(u=1),l&&(u=-u);const d=n+c*u;t.debugInputs&&console.log("Analog input",a.inputName,"=",d),a.analogState.setValue(s,d,!0)}return!0},g=function(o){return 2===o.touches.length&&(e=i(o),n=a.analogState.getValue(),c=a.analogState.maxValue-a.analogState.minValue,r=.5*Math.sqrt(t.canvas.clientHeight*t.canvas.clientHeight+t.canvas.clientWidth*t.canvas.clientWidth)),!0}}if("rotate"===u){const i=function(e){const t=e.touches.item(0),n=e.touches.item(1),r=n.clientX-t.clientX,o=n.clientY-t.clientY;return Math.atan2(o,r)};m=function(s){if(d&&s.touches.length>1||2===s.touches.length){let u=(i(s)-e)/r;u*=o.scale,u>1&&(u=1),l&&(u=-u);const d=n+c*u;t.debugInputs&&console.log("Analog input",a.inputName,"=",d),a.analogState.setValue(s,d,!0)}return!0},g=function(t){return 2===t.touches.length&&(e=i(t),n=a.analogState.getValue(),c=a.analogState.maxValue-a.analogState.minValue,r=.5*Math.PI),!0}}return i.enable=function(){return m&&t.canvas.addEventListener("touchmove",m,!1),g&&t.canvas.addEventListener("touchstart",g,!1),i},i.disable=function(){return m&&t.canvas.removeEventListener("touchmove",m,!1),g&&t.canvas.removeEventListener("touchstart",g,!1),i},i}if(/pointer/i.test(n)){let e,n,r=0,c=!1,u=!1;for(let e=0;e<s.length;e++)/^horizontal$/.test(s[e])&&(c=!1),/^vertical$/.test(s[e])&&(c=!0),/^inverted$/.test(s[e])&&(u=!0),/^left$/.test(s[e])&&(r=1),/^right$/.test(s[e])&&(r=2),/^middle$/.test(s[e])&&(r=4),/^back$/.test(s[e])&&(r=8),/^forward$/.test(s[e])&&(r=16),/^eraser$/.test(s[e])&&(r=32),/^any$/.test(s[e])&&(r=255);const l=function(i){if(0===r){let e=c?i.clientY/t.canvas.clientHeight:i.clientX/t.canvas.clientWidth;e*=o.scale,e>1&&(e=1),u&&(e=1-e);const n=(a.analogState.maxValue-a.analogState.minValue)*e+a.analogState.minValue;t.debugInputs&&console.log("Analog input",a.inputName,"=",n),a.analogState.setValue(i,n,!0)}else if(0!=(i.buttons&r)){let r=c?(u?e-i.clientY:i.clientY-e)/t.canvas.clientHeight:(u?e-i.clientX:i.clientX-e)/t.canvas.clientWidth;r*=o.scale,r>1&&(r=1);const s=n+(a.analogState.maxValue-a.analogState.minValue)*r;t.debugInputs&&console.log("Analog input",a.inputName,"=",s),a.analogState.setValue(i,s,!0)}return!0},d=function(t){0!=(t.buttons&r)&&(e=c?t.clientY:t.clientX,n=a.analogState.getValue())};return i.enable=function(){return t.canvas.addEventListener("pointermove",l,!1),0!==r&&t.canvas.addEventListener("pointerdown",d,!1),i},i.disable=function(){return t.canvas.removeEventListener("pointermove",l,!1),0!==r&&t.canvas.removeEventListener("pointerdown",d,!1),i},i}if(/gamepad/i.test(n)){let n,r=0,o=0,c=0,u=null,l=!1;for(let e=0;e<s.length;e++)/^horizontal$/.test(s[e])&&(c=0),/^vertical$/.test(s[e])&&(c=1),/^inverted$/.test(s[e])&&(l=!0),/^player1$/.test(s[e])&&(r=0),/^player2$/.test(s[e])&&(r=1),/^player3$/.test(s[e])&&(r=2),/^player4$/.test(s[e])&&(r=3),/^stick1$/.test(s[e])&&(o=0),/^stick2$/.test(s[e])&&(o=1),/^stick3$/.test(s[e])&&(o=2),/^stick4$/.test(s[e])&&(o=3);const d=2*o+c,f=function(e){if(u){const t=u.axes[d];l&&(t=-t),a.analogState.setVelocity(e,t*a.analogState.maxVelocity)}},m=function(o){t.debugInputs&&console.log("Gamepad",o.gamepad.index,"connected","id:"+o.gamepad.id,"with",e.gamepad.axes.length,"axes"),o.gamepad.index===r&&u.axes.length>d&&(u=o.gamepad,n=setInterval(f,50))},g=function(e){t.debugInputs&&console.log("Gamepad",e.gamepad.index,"disconnected","id:"+e.gamepad.id),e.gamepad.id===u.id&&(clearInterval(n),u=null)};return i.enable=function(){return window.addEventListener("gamepadconnected",m,!1),window.addEventListener("gamepaddisconnected",g,!1),i},i.disable=function(){return window.removeEventListener("gamepadconnected",m,!1),window.removeEventListener("gamepaddisconnected",g,!1),i},i}return/orientation/i.test(n),i}},6784:()=>{window.frag.AnalogState=function(e,t,n,r){window.frag,n||(n={}),n.value=n.value||0,n.minValue=void 0===n.minValue?-100:n.minValue,n.maxValue=void 0===n.maxValue?100:n.maxValue,n.maxVelocity=n.maxVelocity||5,n.acceleration=void 0===n.acceleration?.25:n.acceleration,n.deceleration=void 0===n.deceleration?1:n.deceleration;const o={analogAction:t,config:n,name:r,inverted:!1},a={__private:o,value:n.value,minValue:n.minValue,maxValue:n.maxValue,maxVelocity:Math.abs(n.maxVelocity),velocity:0,analogAction:function(e){o.analogAction=e}};return n.maxValue<n.minValue&&(o.inverted=!0,a.minValue=n.maxValue,a.maxValue=n.minValue),o.change=function(e){if(o.analogAction)if(Array.isArray(o.analogAction))for(let t=0;t<o.analogAction.length;t++)o.analogAction[t](a,e);else o.analogAction(a,e)},o.setValue=function(t,n){n<a.minValue&&(n=a.minValue,a.velocity=0),n>a.maxValue&&(n=a.maxValue,a.velocity=0),Math.abs(a.value-n)>1e-5&&(a.value=n,e.debugInputs&&console.log("Analog state",o.name,"set to",n),o.change(t))},o.increment=function(e){a.velocity+=a.velocity>=0?o.config.acceleration:o.config.deceleration,a.velocity>o.config.maxVelocity&&(a.velocity=o.config.maxVelocity),o.setValue(e,a.value+a.velocity,!1)},o.decrement=function(e){a.velocity-=a.velocity<=0?o.config.acceleration:o.config.deceleration,a.velocity<-o.config.maxVelocity&&(a.velocity=-o.config.maxVelocity),o.setValue(e,a.value+a.velocity,!1)},a.setValue=function(e,t,n){o.inverted&&(t=a.minValue+a.maxValue-t),n&&(a.velocity=t-a.value),o.setValue(e,t)},a.getValue=function(){return o.inverted?a.minValue+a.maxValue-a.value:a.value},a.increment=function(e){o.inverted?o.decrement(e):o.increment(e)},a.decrement=function(e){o.inverted?o.increment(e):o.decrement(e)},a.setVelocity=function(e,t){inverted?a.velocity=-t:a.velocity=t,a.velocity>o.config.maxVelocity&&(a.velocity=o.config.maxVelocity),a.velocity<-o.config.maxVelocity&&(a.velocity=-o.config.maxVelocity),o.setValue(e,a.value+a.velocity)},a}},8853:()=>{window.frag.DigitalAction=function(e,t,n){if(window.frag,n&&n.animation){if(/^animation$/i.test(t))return function(t){e.debugInputs&&console.log("Turning animation",t.isOn?"on":"off"),t.isOn?n.animation.start():n.animation.stop()};if(/^animation-start$/i.test(t))return function(t){t.isOn||(e.debugInputs&&console.log("Starting animation"),n.animation.start())};if(/^animation-stop$/i.test(t))return function(t){t.isOn||(e.debugInputs&&console.log("Stopping animation"),n.animation.stop())}}return n&&n.sceneObject&&/^sceneobject$/i.test(t)?function(t){e.debugInputs&&console.log("Turning scene object",t.isOn?"on":"off"),t.isOn?n.sceneObject.enable():n.sceneObject.disable()}:n&&n.model&&/^model$/i.test(t)?function(t){e.debugInputs&&console.log("Turning",n.model.getName(),"model",t.isOn?"on":"off"),t.isOn?n.model.enable():n.model.disable()}:null}},8562:()=>{window.frag.DigitalInput=function(e,t,n){window.frag;const r={inputName:t,digitalState:n,toggle:!1,inverted:!1,setOn:!1,setOff:!1},o={__private:r,dispose:function(){o.disable()}},a=t.split("-"),i=function(t,n){r.inverted&&(n=!n),e.debugInputs&&console.log("Digital input",r.inputName,"is",n?"on":"off"),r.toggle?n&&r.digitalState.toggle(t):r.setOn||r.setOff?n&&(r.setOn&&r.digitalState.setIsOn(t,!0),r.setOff&&r.digitalState.setIsOn(t,!1)):r.digitalState.setIsOn(t,n)};if(/mouse/i.test(t)){let t=1;for(let e=0;e<a.length;e++)/^toggle$/i.test(a[e])&&(r.toggle=!0),/^inverted$/i.test(a[e])&&(r.inverted=!0),/^on$/i.test(a[e])&&(r.setOn=!0),/^off$/i.test(a[e])&&(r.setOff=!0),/^left$/i.test(a[e])&&(t=1),/^right$/i.test(a[e])&&(t=2),/^middle$/i.test(a[e])&&(t=4),/^back$/i.test(a[e])&&(t=8),/^forward$/i.test(a[e])&&(t=16),/^eraser$/i.test(a[e])&&(t=32),/^any$/i.test(a[e])&&(t=255);const n=function(e){return i(e,0!=(e.buttons&t)),!0};return o.enable=function(){e.canvas.addEventListener("mousedown",n,!1),e.canvas.addEventListener("mouseup",n,!1)},o.disable=function(){e.canvas.removeEventListener("mousedown",n,!1),e.canvas.removeEventListener("mouseup",n,!1)},o}if(/pointer/i.test(t)){let t=1;for(let e=0;e<a.length;e++)/^toggle$/i.test(a[e])&&(r.toggle=!0),/^inverted$/i.test(a[e])&&(r.inverted=!0),/^on$/i.test(a[e])&&(r.setOn=!0),/^off$/i.test(a[e])&&(r.setOff=!0),/^left$/i.test(a[e])&&(t=1),/^right$/i.test(a[e])&&(t=2),/^middle$/i.test(a[e])&&(t=4),/^back$/i.test(a[e])&&(t=8),/^forward$/i.test(a[e])&&(t=16),/^eraser$/i.test(a[e])&&(t=32),/^any$/i.test(a[e])&&(t=255);const n=function(e){return i(e,0!=(e.buttons&t)),!0};return o.enable=function(){e.canvas.addEventListener("pointerdown",n,!1),e.canvas.addEventListener("pointerup",n,!1)},o.disable=function(){e.canvas.removeEventListener("pointerdown",n,!1),e.canvas.removeEventListener("pointerup",n,!1)},o}if(/key/i.test(t)){let e,t=!1,n=!1,s=!1,c=!1;for(let o=0;o<a.length;o++)/^toggle$/i.test(a[o])?r.toggle=!0:/^inverted$/i.test(a[o])?r.inverted=!0:/^on$/i.test(a[o])?r.setOn=!0:/^off$/i.test(a[o])?r.setOff=!0:/^ctrl$/i.test(a[o])?t=!0:/^shift$/i.test(a[o])?n=!0:/^alt$/i.test(a[o])?s=!0:/^meta$/i.test(a[o])?c=!0:/^key$/i.test(a[o])||(e=a[o]);const u=function(r,o){return r.key!==e||r.altKey!==s||r.ctrlKey!==t||r.shiftKey!==n||r.metaKey!==c||(r.preventDefault(),i(r,o)),!0},l=function(e){return u(e,!0)},d=function(e){return u(e,!1)};return o.enable=function(){document.addEventListener("keydown",l,!1),document.addEventListener("keyup",d,!1)},o.disable=function(){document.removeEventListener("keydown",l,!1),document.removeEventListener("keyup",d,!1)},o}return o}},3235:()=>{window.frag.DigitalState=function(e,t,n,r){window.frag,n||(n={}),n.isOn=!!n.isOn;const o={digitalAction:t,config:n,name:r},a={__private:o,isOn:n.isOn,dispose:function(){}};return o.change=function(e){if(o.digitalAction)if(Array.isArray(o.digitalAction))for(let t=0;t<o.digitalAction.length;t++)o.digitalAction[t](a,e);else o.digitalAction(a,e)},a.setIsOn=function(t,n){n!==a.isOn?(a.isOn=n,e.debugInputs&&console.log("Digital state",o.name,"turned",a.isOn?"on":"off"),o.change(t)):e.debugInputs&&console.log("Digital state",o.name,"is already",a.isOn?"on":"off")},a.toggle=function(t){a.isOn=!a.isOn,e.debugInputs&&console.log("Digital state",o.name,"toggled to",a.isOn?"on":"off"),o.change(t)},a}},7802:()=>{window.frag.InputMethod=function(e){const t={inputs:[],enabled:!1},n={__private:t,dispose:function(){n.disable()},enable:function(){if(!t.enabled){for(var e=0;e<t.inputs.length;e++)t.inputs[e].enable();t.enabled=!0}return n},disable:function(){if(t.enabled){t.enabled=!1;for(var e=0;e<t.inputs.length;e++)t.inputs[e].disable()}return n},add:function(e){return t.inputs.push(e),t.enabled&&e.enable(),n}};return n}},6237:()=>{window.frag.AssetCatalog=function(e,t,n){const r=window.frag,o=e.gl,a=new Uint8Array([127,127,127,255,0,0,255,0,0,0,0,127,127,255]);n||(n={}),n.diffuse||(n.diffuse=r.Texture(e).name("default-diffuse-texture").dataFormat(o.RGBA).fromArrayBuffer(0,a.buffer,0,1,1)),n.surface||(n.surface=r.Texture(e).name("default-surface-texture").dataFormat(o.RGBA).fromArrayBuffer(0,a.buffer,4,1,1)),n.emmissive||(n.emmissive=r.Texture(e).name("default-emmissive-texture").dataFormat(o.RGB).fromArrayBuffer(0,a.buffer,8,1,1)),n.normal||(n.normal=r.Texture(e).name("default-normal-map-texture").dataFormat(o.RGB).fromArrayBuffer(0,a.buffer,11,1,1)),t||(t=r.Shader(e).name("Model").verticiesXYZ().matrix3D().diffuseTexture().directionalLightGrey().compile());const i={defaultTextures:n,fonts:{},materials:{},models:{}},s={__private:i,shader:t,dispose:function(){},getFont:function(t){var n=i.fonts[t];return n||(n=r.Font(e).name(t),i.fonts[t]=n),n},getMaterial:function(t){var n=i.materials[t];return n||(n=r.Material(e).name(t).disposeTextures(!1).setTexture("diffuse",i.defaultTextures.diffuse).setTexture("emmissive",i.defaultTextures.emmissive).setTexture("surface",i.defaultTextures.surface).setTexture("normalMap",i.defaultTextures.normal),i.materials[t]=n),n},getModel:function(t,n){var o=n?void 0:i.models[t];return o||(o=r.Model(e,s.shader.is3d).name(t).shader(s.shader),n||(i.models[t]=o)),o}};return s}},956:()=>{window.frag.PackageLoader=function(e){if(e.packageLoader)return e.packageLoader;const t=window.frag,n=new Uint32Array([287454020]),r=68===new Uint8Array(n.buffer)[0],o=function(e){return Math.round(1e4*e)/1e4},a={},i={__private:a,littleEndian:r,dispose:function(){}};return e.packageLoader=i,a.loadFontV1=function(t,n,o){const a=t.header.getUint8(o++);var i="";for(let e=0;e<a;e++)i+=String.fromCharCode(t.header.getUint8(o++));const s=t.assetCatalog.getFont(i);e.debugPackageLoader&&console.log("Object["+n+"] is font "+i);const c=t.header.getUint8(o++);var u="";for(let e=0;e<c;e++)u+=String.fromCharCode(t.header.getUint8(o++));const l=t.header.getUint16(o,r),d=t.header.getUint16(o+2,r),f=t.header.getUint16(o+4,r),m=t.header.getUint16(o+6,r);o+=8,e.debugPackageLoader&&console.log("  "+d+"x"+f+" pixel texture contains "+m+" characters from "+l+"px "+u),s.lineHeight(l);for(let e=0;e<m;e++){const e=t.header.getUint8(o++);var g="";for(let n=0;n<e;n++)g+=String.fromCharCode(t.header.getUint8(o++));const n=t.header.getUint16(o+0,r),a=t.header.getUint16(o+2,r),i=t.header.getUint16(o+4,r),c=t.header.getUint16(o+6,r),u=t.header.getInt16(o+8,r),l=t.header.getInt16(o+10,r),d=t.header.getInt16(o+12,r);o+=14,s.addChar(g,n,a,i,c,u,l,d)}const h=t.header.getUint8(o++);var v="";for(let e=0;e<h;e++)v+=String.fromCharCode(t.header.getUint8(o++));"RGB"===v?s.dataFormat(e.gl.RGB):"RGBA"===v?s.dataFormat(e.gl.RGBA):"L"===v?s.dataFormat(e.gl.LUMINANCE):console.error("Font "+i+" unsupported mode "+v);const p=t.header.getUint16(o+0,r),x=t.header.getUint16(o+2,r);let T=t.header.getUint32(o+4,r)+t.dataOffset;o+=8,p!==d&&console.error("Font "+i+" width does not match image width"),x!==f&&console.error("Font "+i+" height does not match image height");const b=new Uint8Array(t.data,T);return s.fromArrayBuffer(b,0,d,f),s},a.loadMaterialV1=function(n,o,a){const i=n.header.getUint8(a++);var s="";for(let e=0;e<i;e++)s+=String.fromCharCode(n.header.getUint8(a++));const c=n.assetCatalog.getMaterial(s),u=n.header.getUint8(a++);e.debugPackageLoader&&console.log("Object["+o+"] is "+s+" material with "+u+" textures");for(let o=0;o<u;o++){const o=n.header.getUint8(a++);var l="";for(let e=0;e<o;e++)l+=String.fromCharCode(n.header.getUint8(a++));const i=n.header.getUint8(a++);var d="";for(let e=0;e<i;e++)d+=String.fromCharCode(n.header.getUint8(a++));const u=t.Texture(e);"RGB"===d?u.dataFormat(e.gl.RGB):"RGBA"===d?u.dataFormat(e.gl.RGBA):"L"===d?u.dataFormat(e.gl.LUMINANCE):console.error("Texture "+s+" unsupported mode "+d);const f=n.header.getUint16(a+0,r),m=n.header.getUint16(a+2,r),g=n.header.getUint32(a+4,r)+n.dataOffset;a+=8,e.debugPackageLoader&&console.log("  Texture "+l+" is "+f+"x"+m+"px in "+d+" format");const h=new Uint8Array(n.data,g);u.fromArrayBuffer(0,h,g,f,m),c.setTexture(l,u)}return c},a.loadMeshV1=function(n,a,i){const s=t.Mesh(e),c=n.header.getUint16(i,r);i+=2,e.debugPackageLoader&&console.log("Object["+a+"] is a mesh with "+c+" fragments");for(let a=0;a<c;a++){const c=n.header.getUint8(i),l=n.header.getUint8(i+1),d=n.header.getUint8(i+2),f=n.header.getUint8(i+3),m=n.header.getUint8(i+4),g=n.header.getUint8(i+5),h=n.header.getUint8(i+6),v=n.header.getUint32(i+7,r),p=n.header.getUint32(i+11,r);let x=n.header.getUint32(i+15,r)+n.dataOffset;i+=19;const T=1==(1&l),b=2==(2&l);let w=0;if(1===c?w=v/3:2===c?w=v/2:(3===c||4===c)&&(w=v-2),e.debugPackageLoader){let e="  fragment["+a+"] has "+v+" verticies forming ";switch(1===c?e+=w+" triangles":2===c?e+=w/2+" rectangles":3===c?e+="a strip of "+w+"triangles":4===c&&(e+="a fan of "+w+" triangles"),T&&(e+=" indexed"),b||(e+=" in 2D"),d){case 1:e+=" with custom normals";break;case 2:e+=" with indexed normals";break;case 3:e+=" with triangle normals"}switch(f){case 1:e+=" with custom tangents";break;case 2:e+=" with indexed tangents";break;case 3:e+=" with triangle tangents";break;case 4:e+=" with single tangent"}switch(m){case 1:e+=" with bitangents"}switch(g){case 1:e+=" with custom uvs";break;case 2:e+=" with indexed uvs";break;case 3:e+=" with triangle uvs"}switch(h){case 1:e+=" with custom colors";break;case 2:e+=" with custom colors and transparency";break;case 3:e+=" with indexed colors";break;case 4:e+=" with indexed colors and transparency"}console.log(e)}const S=T?[]:void 0;if(T){indexArray=new Int16Array(n.data,x);for(let e=0;e<v;e++)S.push(indexArray[e]);x+=2*v,1==(1&v)&&(x+=2)}const D=[],A=0===d?void 0:[],M=0===f?void 0:[],E=0===m?void 0:[],_=0===g?void 0:[],F=void 0,y=new Float32Array(n.data,x);for(let e=0;e<v;e++){let t=T?S[e]:e,n=Math.trunc(e/3);2===c?n=Math.trunc(e/4):3!==c&&4!==c||(n=e<3?0:e-2);let r=0,o=b?3*t:2*t;switch(D.push(y[o]),D.push(y[o+1]),b?(D.push(y[o+2]),r+=3*p):r+=2*p,d){case 1:o=r+3*e,r+=3*v;break;case 2:o=r+3*t,r+=3*p;break;case 3:o=r+3*n,r+=3*w}0!==d&&(A.push(y[o]),A.push(y[o+1]),A.push(y[o+2]))}if(e.debugPackageLoader&&e.debugMeshes){let e="  vertices[";for(var u=0;u<D.length;u++)u>0&&(e+=", "),e+=o(D[u]);e+="]",console.log(e)}const C=t.VertexData(e);1===c||2===c?b?C.setTriangles(D,F,_,A,M,E):C.setTriangles2D(D,F,_,A,M,E):3===c?C.setTriangleStrip(D,F,_,A,M,E):4===c&&C.setTriangleFan(D,F,_,A,M,E),s.addVertexData(C)}return s},a.loadAnimationV1=function(n,a,i){const s=n.header.getUint8(i++);var c="";for(let e=0;e<s;e++)c+=String.fromCharCode(n.header.getUint8(i++));const u=n.header.getUint8(i),l=n.header.getUint16(i+1,r),d=n.header.getUint16(i+3,r),f=n.header.getUint8(i+5);i+=6;const m=1==(1&u),g=2==(2&u);if(e.debugPackageLoader){let e="Object["+a+"] is '"+c+"' animation which runs for "+l+"x"+d+" ms";m&&(e+=". Repeats until stopped"),g&&(e+=". Plays in reverse after playing forwards"),console.log(e)}const h=t.ModelAnimation(e).name(c).loop(m).frames(l).interval(d/e.gameTickMs);for(let t=0;t<f;t++){const t=n.header.getUint8(i++);var v="";for(let e=0;e<t;e++)v+=String.fromCharCode(n.header.getUint8(i++));const a=n.header.getUint8(i++);var p="";for(let e=0;e<a;e++)p+=String.fromCharCode(n.header.getUint8(i++));e.debugPackageLoader&&e.debugAnimations&&(msg="  Channel "+p+" applies to "+v+" children",console.log(msg));const s={},c=n.header.getUint16(i,r);i+=2;for(let t=0;t<c;t++){const t=n.header.getUint16(i,r),a=n.header.getUint8(i+2),c=n.header.getFloat32(i+3,r);i+=7;var x="step";1===a?x="linear":2===a&&(x="spline"),s[t]={value:c,transition:x},e.debugPackageLoader&&e.debugAnimations&&(msg="    Keyframe["+t+"] = "+o(c)+" "+x,console.log(msg))}h.addChannel({channel:p,pattern:new RegExp(v,"i"),keyframes:s})}return h},a.loadModelV1=function(n,a,i){const s=n.header.getUint8(i++);var c="";for(let e=0;e<s;e++)c+=String.fromCharCode(n.header.getUint8(i++));const u=n.header.getUint8(i),l=n.header.getUint16(i+1,r),d=n.header.getUint16(i+3,r);i+=5;const f=t.Location(e,!0);f.translateX=n.header.getFloat32(i+0,r),f.translateY=n.header.getFloat32(i+4,r),f.translateZ=n.header.getFloat32(i+8,r),f.rotateX=n.header.getFloat32(i+12,r),f.rotateY=n.header.getFloat32(i+16,r),f.rotateZ=n.header.getFloat32(i+20,r),f.scaleX=n.header.getFloat32(i+24,r),f.scaleY=n.header.getFloat32(i+28,r),f.scaleZ=n.header.getFloat32(i+32,r),f.isModified=!0,i+=36;const m=n.header.getUint16(i,r),g=n.header.getUint16(i+2,r);i+=4;const h=1==(1&u),v=2==(2&u),p=4==(4&u);e.debugPackageLoader&&(console.log("Object["+a+"] is "+(h?"root ":"")+"model "+c+" with "+m+" children and "+g+" animations."+(p?" Paint mesh "+d:" No mesh")+(v?" with material "+l:". No material")),console.log("Object["+a+"] at ("+o(f.translateX)+","+o(f.translateY)+","+o(f.translateZ)+").["+o(f.rotateX)+","+o(f.rotateY)+","+o(f.rotateZ)+"]x("+o(f.scaleX)+","+o(f.scaleY)+","+o(f.scaleZ)+")"));const x=n.assetCatalog.getModel(c,!h);x.location=f,v&&x.material(n.materials[l]),p&&x.mesh(n.meshes[d]);for(let e=0;e<m;e++){const e=n.header.getUint16(i,r);i+=2,x.addChild(n.models[e])}if(h){e.debugAnimations&&g>0&&console.log("Model #"+a+" '"+c+"' has "+g+" animations");for(let t=0;t<g;t++){const t=n.header.getUint16(i,r);i+=2;const o=n.animations[t];if(e.debugAnimations){const e=o.getChannelGraphs();console.log("  Animation '"+o.getName()+"' has "+e.length+" channels."+(o.__private.loop?" Loop ":"")+o.__private.frames+"x"+o.__private.interval+" frames");for(let t=0;t<e.length;t++)console.log("    Animates "+e[t].channel+" for children matching "+e[t].pattern)}x.addAnimation(o)}}else g>0&&console.warn("Model #"+a+" '"+c+"' has "+g+" animations but is not a root");return x},i.loadFromBuffer=function(n,o){o||(o=t.AssetCatalog(e));const i=new Uint8Array(n),s=new DataView(n,0,i.length),c=i[0],u=s.getUint32(4,r);var l=8;const d=l+u;e.debugPackageLoader&&console.log("Asset pack V"+c+" is "+i.length+" bytes with "+u+" header bytes");const f={assetCatalog:o,header:s,data:n,dataOffset:d,materials:{},meshes:{},animations:{},models:{},fonts:{}};if(1===c)for(var m=s.getUint16(l,r),g=0;0!==m;){const e=s.getUint16(l+2,r),t=s.getUint8(l+4),n=l+5;if(e!==g++)return void console.error("Object indexes are not consecutive");if(0===t)break;1===t?f.materials[e]=a.loadMaterialV1(f,e,n):2===t?f.meshes[e]=a.loadMeshV1(f,e,n):3===t?f.animations[e]=a.loadAnimationV1(f,e,n):4===t?f.models[e]=a.loadModelV1(f,e,n):5===t?f.fonts[e]=a.loadFontV1(f,e,n):console.error("Unknown object type "+t),l+=m,m=s.getUint16(l,r)}else console.error("Version "+c+" asset packs are not supported");return o},i.loadFromUrl=function(e,t,n){var r=new XMLHttpRequest;return r.responseType="arraybuffer",r.onreadystatechange=function(){4==this.readyState&&200==this.status&&(t=i.loadFromBuffer(this.response,t),n&&n(t))},r.open("GET",e,!0),r.send(),i},i}},2636:()=>{window.frag.Font=function(e,t,n){const r=window.frag,o=e.gl,a=t||{glTexture:null,generated:!1,internalFormat:o.RGBA,format:o.RGBA,dataType:o.UNSIGNED_BYTE,valuesPerPixel:4,chars:{},lineHeight:24},i={textColor:[0,0,0,1],backgroundColor:[0,0,0,1],kerning:!1,letterSpacing:0};n&&(i.textColor=n.textColor,i.backgroundColor=n.backgroundColor,i.kerning=n.kerning,i.letterSpacing=n.letterSpacing);const s={__private:a,textureUnit:e.allocateTextureUnit(),dispose:function(){a.glTexture&&(o.deleteTexture(a.glTexture),a.glTexture=null,a.disposed=!0)},clone:function(){return window.frag.Font(e,a,i)},name:function(e){return a.name=e,s},kerning:function(e){return i.kerning=e,s},letterSpacing:function(e){return i.letterSpacing=e,s},textColor:function(e){return i.textColor=e,s},backgroundColor:function(e){return i.backgroundColor=e,s},dataFormat:function(e){return a.internalFormat=e,a.format=e,e===o.RGBA?(a.dataType=o.UNSIGNED_BYTE,a.valuesPerPixel=4):e===o.RGB?(a.dataType=o.UNSIGNED_BYTE,a.valuesPerPixel=3):e===o.LUMINANCE_ALPHA?(a.dataType=o.UNSIGNED_BYTE,a.valuesPerPixel=2):e!==o.LUMINANCE&&formaat!==o.ALPHA||(a.dataType=o.UNSIGNED_BYTE,a.valuesPerPixel=1),s}};return a.setup=function(e,t){a.width=e,a.height=t,a.glTexture||(a.glTexture=o.createTexture()),o.bindTexture(o.TEXTURE_2D,a.glTexture),0==(e&e-1)&&0==(t&t-1)||(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),a.generated=!0)},s.lineHeight=function(e){return a.lineHeight=e,s},s.addChar=function(e,t,n,r,o,i,c,u){return a.chars[e]={x:t,y:n,width:r,height:o,originX:i,originY:c,advance:u},s},s.fromArrayBuffer=function(e,t,n,r){let i;return a.dataType===o.UNSIGNED_BYTE&&(i=new Uint8Array(e,t,n*r*a.valuesPerPixel)),a.setup(n,r),o.texImage2D(o.TEXTURE_2D,0,a.internalFormat,n,r,0,a.format,a.dataType,i),s},s.fromImage=function(e){const t=function(){a.setup(e.width,e.height),o.texImage2D(o.TEXTURE_2D,0,a.internalFormat,a.format,a.dataType,e)};return e.onload?t():e.onload=t,s},s.apply=function(t){const n=e.gl;void 0!==t.uniforms.fgcolor&&n["uniform"+i.textColor.length+"fv"](t.uniforms.fgcolor,i.textColor),void 0!==t.uniforms.bgcolor&&n["uniform"+i.backgroundColor.length+"fv"](t.uniforms.bgcolor,i.backgroundColor);const r=t.uniforms.diffuse;return r&&a.glTexture?(n.activeTexture(n.TEXTURE0+s.textureUnit),n.bindTexture(n.TEXTURE_2D,a.glTexture),a.generated||(n.generateMipmap(n.TEXTURE_2D),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),a.generated=!0),n.uniform1i(r,s.textureUnit),s):s},s.buildTextMesh=function(t){const n=[],o=[],s=[],c=function(e,t){if(dimensions=a.chars[e],!dimensions)return t;const r=t-dimensions.originX,c=r+dimensions.width,u=dimensions.originY;!function(e,t,r,o){n.push(e),n.push(o),n.push(0),n.push(t),n.push(r),n.push(0),n.push(e),n.push(r),n.push(0),n.push(e),n.push(o),n.push(0),n.push(t),n.push(o),n.push(0),n.push(t),n.push(r),n.push(0);for(let e=0;e<6;e++)s.push(0),s.push(0),s.push(-1)}(r,c,u,u-dimensions.height);const l=dimensions.x,d=a.height-dimensions.y;!function(e,t,n,r){e/=a.width,t/=a.width,n/=a.height,r/=a.height,o.push(e),o.push(r),o.push(t),o.push(n),o.push(e),o.push(n),o.push(e),o.push(r),o.push(t),o.push(r),o.push(t),o.push(n)}(l,l+dimensions.width,d,d-dimensions.height);let f=dimensions.advance;return i.kerning||(f=dimensions.width>dimensions.advance?dimensions.width:dimensions.advance),t+f+i.letterSpacing};let u=0;for(let e=0;e<t.length;e++)u=c(t[e],u);return r.Mesh(e).addTriangles(n,void 0,o,s).shadeFlat().textureFlat()},s.buildTextModel=function(t){const n=s.buildTextMesh(t);return r.Model(e,!0).shader(r.FontShader(e)).mesh(n).material(s)},s.updateTextModel=function(e,t){const n=e.getMesh();return e.mesh(s.buildTextMesh(t)),n.dispose(),s},s}},4655:()=>{window.frag.Material=function(e){const t={textures:{},disposeTextures:!1},n={__private:t,dispose:function(){if(t.disposeTextures)for(let e in t.textures){const n=t.textures[e];n&&n.dispose()}t.textures={}},disposeTextures:function(e){return t.disposeTextures=e,n},name:function(e){return t.name=e,n},setTexture:function(e,r){if(t.disposeTextures){const n=t.textures[e];n&&n.dispose()}return t.textures[e]=r,n},apply:function(e){for(let n in t.textures){const r=t.textures[n];r&&r.apply(n,e)}return n}};return n}},8394:()=>{window.frag.Texture=function(e){const t=e.gl,n={glTexture:null,generated:!1,internalFormat:t.RGBA,format:t.RGBA,dataType:t.UNSIGNED_BYTE,valuesPerPixel:4},r={__private:n,textureUnit:e.allocateTextureUnit(),dispose:function(){n.glTexture&&(t.deleteTexture(n.glTexture),n.glTexture=null,n.disposed=!0)},name:function(e){return n.name=e,r},dataFormat:function(e){return n.internalFormat=e,n.format=e,e===t.RGBA?(n.dataType=t.UNSIGNED_BYTE,n.valuesPerPixel=4):e===t.RGB?(n.dataType=t.UNSIGNED_BYTE,n.valuesPerPixel=3):e===t.LUMINANCE_ALPHA?(n.dataType=t.UNSIGNED_BYTE,n.valuesPerPixel=2):e!==t.LUMINANCE&&formaat!==t.ALPHA||(n.dataType=t.UNSIGNED_BYTE,n.valuesPerPixel=1),r}};return n.setup=function(e,r){n.width=e,n.height=r,n.glTexture||(n.glTexture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,n.glTexture),0==(e&e-1)&&0==(r&r-1)||(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),n.generated=!0)},r.fromArrayBuffer=function(e,o,a,i,s){let c;return n.dataType===t.UNSIGNED_BYTE&&(c=new Uint8Array(o,a,i*s*n.valuesPerPixel)),n.setup(i,s),t.texImage2D(t.TEXTURE_2D,e,n.internalFormat,i,s,0,n.format,n.dataType,c),r},r.fromImage=function(e,o){const a=function(){n.setup(o.width,o.height),t.texImage2D(t.TEXTURE_2D,e,n.internalFormat,n.format,n.dataType,o)};return o.onload?a():o.onload=a,r},r.fromUrl=function(e,t,n){const o=new Image;return r.fromImage(e,o),void 0!==n&&(o.crossOrigin=n),o.src=t,r},r.update=function(o,a){return n.scene?(void 0!==o&&void 0!==a&&(o===n.width&&a===n.height||r.fromScene(n.scene,o,a)),t.bindFramebuffer(t.FRAMEBUFFER,n.frameBuffer),t.viewport(0,0,n.width,n.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),n.scene.adjustToViewport(),n.scene.draw(frag.DrawContext(e).forRender()),r):r},r.fromScene=function(e,o,a){return n.setup(o,a),t.texImage2D(t.TEXTURE_2D,0,n.internalFormat,o,a,0,n.format,n.dataType,null),n.scene=e,n.frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,n.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.glTexture,0),n.depthBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,n.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,o,a),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n.depthBuffer),r.update(o,a)},r.apply=function(t,o){const a=o.uniforms[t];if(!a||!n.glTexture)return r;const i=e.gl;return i.activeTexture(i.TEXTURE0+r.textureUnit),i.bindTexture(i.TEXTURE_2D,n.glTexture),n.generated||(i.generateMipmap(i.TEXTURE_2D),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),n.generated=!0),i.uniform1i(a,r.textureUnit),r},r}},7996:()=>{window.frag=window.frag||{},window.frag.Matrix={m3Identity:function(){return[1,0,0,0,1,0,0,0,1]},m3Invert:function(e){return e},m3Transpose:function(e){return[e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]]},m3Xm3:function(e,t){const n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],d=t[0],f=t[1],m=t[2],g=t[3],h=t[4],v=t[5],p=t[6],x=t[7],T=t[8];return[d*n+f*a+m*c,d*r+f*i+m*u,d*o+f*s+m*l,g*n+h*a+v*c,g*r+h*i+v*u,g*o+h*s+v*l,p*n+x*a+T*c,p*r+x*i+T*u,p*o+x*s+T*l]},m3Xv3:function(e,t){const n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],d=t[0],f=t[1],m=t[2];return[d*n+f*a+m*c,d*r+f*i+m*u,d*o+f*s+m*l]},m4Identity:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},m4Invert:function(e){e=window.frag.Matrix.m4Transpose(e);const t=[];t[0]=e[5]*e[10]*e[15]-e[5]*e[14]*e[11]-e[6]*e[9]*e[15]+e[6]*e[13]*e[11]+e[7]*e[9]*e[14]-e[7]*e[13]*e[10],t[1]=-e[4]*e[10]*e[15]+e[4]*e[14]*e[11]+e[6]*e[8]*e[15]-e[6]*e[12]*e[11]-e[7]*e[8]*e[14]+e[7]*e[12]*e[10],t[2]=e[4]*e[9]*e[15]-e[4]*e[13]*e[11]-e[5]*e[8]*e[15]+e[5]*e[12]*e[11]+e[7]*e[8]*e[13]-e[7]*e[12]*e[9],t[3]=-e[4]*e[9]*e[14]+e[4]*e[13]*e[10]+e[5]*e[8]*e[14]-e[5]*e[12]*e[10]-e[6]*e[8]*e[13]+e[6]*e[12]*e[9],t[4]=-e[1]*e[10]*e[15]+e[1]*e[14]*e[11]+e[2]*e[9]*e[15]-e[2]*e[13]*e[11]-e[3]*e[9]*e[14]+e[3]*e[13]*e[10],t[5]=e[0]*e[10]*e[15]-e[0]*e[14]*e[11]-e[2]*e[8]*e[15]+e[2]*e[12]*e[11]+e[3]*e[8]*e[14]-e[3]*e[12]*e[10],t[6]=-e[0]*e[9]*e[15]+e[0]*e[13]*e[11]+e[1]*e[8]*e[15]-e[1]*e[12]*e[11]-e[3]*e[8]*e[13]+e[3]*e[12]*e[9],t[7]=e[0]*e[9]*e[14]-e[0]*e[13]*e[10]-e[1]*e[8]*e[14]+e[1]*e[12]*e[10]+e[2]*e[8]*e[13]-e[2]*e[12]*e[9],t[8]=e[1]*e[6]*e[15]-e[1]*e[14]*e[7]-e[2]*e[5]*e[15]+e[2]*e[13]*e[7]+e[3]*e[5]*e[14]-e[3]*e[13]*e[6],t[9]=-e[0]*e[6]*e[15]+e[0]*e[14]*e[7]+e[2]*e[4]*e[15]-e[2]*e[12]*e[7]-e[3]*e[4]*e[14]+e[3]*e[12]*e[6],t[10]=e[0]*e[5]*e[15]-e[0]*e[13]*e[7]-e[1]*e[4]*e[15]+e[1]*e[12]*e[7]+e[3]*e[4]*e[13]-e[3]*e[12]*e[5],t[11]=-e[0]*e[5]*e[14]+e[0]*e[13]*e[6]+e[1]*e[4]*e[14]-e[1]*e[12]*e[6]-e[2]*e[4]*e[13]+e[2]*e[12]*e[5],t[12]=-e[1]*e[6]*e[11]+e[1]*e[10]*e[7]+e[2]*e[5]*e[11]-e[2]*e[9]*e[7]-e[3]*e[5]*e[10]+e[3]*e[9]*e[6],t[13]=e[0]*e[6]*e[11]-e[0]*e[10]*e[7]-e[2]*e[4]*e[11]+e[2]*e[8]*e[7]+e[3]*e[4]*e[10]-e[3]*e[8]*e[6],t[14]=-e[0]*e[5]*e[11]+e[0]*e[9]*e[7]+e[1]*e[4]*e[11]-e[1]*e[8]*e[7]-e[3]*e[4]*e[9]+e[3]*e[8]*e[5],t[15]=e[0]*e[5]*e[10]-e[0]*e[9]*e[6]-e[1]*e[4]*e[10]+e[1]*e[8]*e[6]+e[2]*e[4]*e[9]-e[2]*e[8]*e[5];var n=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3];0===n&&console.error("Matrix can not be inverted");for(var r=0;r<16;r++)t[r]/=n;return t},m4Transpose:function(e){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]},m4Xm4:function(e,t){const n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],d=e[9],f=e[10],m=e[11],g=e[12],h=e[13],v=e[14],p=e[15],x=t[0],T=t[1],b=t[2],w=t[3],S=t[4],D=t[5],A=t[6],M=t[7],E=t[8],_=t[9],F=t[10],y=t[11],C=t[12],L=t[13],R=t[14],V=t[15];return[x*n+T*i+b*l+w*g,x*r+T*s+b*d+w*h,x*o+T*c+b*f+w*v,x*a+T*u+b*m+w*p,S*n+D*i+A*l+M*g,S*r+D*s+A*d+M*h,S*o+D*c+A*f+M*v,S*a+D*u+A*m+M*p,E*n+_*i+F*l+y*g,E*r+_*s+F*d+y*h,E*o+_*c+F*f+y*v,E*a+_*u+F*m+y*p,C*n+L*i+R*l+V*g,C*r+L*s+R*d+V*h,C*o+L*c+R*f+V*v,C*a+L*u+R*m+V*p]},m4Xv4:function(e,t){const n=e[0],r=e[1],o=e[2],a=e[3],i=e[4],s=e[5],c=e[6],u=e[7],l=e[8],d=e[9],f=e[10],m=e[11],g=e[12],h=e[13],v=e[14],p=e[15],x=t[0],T=t[1],b=t[2],w=t[3];return[x*n+T*i+b*l+w*g,x*r+T*s+b*d+w*h,x*o+T*c+b*f+w*v,x*a+T*u+b*m+w*p]},mult:function(e,t){if(9===e.length){if(Array.isArray(t)){if(9===t.length)return frag.Matrix.m3xm3(e,t);if(3===t.length)return frag.Matrix.m3Xv3(e,t)}console.error("Invalid M3 matrix multiplication operation",e,t)}else if(16===e.length){if(Array.isArray(t)){if(16===t.length)return frag.Matrix.m4Xm4(e,t);if(4===t.length)return frag.Matrix.m4Xv4(e,t)}console.error("Invalid M4 matrix multiplication operation",e,t)}else console.error("Invalid matrix multiplication operation",e,t)},perspective:function(e,t,n,r){var o=Math.tan(e)*n,a=o*t;return window.frag.Matrix.frustum(-a,a,-o,o,n,r)},frustum:function(e,t,n,r,o,a){const i=[];return i[0]=2*o/(t-e),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*o/(r-n),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(a+o)/(a-o),i[11]=1,i[12]=-o*(t+e)/(t-e),i[13]=-o*(r+n)/(r-n),i[14]=2*a*o/(o-a),i[15]=0,i},orthographic:function(e,t,n,r,o,a){const i=[];return i[0]=2/(t-e),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(r-n),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2/(a-o),i[11]=0,i[12]=-(t+e)/(t-e),i[13]=-(r+n)/(r-n),i[14]=-(a+o)/(a-o),i[15]=1,i}}},8197:()=>{window.frag=window.frag||{},window.frag.Triangle={makeTriangleFromVectors:function(e,t,n){return{a:e,b:t,c:n}},makeTriangleFromArray2D:function(e,t,n,r){return e?{a:[e[t],e[t+1]],b:[e[n],e[n+1]],c:[e[r],e[r+1]]}:null},makeTriangleFromArray3D:function(e,t,n,r){return e?{a:[e[t],e[t+1],e[t+2]],b:[e[n],e[n+1],e[n+2]],c:[e[r],e[r+1],e[r+2]]}:null},normal:function(e){const t=window.frag.Vector,n=t.sub(e.a,e.b),r=t.sub(e.c,e.b);return t.normalize(t.cross(n,r))}}},6601:()=>{window.frag=window.frag||{},window.frag.Vector={extract2D:function(e,t){return e?[e[t=t||0],e[t+1]]:null},extract3D:function(e,t){return e?[e[t=t||0],e[t+1],e[t+2]]:null},zero:function(e){const t=[0,0,0,0,0];return t.length=e,t},add:function(e,t){const n=[];if(Array.isArray(t))for(let r=0;r<e.length;r++)n.push(e[r]+t[r]);else for(let r=0;r<e.length;r++)n.push(e[r]+t);return n},sub:function(e,t){const n=[];if(Array.isArray(t))for(let r=0;r<e.length;r++)n.push(e[r]-t[r]);else for(let r=0;r<e.length;r++)n.push(e[r]-t);return n},mult:function(e,t){const n=[];if(Array.isArray(t))for(let r=0;r<e.length;r++)n.push(e[r]*t[r]);else for(let r=0;r<e.length;r++)n.push(e[r]*t);return n},div:function(e,t){const n=[];if(Array.isArray(t))for(let r=0;r<e.length;r++)n.push(e[r]/t[r]);else for(let r=0;r<e.length;r++)n.push(e[r]/t);return n},length:function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n]*e[n];return Math.sqrt(t)},average:function(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(.5*(e[r]+t[r]));return n},cross:function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},dot:function(e,t){let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n},normalize:function(e){const t=window.frag.Vector.length(e);if(t<1e-5)return e;const n=[];for(let r=0;r<e.length;r++)n.push(e[r]/t);return n},append:function(e,t){for(let n=0;n<t.length;n++)e.push(t[n])},heading:function(e,t){const n=window.frag.Vector;t||(t=[0,1,0]);const r=n.normalize(e),o=n.normalize(t),a=Math.asin(r[1]),i=Math.atan2(r[0],r[2]),s=[-r[2],0,r[0]],c=n.cross(s,r);return[Math.atan2(n.dot(s,o),n.dot(c,o)),i,a]},quaternion:function(e){return window.frag.Vector.quaternionXYZ(e[0],e[1],e[2])},quaternionXYZ:function(e,t,n){const r=Math.cos(.5*e),o=Math.sin(.5*e),a=Math.cos(.5*t),i=Math.sin(.5*t),s=Math.cos(.5*n),c=Math.sin(.5*n);return[r*a*s+o*i*c,o*a*s-r*i*c,r*i*s+o*a*c,r*a*c-o*i*s]},euler:function(e){return window.frag.Vector.eulerWXYZ(e[0],e[1],e[2],e[3])},eulerWXYZ:function(e,t,n,r){const o=2*(e*t+n*r),a=1-2*(t*t+n*n),i=2*(e*n-r*t),s=2*(e*r+t*n),c=1-2*(n*n+r*r);return[Math.atan2(o,a),Math.abs(i)>=1?Math.PI*(i>0?.5:-.5):Math.asin(i),Math.atan2(s,c)]}}},3533:()=>{window.frag.DrawContext=function(e){const t={stack:[]},n={__private:t,shader:null,isHitTest:!1,sceneObjects:null,models:null,worldToClipTransform:null,state:{animationMap:null,childMap:null,modelToWorldMatrix:null,modelToClipMatrix:null}};return t.pushState=function(){t.stack.push(n.state),n.state=Object.assign({},n.state)},t.popState=function(){n.state=t.stack.pop()},n.forHitTest=function(e){return n.shader=e,n.sceneObjects=[],n.models=[],n.isHitTest=!0,n},n.forRender=function(){return n},n.beginScene=function(e){return n.worldToClipTransform=e.worldToClipTransform,n},n.endScene=function(){return n},n.beginSceneObject=function(e,r,o){t.pushState(),n.state.animationMap=r,n.state.childMap=o;const a=e.getMatrix();if(n.state.modelToWorldMatrix){const e=frag.Matrix;n.worldToClipTransform.is3d?(n.state.modelToWorldMatrix=e.m4Xm4(n.state.modelToWorldMatrix,a),n.state.modelToClipMatrix=e.m4Xm4(n.state.modelToClipMatrix,a)):(n.state.modelToWorldMatrix=e.m3Xm3(n.state.modelToWorldMatrix,a),n.state.modelToClipMatrix=e.m3Xm3(n.state.modelToClipMatrix,a))}else{const e=n.worldToClipTransform.getMatrix();n.state.modelToWorldMatrix=a,n.state.modelToClipMatrix=n.worldToClipTransform.is3d?frag.Matrix.m4Xm4(e,a):frag.Matrix.m3Xm3(e,a)}return n},n.endSceneObject=function(){return t.popState(),n},n.beginModel=function(e,r){t.pushState();const o=n.state.animationMap,a=o&&e?o[e]:null;a&&(r=r.clone().add(a.location));const i=r.getMatrix(),s=frag.Matrix;n.worldToClipTransform.is3d?(n.state.modelToWorldMatrix=s.m4Xm4(n.state.modelToWorldMatrix,i),n.state.modelToClipMatrix=s.m4Xm4(n.state.modelToClipMatrix,i)):(n.state.modelToWorldMatrix=s.m3Xm3(n.state.modelToWorldMatrix,i),n.state.modelToClipMatrix=s.m3Xm3(n.state.modelToClipMatrix,i))},n.endModel=function(){return t.popState(),n},n}},9521:()=>{window.frag.Mesh=function(e){const t=window.frag,n=e.gl,r={glBuffer:n.createBuffer(),meshFragments:[],debugFragments:[],finalized:!1,fromBuffer:!1,smoothShading:!0,smoothTexture:!1,wireframe:!1,normalLength:0,normalColor:[0,0,255]},o={__private:r,calcNormals:!0,calcTangents:!0,calcBitangents:!1,dispose:function(){r.glBuffer&&(n.deleteBuffer(r.glBuffer),r.glBuffer=null)},name:function(e){return r.name=e,o},clear:function(){return r.meshFragments.length=0,r.finalized=!1,o},shadeSmooth:function(){return r.smoothShading=!0,r.finalized=!1,o},shadeFlat:function(){return r.smoothShading=!1,r.finalized=!1,o},textureSmooth:function(){return r.smoothTexture=!0,r.finalized=!1,o},textureFlat:function(){return r.smoothTexture=!1,r.finalized=!1,o},wireframe:function(e){return r.wireframe=!!e,r.finalized=!1,o},drawNormals:function(e,t){return r.normalLength=e,void 0!==t&&(r.normalColor=t),r.finalized=!1,o}};return r.Fragment=function(e){return{vertexData:e,renderData:null,vertexDataOffset:void 0,colorDataOffset:void 0,uvDataOffset:void 0,normalDataOffset:void 0,tangentDataOffset:void 0,bitangentDataOffset:void 0}},r.addFragment=function(e){return r.meshFragments.push(r.Fragment(e)),r.finalized=!1,o},o.addVertexData=function(e){return r.addFragment(e)},o.addTriangles2D=function(n,o,a,i,s,c){const u=t.VertexData(e).setTriangles2D(n,o,a,i,s,c);return r.addFragment(u)},o.addTriangles=function(n,o,a,i,s,c){const u=t.VertexData(e).setTriangles(n,o,a,i,s,c);return r.addFragment(u)},o.addTriangleStrip=function(n,o,a,i,s,c){const u=t.VertexData(e).setTriangleStrip(n,o,a,i,s,c);return r.addFragment(u)},o.addTriangleFan=function(n,o,a,i,s,c){const u=t.VertexData(e).setTriangleFan(n,o,a,i,s,c);return r.addFragment(u)},o.fromBuffer=function(a,i,s,c,u,l,d,f,m,g){const h=t.VertexData(e);h.vertexDimensions=i,h.vertexCount=s,h.primitiveType=c,h.extractTriangles=function(){},r.addFragment(h);const v=r.meshFragments[r.meshFragments.length-1];return v.renderData=h,v.vertexDataOffset=u,v.colorDataOffset=l,v.uvDataOffset=d,v.normalDataOffset=f,v.tangentDataOffset=m,v.bitangentDataOffset=g,n.bindBuffer(n.ARRAY_BUFFER,r.glBuffer),n.bufferData(n.ARRAY_BUFFER,a,n.STATIC_DRAW),r.finalized=!0,r.fromBuffer=!0,o},r.addFragmentDebugInfo=function(n){if(!r.wireframe&&0==r.normalLength)return;let o=n;r.wireframe||(o=r.Fragment(n.vertexData),r.debugFragments.push(o));const a=[],i=[],s=[],c=[],u=function(e){const t=n.renderData.getVertexVector(e),o=n.renderData.getColor(e),u=n.renderData.getUvVector(e),l=n.renderData.getNormalVector(e);t&&t.forEach((e=>a.push(e))),o?o.forEach((e=>i.push(e))):r.normalColor.forEach((()=>i.push(0))),u&&u.forEach((e=>s.push(e))),l&&l.forEach((e=>c.push(e)))},l=function(e){const t=n.renderData.getVertexVector(e),o=n.renderData.getUvVector(e),u=n.renderData.getNormalVector(e);if(t){for(let e=0;e<t.length;e++)a.push(t[e]);for(let e=0;e<t.length;e++)a.push(t[e]+u[e]*r.normalLength)}r.normalColor.forEach((e=>i.push(e))),r.normalColor.forEach((e=>i.push(e))),o&&(o.forEach((e=>s.push(e))),o.forEach((e=>s.push(e)))),u&&(u.forEach((e=>c.push(e))),u.forEach((e=>c.push(e))))};n.vertexData.extractTriangles((function(e,t,n){r.wireframe&&(u(e),u(t),u(t),u(n),u(n),u(e)),r.normalLength>0&&(l(e),l(t),l(t))})),2==n.vertexData.vertexDimensions?o.renderData=t.VertexData(e).setLines2D(a,i,s,c):o.renderData=t.VertexData(e).setLines(a,i,s,c)},r.finalize=function(){r.finalized=!0;const a=t.MeshOptimizer(e).setFragments(r.meshFragments).initialize(r.smoothShading,r.smoothTexture);o.calcTangents&&a.calcTangentsFromUvs(),o.calcBitangents&&a.calcBitangentsFromUvs(),o.calcNormals&&a.calcNormalsFromCross(),o.calcNormals&&a.calcNormalsFromGeometry(),o.calcBitangents&&a.calcBitangentsFromCross(),r.debugFragments=[],r.meshFragments.forEach((e=>{r.addFragmentDebugInfo(e)}));let i=0;const s=function(e){i+=e.renderData.verticies.length,e.renderData.colors&&(i+=e.renderData.colors.length),e.renderData.uvs&&(i+=e.renderData.uvs.length),e.renderData.normals&&(i+=e.renderData.normals.length),e.renderData.tangents&&(i+=e.renderData.tangents.length),e.renderData.bitangents&&(i+=e.renderData.bitangents.length)};r.meshFragments.forEach(s),r.debugFragments.forEach(s);const c=new Float32Array(i);let u=0;const l=function(e){if(!e)return;for(let t=0;t<e.length;t++)c[u+t]=e[t];const t=u;return u+=e.length,t*Float32Array.BYTES_PER_ELEMENT},d=function(e){e.vertexDataOffset=l(e.renderData.verticies),e.colorDataOffset=l(e.renderData.colors),e.uvDataOffset=l(e.renderData.uvs),e.normalDataOffset=l(e.renderData.normals),e.tangentDataOffset=l(e.renderData.tangents),e.bitangentDataOffset=l(e.renderData.bitangents)};return r.meshFragments.forEach(d),r.debugFragments.forEach(d),n.bindBuffer(n.ARRAY_BUFFER,r.glBuffer),n.bufferData(n.ARRAY_BUFFER,c,n.STATIC_DRAW),o},r.drawFragmentPosition=function(e,t){e.attributes.position>=0&&(null!=t.vertexDataOffset?(n.enableVertexAttribArray(e.attributes.position),n.vertexAttribPointer(e.attributes.position,t.renderData.vertexDimensions,n.FLOAT,!1,0,t.vertexDataOffset)):n.disableVertexAttribArray(e.attributes.position))},r.drawFragmentColor=function(e,t){e.attributes.color>=0&&(null!=t.colorDataOffset?(n.enableVertexAttribArray(e.attributes.color),n.vertexAttribPointer(e.attributes.color,t.renderData.colorDimensions,n.FLOAT,!1,0,t.colorDataOffset)):n.disableVertexAttribArray(e.attributes.color))},r.drawFragmentTexture=function(e,t){e.attributes.texcoord>=0&&(null!=t.uvDataOffset?(n.enableVertexAttribArray(e.attributes.texcoord),n.vertexAttribPointer(e.attributes.texcoord,t.renderData.uvDimensions,n.FLOAT,!1,0,t.uvDataOffset)):n.disableVertexAttribArray(e.attributes.texcoord))},r.drawFragmentNormals=function(e,t){e.attributes.normal>=0&&(null!=t.normalDataOffset?(n.enableVertexAttribArray(e.attributes.normal),n.vertexAttribPointer(e.attributes.normal,t.renderData.normalDimensions,n.FLOAT,!0,0,t.normalDataOffset)):n.disableVertexAttribArray(e.attributes.normal))},r.drawFragmentTangents=function(e,t){e.attributes.tangent>=0&&(null!=t.tangentDataOffset?(n.enableVertexAttribArray(e.attributes.tangent),n.vertexAttribPointer(e.attributes.tangent,t.renderData.normalDimensions,n.FLOAT,!0,0,t.tangentDataOffset)):n.disableVertexAttribArray(e.attributes.tangent))},r.drawFragmentBitangents=function(e,t){e.attributes.bitangent>=0&&(null!=t.bitangentDataOffset?(n.enableVertexAttribArray(e.attributes.bitangent),n.vertexAttribPointer(e.attributes.bitangent,t.renderData.normalDimensions,n.FLOAT,!0,0,t.bitangentDataOffset)):n.disableVertexAttribArray(e.attributes.bitangent))},r.drawFragment=function(e,t){r.drawFragmentPosition(e,t),r.drawFragmentColor(e,t),r.drawFragmentTexture(e,t),r.drawFragmentNormals(e,t),r.drawFragmentTangents(e,t),r.drawFragmentBitangents(e,t),n.drawArrays(t.renderData.primitiveType,0,t.renderData.vertexCount)},o.draw=function(t){r.finalized||r.fromBuffer||r.finalize();const n=e.gl;n.bindBuffer(n.ARRAY_BUFFER,r.glBuffer);for(let e=0;e<r.meshFragments.length;e++){const n=r.meshFragments[e];r.drawFragment(t,n)}for(let e=0;e<r.debugFragments.length;e++){const n=r.debugFragments[e];r.drawFragment(t,n)}return o},o}},1003:()=>{window.frag.MeshOptimizer=function(e){const t=window.frag,n={meshFragments:null,smoothShading:!0,smoothTexture:!1,fragmentTriangles:null,groups:null,groupIndecies:null},r={__private:n,dispose:function(){}};return n.ensureTriangles=function(){n.fragmentTriangles||(n.fragmentTriangles=[],n.meshFragments.forEach((e=>{const r=e.vertexData,o={triangles:[],vertexTriangleIndecies:[]};o.vertexTriangleIndecies.length=r.vertexCount,r.verticies&&r.extractTriangles((function(e,n,a){const i=r.getVertexVector(e),s=r.getVertexVector(n),c=r.getVertexVector(a),u={triangle:t.Triangle.makeTriangleFromVectors(i,s,c),normal:null,tangent:null,bitangent:null};if(u.normal=t.Triangle.normal(u.triangle),r.uvs){const o=r.getUvVector(e),l=r.getUvVector(n),d=r.getUvVector(a),f=t.Vector,m=f.sub(s,i),g=f.sub(c,i),h=f.sub(l,o),v=f.sub(d,o),p=h[0]*v[1]-h[1]*v[0];if(0===p)u.tangent=f.zero(r.normalDimensions),u.bitangent=f.zero(r.normalDimensions);else{const e=1/p;u.tangent=f.normalize(f.mult(f.sub(f.mult(m,v[1]),f.mult(g,h[1])),e)),u.bitangent=f.normalize(f.mult(f.sub(f.mult(g,h[0]),f.mult(m,v[0])),e))}}o.triangles.push(u);const l=o.triangles.length-1;o.vertexTriangleIndecies[e]=l,o.vertexTriangleIndecies[n]=l,o.vertexTriangleIndecies[a]=l})),n.fragmentTriangles.push(o)})))},n.ensureGroups=function(){if(n.groups)return;n.groups=[],n.groupIndecies={};const e=function(e,t,n){if(e.vertexDimensions!==n.length)return!1;const r=e.vertexIndex(t);for(var o=0;o<n.length;o++)if(Math.abs(e.verticies[r+o]-n[o])>1e-5)return!1;return!0};for(let o=0;o<n.meshFragments.length;o++){const a=n.meshFragments[o],i=n.groupIndecies[o]||[];if(n.groupIndecies[o]=i,a.vertexData.verticies)for(let s=0;s<a.vertexData.vertexCount;s++){let c=!1;for(var r=0;!c&&r<n.groups.length;r++){const t=n.groups[r];e(a.vertexData,s,t.vertex)&&(t.fragmentIndecies[o]=t.fragmentIndecies[o]||[],t.fragmentIndecies[o].push(s),i.push(r),c=!0)}if(!c){i.push(n.groups.length);const e={vertex:a.vertexData.getVertexVector(s),fragmentIndecies:{},normal:t.Vector.zero(a.vertexData.normalDimensions),uv:t.Vector.zero(a.vertexData.uvDimensions)};e.fragmentIndecies[o]=[s],n.groups.push(e)}}}},n.calcGroupNormals=function(){n.ensureGroups();for(let e=0;e<n.groups.length;e++){const r=n.groups[e];r.normal=t.Vector.zero(n.meshFragments[0].renderData.normalDimensions);for(const e in r.fragmentIndecies){const o=n.meshFragments[e],a=o.renderData?o.renderData:o.vertexData;if(a&&a.normals){const n=r.fragmentIndecies[e];for(let e=0;e<n.length;e++){const o=n[e],i=a.getNormalVector(o);r.normal=t.Vector.add(r.normal,i)}}}r.normal=t.Vector.normalize(r.normal)}},n.calcGroupUvs=function(){n.ensureGroups();for(let e=0;e<n.groups.length;e++){const t=n.groups[e];for(const e in t.fragmentIndecies){const r=n.meshFragments[e],o=r.renderData?r.renderData:r.vertexData;if(o){const n=t.fragmentIndecies[e];if(n.length>0){const e=n[0];t.uv=o.getUvVector(e)}}}}},n.calcSmoothShading=function(){for(let e=0;e<n.meshFragments.length;e++)if(!n.meshFragments[e].renderData.normals)return;n.calcGroupNormals();for(let r=0;r<n.meshFragments.length;r++){const o=n.meshFragments[r].renderData,a=n.groupIndecies[r];if(a.length){o.normals=[];for(var e=0;e<o.vertexCount;e++){const r=n.groups[a[e]];for(var t=0;t<o.normalDimensions;t++)o.normals.push(r.normal[t])}}}},n.calcSmoothTexture=function(){n.calcGroupUvs();for(let r=0;r<n.meshFragments.length;r++){const o=n.meshFragments[r].renderData,a=n.groupIndecies[r];if(a.length){o.uvs=[];for(var e=0;e<o.vertexCount;e++){const r=n.groups[a[e]];for(var t=0;t<o.uvDimensions;t++)o.uvs.push(r.uv[t])}}}},r.setFragments=function(e){return n.meshFragments=e,r},r.initialize=function(e,t){return n.smoothShading=e,n.smoothTexture=t,n.meshFragments.forEach((e=>{e.renderData=e.vertexData.clone()})),t&&n.calcSmoothTexture(),r},r.calcTangentsFromUvs=function(){for(let t=0;t<n.meshFragments.length;t++){const r=n.meshFragments[t],o=r.renderData,a=r.vertexData;if(!o.tangents)if(a.tangents){o.tangents=[];for(let t=0;t<a.vertexCount;t++)for(var e=0;e<a.normalDimensions;e++)o.tangents.push(a.tangents[a.tangentIndex(t,e)])}else if(o.uvs){n.ensureTriangles();const e=n.fragmentTriangles[t];if(e&&e.triangles){o.tangents=[],o.tangents.length=o.normalDimensions*o.vertexCount;for(let t=0;t<o.vertexCount;t++){const n=e.vertexTriangleIndecies[t],r=e.triangles[n];r&&o.setTangentVector(t,r.tangent)}}}}return r},r.calcBitangentsFromUvs=function(){for(let t=0;t<n.meshFragments.length;t++){const r=n.meshFragments[t],o=r.renderData,a=r.vertexData;if(!o.bitangents)if(a.bitangents){o.bitangents=[];for(let t=0;t<a.vertexCount;t++)for(var e=0;e<a.normalDimensions;e++)o.bitangents.push(a.bitangents[a.bitangentIndex(t,e)])}else if(o.uvs){n.ensureTriangles();const e=n.fragmentTriangles[t];if(e&&e.triangles){o.bitangents=[],o.bitangents.length=o.normalDimensions*o.vertexCount;for(let t=0;t<o.vertexCount;t++){const n=e.vertexTriangleIndecies[t],r=e.triangles[n];r&&o.setBitangentVector(t,r.bitangent)}}}}return r},r.calcNormalsFromCross=function(){for(let r=0;r<n.meshFragments.length;r++){const o=n.meshFragments[r],a=o.renderData,i=o.vertexData;if(!a.normals)if(i.normals){a.normals=[];for(let t=0;t<i.vertexCount;t++)for(var e=0;e<i.normalDimensions;e++)a.normals.push(i.normals[i.normalIndex(t,e)])}else if(a.tangents&&a.bitangents){a.normals=[];for(let n=0;n<i.vertexCount;n++){const r=a.getTangentVector(n),o=a.getBitangentVector(n),i=t.Vector.cross(r,o);for(e=0;e<i.length;e++)a.normals.push(i[e])}}}return n.smoothShading&&n.calcSmoothShading(),r},r.calcNormalsFromGeometry=function(){for(let t=0;t<n.meshFragments.length;t++){const r=n.meshFragments[t],o=r.renderData,a=r.vertexData;if(!o.normals)if(a.normals){o.normals=[];for(let t=0;t<a.vertexCount;t++)for(var e=0;e<a.normalDimensions;e++)o.normals.push(a.normals[a.normalIndex(t,e)])}else{n.ensureTriangles();const e=n.fragmentTriangles[t];if(e&&e.triangles){o.normals=[],o.normals.length=o.normalDimensions*o.vertexCount;for(let t=0;t<o.vertexCount;t++){const n=e.vertexTriangleIndecies[t],r=e.triangles[n];r&&o.setNormalVector(t,r.normal)}}}}return n.smoothShading&&n.calcSmoothShading(),r},r.calcBitangentsFromCross=function(){for(let r=0;r<n.meshFragments.length;r++){const o=n.meshFragments[r],a=o.renderData,i=o.vertexData;if(!a.bitangents)if(i.bitangents){a.bitangents=[];for(let t=0;t<i.vertexCount;t++)for(var e=0;e<i.normalDimensions;e++)a.bitangents.push(i.bitangents[i.bitangentIndex(t,e)])}else if(a.tangents&&a.normals){a.bitangents=[];for(let n=0;n<i.vertexCount;n++){const r=a.getNormalVector(n),o=a.getTangentVector(n),i=t.Vector.cross(r,o);for(e=0;e<i.length;e++)a.bitangents.push(i[e])}}}return r},r}},2816:()=>{window.frag.Model=function(e,t,n){const r=window.frag;void 0===t&&(t=!n||!n.location||n.location.is3d);const o={name:null,parent:n,children:[],mesh:null,shader:null,material:null,enabled:!0},a={__private:o,location:r.Location(e,t),animations:[],dispose:function(){},addFlattenedChildren:function(e,t){for(let n=0;n<o.children.length;n++){let r=o.children[n];t(r)&&e.push(r),r.addFlattenedChildren(e,t)}},getPosition:function(){return r.ScenePosition(e,a.location)},name:function(e){return o.name=e,a},getName:function(){return o.name},shader:function(e){if(e.is3d!==a.location.is3d){const e=a.location.is3d?"3D":"2D";console.error("Model '"+o.name+"' has a "+e+" location and must use a "+e+" shader")}return o.shader=e,a},getShader:function(){return o.shader?o.shader:o.parent?o.parent.getShader():void 0},mesh:function(e){return o.mesh=e,a},getMesh:function(){return o.mesh},material:function(e){return o.material=e,a},enable:function(){o.enabled=!0},disable:function(){o.enabled=!1},getMaterial:function(){return o.material?o.material:o.parent?o.parent.getMaterial():void 0},addChild:function(t){return t?t.__private.parent=a:t=window.frag.Model(e,void 0,a),o.children.push(t),t},shadeSmooth:function(e){return void 0===e&&(e=-1),o.mesh&&o.mesh.shadeSmooth(),0===e||o.children.forEach((t=>{t.shadeSmooth(e-1)})),a},shadeFlat:function(e){return void 0===e&&(e=-1),o.mesh&&o.mesh.shadeFlat(),0===e||o.children.forEach((t=>{t.shadeFlat(e-1)})),a},textureSmooth:function(e){return void 0===e&&(e=-1),o.mesh&&o.mesh.textureSmooth(),0===e||o.children.forEach((t=>{t.textureSmooth(e-1)})),a},textureFlat:function(e){return void 0===e&&(e=-1),o.mesh&&o.mesh.textureFlat(),0===e||o.children.forEach((t=>{t.textureFlat(e-1)})),a},wireframe:function(e,t){return void 0===t&&(t=-1),o.mesh&&o.mesh.wireframe(e),0===t||o.children.forEach((n=>{n.wireframe(e,t-1)})),a},drawNormals:function(e,t,n){return void 0===n&&(n=-1),o.mesh&&o.mesh.drawNormals(e,t),0===n||o.children.forEach((r=>{r.drawNormals(e,t,n-1)})),a},addAnimation:function(e){const t=[];a.addFlattenedChildren(t,(function(e){return e.getName()}));const n=[],r=e.getChannelGraphs();for(let e=0;e<t.length;e++){const o=t[e],a=o.getName();for(let e=0;e<r.length;e++){const t=r[e];t.pattern.test(a)&&n.push({graph:t,model:o})}}return n.length>0&&a.animations.push({modelAnimation:e,childAnimations:n}),a},draw:function(t){if(!a.location)return a;t.beginModel(o.name,a.location);const i=t.shader||a.getShader();if(void 0!==i&&o.mesh&&o.enabled){if(i.bind(),t.isHitTest&&void 0!==i.uniforms.color){const n=t.sceneObjects.length-1,r=t.models.length;t.models.push(a);const o=n>>4,s=(15&n)<<4|(983040&r)>>16,c=(65280&r)>>8,u=255&r;e.gl.uniform4f(i.uniforms.color,o/255,s/255,c/255,u/255)}var s=a.getMaterial();s&&s.apply(i),void 0!==i.uniforms.clipMatrix&&r.Transform(e,t.state.modelToClipMatrix).apply(i.uniforms.clipMatrix),void 0!==i.uniforms.modelMatrix&&r.Transform(e,t.state.modelToWorldMatrix).apply(i.uniforms.modelMatrix),o.mesh.draw(i),i.unbind()}for(let e=0;e<o.children.length;e++)o.children[e].draw(t);const c=t.state.childMap,u=n?c&&o.name?c[o.name]:void 0:c?c["."]:void 0;if(u)for(let e=0;e<u.length;e++)u[e].draw(t);return t.endModel(),a}};return a}},5123:()=>{window.frag.PositionLink=function(e){const t={source:null,dest:null,locationOffset:null,scaleOffset:null,rotationOffset:null},n={__private:t,dispose:function(){t.source&&t.source.observableLocation.unsubscribe(t.sourceChanged)}};return t.sourceChanged=function(e){t.dest&&(t.locationOffset&&(void 0!==t.locationOffset[0]&&void 0!==t.locationOffset[1]&&void 0!==t.locationOffset[2]?t.dest.locationXYZ(e.translateX+t.locationOffset[0],e.translateY+t.locationOffset[1],e.translateZ+t.locationOffset[2]):(void 0!==t.locationOffset[0]&&t.dest.locationX(e.translateX+t.locationOffset[0]),void 0!==t.locationOffset[1]&&t.dest.locationY(e.translateY+t.locationOffset[1]),void 0!==t.locationOffset[2]&&t.dest.locationZ(e.translateZ+t.locationOffset[2]))),t.scaleOffset&&(void 0!==t.scaleOffset[0]&&void 0!==t.scaleOffset[1]&&void 0!==t.scaleOffset[2]?t.dest.scaleXYZ(e.scaleX+t.scaleOffset[0],e.scaleY+t.scaleOffset[1],e.scaleZ+t.scaleOffset[2]):(void 0!==t.scaleOffset[0]&&t.dest.scaleX(e.scaleX*t.scaleOffset[0]),void 0!==t.scaleOffset[1]&&t.dest.scaleY(e.scaleY*t.scaleOffset[1]),void 0!==t.scaleOffset[2]&&t.dest.scaleZ(e.scaleZ*t.scaleOffset[2]))),t.rotationOffset&&(void 0!==t.rotationOffset[0]&&void 0!==t.rotationOffset[1]&&void 0!==t.rotationOffset[2]?t.dest.rotateXYZ(e.rotateX+t.rotationOffset[0],e.rotateY+t.rotationOffset[1],e.rotateZ+t.rotationOffset[2]):(void 0!==t.rotationOffset[0]&&t.dest.rotateX(e.rotateX+t.rotationOffset[0]),void 0!==t.rotationOffset[1]&&t.dest.rotateY(e.rotateY+t.rotationOffset[1]),void 0!==t.rotationOffset[2]&&t.dest.rotateZ(e.rotateZ+t.rotationOffset[2]))))},n.source=function(e){return t.source&&t.source.observableLocation.unsubscribe(t.sourceChanged),e&&e.getPosition&&(e=e.getPosition()),t.source=e,e&&e.observableLocation.subscribe(t.sourceChanged),n},n.dest=function(e){return e&&e.getPosition&&(e=e.getPosition()),t.dest=e,n},n.locationOffset=function(e){return t.locationOffset=e,n},n.scaleOffset=function(e){return t.scaleOffset=e,n},n.rotationOffset=function(e){return t.rotationOffset=e,n},n}},5312:()=>{window.frag.Scene=function(e){const t={sceneObjects:[],camera:null},n={__private:t,dispose:function(){},addObject:function(e){return e.parent&&e.parent.removeObject(e),e.parent=n,t.sceneObjects.push(e),n},removeObject:function(e){for(let n=0;n<t.sceneObjects.length;n++)if(t.sceneObjects[n]===e)return t.sceneObjects.splice(n,1),e.parent=null,!0;return!1},camera:function(e){return t.camera=e,n},getCamera:function(){return t.camera},setViewport:function(){return t.camera&&t.camera.setViewport(),n},adjustToViewport:function(){return t.camera&&t.camera.adjustToViewport(),n},draw:function(e){if(!t.camera||!t.sceneObjects)return n;e.beginScene(t.camera);for(let n=0;n<t.sceneObjects.length;n++)t.sceneObjects[n].draw(e);return e.endScene(),n}};return n}},8390:()=>{window.frag.SceneObject=function(e,t){const n=window.frag,r={model:t,enabled:!0,location:null,animationLocation:null,position:null,animationPosition:null,animationMap:{},childMap:{}},o={__private:r,animations:{},parent:null};if(t)for(let n=0;n<t.animations.length;n++){const a=t.animations[n];for(let n=0;n<a.childAnimations.length;n++){const o=a.childAnimations[n].model.getName();if(!r.animationMap[o]){const n=window.frag.ObjectAnimationState(e);e.debugAnimations&&(n.__private.modelName=t.getName(),n.__private.childModelName=o),r.animationMap[o]=n}}const i=window.frag.SceneObjectAnimation(e,a,r.animationMap);o.animations[a.modelAnimation.getName()]=i}return o.addObject=function(e,t){return e.parent&&e.parent.removeObject(e),e.parent=o,t||(t="."),r.childMap[t]||(r.childMap[t]=[]),r.childMap[t].push(e),o},o.removeObject=function(e){for(let t in r.childMap){const n=r.childMap[t];for(let t=0;t<n.length;t++)if(n[t]===e)return n.splice(t,1),e.parent=null,!0}return!1},r.getLocation=function(){if(r.location)return r.location;if(r.model){if(!r.model.location)return null;r.location=n.Location(e,r.model.location.is3d)}else r.location=n.Location(e,!0);return r.location},r.getAnimationLocation=function(){if(r.animationLocation)return r.animationLocation;if(r.model){if(!r.model.location)return null;r.animationLocation=n.Location(e,r.model.location.is3d)}else r.animationLocation=n.Location(e,!0);return r.animationLocation},o.getPosition=function(){const t=r.getLocation();return t?(r.position||(r.position=n.ScenePosition(e,t)),r.position):null},o.getAnimationPosition=function(){const t=r.getAnimationLocation();return t?(r.animationPosition||(r.animationPosition=n.ScenePosition(e,t)),r.animationPosition):null},o.clearAnimationPosition=function(){return r.animationLocation=null,o},o.enable=function(){return r.enabled=!0,o},o.disable=function(){return r.enabled=!1,o},o.dispose=function(){o.disable(),r.parent&&r.parent.removeObject(sceneObject);for(let e in o.animations)o.animations[e].dispose();return o},o.draw=function(e){if(!r.enabled||!r.model)return o;let t=r.getLocation();return t?(r.animationLocation&&(t=t.clone().add(r.animationLocation)),e.beginSceneObject(t,r.animationMap,r.childMap),e.isHitTest&&e.sceneObjects.push(o),r.model.draw(e),e.endSceneObject(),o):o},o}},7266:()=>{window.frag.ScenePosition=function(e,t,n){const r={location:null},o={__private:r,observableLocation:window.frag.Observable(e,(e=>{e(r.location)})),dispose:function(){}};return r.modified=function(){r.location.isModified=!0,o.observableLocation.notify()},o.setLocation=function(t){return r.location=t||window.frag.Location(e,void 0===n||n),o},o.setLocation(t),o.getMatrix=function(){return r.location.getMatrix()},o.getScale=function(){return[r.location.scaleX,r.location.scaleY,r.location.scaleZ]},o.getScaleX=function(){return r.location.scaleX},o.getScaleY=function(){return r.location.scaleY},o.getScaleZ=function(){return r.location.scaleZ},o.scale=function(e){return r.location.scaleX=e,r.location.scaleY=e,r.location.scaleZ=e,r.modified(),o},o.scaleXYZ=function(e,t,n){return r.location.scaleX=e,r.location.scaleY=t,r.location.scaleZ=n,r.modified(),o},o.scaleX=function(e){return r.location.scaleX=e,r.modified(),o},o.scaleY=function(e){return r.location.scaleY=e,r.modified(),o},o.scaleZ=function(e){return r.location.scaleZ=e,r.modified(),o},o.scaleBy=function(e){return o.scaleXYZ(r.location.scaleX*e[0],r.location.scaleY*e[1],r.location.scaleZ*e[2])},o.scaleByXYZ=function(e,t,n){return o.scaleXYZ(r.location.scaleX*e,r.location.scaleY*t,r.location.scaleZ*n)},o.getRotate=function(){return[r.location.rotateX,r.location.rotateY,r.location.rotateZ]},o.getQuaternion=function(){return window.frag.Vector.quaternion(o.getRotate())},o.getRotateX=function(){return r.location.rotateX},o.getRotateY=function(){return r.location.rotateY},o.getRotateZ=function(){return r.location.rotateZ},o.getRotate=function(){return r.location.is3d?[r.location.rotateX,r.location.rotateY,r.location.rotateZ]:[r.location.rotateX,r.location.rotateY]},o.rotate=function(e){return 4===e.length&&(e=window.frag.Vector.euler(e)),r.location.rotateX=e[0],e.length>1&&(r.location.rotateY=e[1]),e.length>2&&(r.location.rotateZ=e[2]),r.modified(),o},o.rotateXYZ=function(e,t,n){return r.location.rotateX=e,r.location.rotateY=t,r.location.rotateZ=n,r.modified(),o},o.rotateX=function(e){return r.location.rotateX=e,r.modified(),o},o.rotateY=function(e){return r.location.rotateY=e,r.modified(),o},o.rotateZ=function(e){return r.location.rotateZ=e,r.modified(),o},o.rotateBy=function(e){return o.rotateXYZ(r.location.rotateX+e[0],r.location.rotateY+e[1],r.location.rotateZ+e[2])},o.rotateByXYZ=function(e,t,n){return o.rotateXYZ(r.location.rotateX+e,r.location.rotateY+t,r.location.rotateZ+n)},o.getLocationX=function(){return r.location.translateX},o.getLocationY=function(){return r.location.translateY},o.getLocationZ=function(){return r.location.translateZ},o.getLocation=function(){return r.location.is3d?[r.location.translateX,r.location.translateY,r.location.translateZ]:[r.location.translateX,r.location.translateY]},o.location=function(e){return r.location.translateX=e[0],e.length>1&&(r.location.translateY=e[1]),e.length>2&&(r.location.translateZ=e[2]),r.modified(),o},o.locationXYZ=function(e,t,n){return r.location.translateX=e,r.location.translateY=t,r.location.translateZ=n,r.modified(),o},o.locationX=function(e){return r.location.translateX=e,r.modified(),o},o.locationY=function(e){return r.location.translateY=e,r.modified(),o},o.locationZ=function(e){return r.location.translateZ=e,r.modified(),o},o.moveBy=function(e){return o.locationXYZ(r.location.translateX+e[0],r.location.translateY+e[1],r.location.translateZ+e[2])},o.moveByXYZ=function(e,t,n){return o.locationXYZ(r.location.translateX+e,r.location.translateY+t,r.location.translateZ+n)},o}},9288:()=>{window.frag.VertexData=function(e){const t=window.frag,n=e.gl,r={},o={__private:r,primitiveType:n.TRIANGLES,vertexCount:0,verticies:void 0,vertexDimensions:3,colors:void 0,colorDimensions:3,uvs:void 0,uvDimensions:2,normals:void 0,normalDimensions:3,tangents:void 0,bitangents:void 0,dispose:function(){},clone:function(){const n=t.VertexData(e);return n.primitiveType=o.primitiveType,n.vertexCount=o.vertexCount,n.vertexDimensions=o.vertexDimensions,n.colorDimensions=o.colorDimensions,n.uvDimensions=o.uvDimensions,n.normalDimensions=o.normalDimensions,n.verticies=o.verticies,o.colors&&(n.colors=Array.from(o.colors)),o.uvs&&(n.uvs=Array.from(o.uvs)),o.normals&&(n.normals=Array.from(o.normals)),o.tangents&&(n.tangents=Array.from(o.tangents)),o.bitangents&&(n.bitangents=Array.from(o.bitangents)),n},vertexIndex:function(e,t){return e*o.vertexDimensions+(t||0)},colorIndex:function(e,t){return e*o.colorDimensions+(t||0)},uvIndex:function(e,t){return e*o.uvDimensions+(t||0)},normalIndex:function(e,t){return e*o.normalDimensions+(t||0)},tangentIndex:function(e,t){return e*o.normalDimensions+(t||0)},bitangentIndex:function(e,t){return e*o.normalDimensions+(t||0)}};return r.getVector=function(e,n,r){return 2===r?t.Vector.extract2D(e,n):t.Vector.extract3D(e,n)},r.setVector=function(e,t,n){for(i=0;i<n.length;i++)e[t+i]=n[i]},o.getVertexVector=function(e){return r.getVector(o.verticies,o.vertexIndex(e),o.vertexDimensions)},o.setVertexVector=function(e,t){return r.setVector(o.verticies,o.vertexIndex(e),t)},o.getColor=function(e){return r.getVector(o.colors,o.colorIndex(e),o.colorDimensions)},o.setColor=function(e,t){return r.setVector(o.colors,o.colorIndex(e),t)},o.getUvVector=function(e){return r.getVector(o.uvs,o.uvIndex(e),o.uvDimensions)},o.setUvVector=function(e,t){return r.setVector(o.uvs,o.uvIndex(e),t)},o.getNormalVector=function(e){return r.getVector(o.normals,o.normalIndex(e),o.normalDimensions)},o.setNormalVector=function(e,t){return r.setVector(o.normals,o.normalIndex(e),t)},o.getTangentVector=function(e){return r.getVector(o.tangents,o.tangentIndex(e),o.normalDimensions)},o.setTangentVector=function(e,t){return r.setVector(o.tangents,o.tangentIndex(e),t)},o.getBitangentVector=function(e){return r.getVector(o.bitangents,o.bitangentIndex(e),o.normalDimensions)},o.setBitangentVector=function(e,t){return r.setVector(o.bitangents,o.bitangentIndex(e),t)},o.setTriangles2D=function(e,t,r,a,i,s){return o.primitiveType=n.TRIANGLES,o.vertexDimensions=2,o.verticies=e,o.vertexCount=e.length/o.vertexDimensions,o.colorDimensions=3,o.colors=t,o.uvDimensions=2,o.uvs=r,o.normalDimensions=3,o.normals=a,o.tangents=i,o.bitangents=s,o.extractTriangles=function(e){for(let t=0;t<o.vertexCount;t+=3)e(t,t+1,t+2)},o},o.setTriangles=function(e,t,r,a,i,s){return o.primitiveType=n.TRIANGLES,o.vertexDimensions=3,o.verticies=e,o.vertexCount=e.length/o.vertexDimensions,o.colorDimensions=3,o.colors=t,o.uvDimensions=2,o.uvs=r,o.normalDimensions=3,o.normals=a,o.tangents=i,o.bitangents=s,o.extractTriangles=function(e){for(let t=0;t<o.vertexCount;t+=3)e(t,t+1,t+2)},o},o.setTriangleStrip=function(e,t,r,a,i,s){return o.primitiveType=n.TRIANGLE_STRIP,o.vertexDimensions=3,o.verticies=e,o.vertexCount=e.length/o.vertexDimensions,o.colorDimensions=3,o.colors=t,o.uvDimensions=2,o.uvs=r,o.normalDimensions=3,o.normals=a,o.tangents=i,o.bitangents=s,o.extractTriangles=function(e){const t=o.vertexCount-2;for(let n=0;n<t;n++)0==(1&n)?e(n,n+1,n+2):e(n+2,n+1,n)},o},o.setTriangleFan=function(e,t,r,a,i,s){return o.primitiveType=n.TRIANGLE_FAN,o.vertexDimensions=3,o.verticies=e,o.vertexCount=e.length/o.vertexDimensions,o.colorDimensions=3,o.colors=t,o.uvDimensions=2,o.uvs=r,o.normalDimensions=3,o.normals=a,o.tangents=i,o.bitangents=s,o.extractTriangles=function(e){const t=o.vertexCount-2;for(let n=0;n<t;n++)e(0,n+1,n+2)},o},o.setLines2D=function(e,t,r,a){return o.primitiveType=n.LINES,o.vertexDimensions=2,o.verticies=e,o.vertexCount=e.length/o.vertexDimensions,o.colorDimensions=3,o.colors=t,o.uvDimensions=2,o.uvs=r,o.normalDimensions=3,o.normals=a,o.tangents=null,o.bitangents=null,o.extractTriangles=function(){},o},o.setLines=function(e,t,r,a){return o.primitiveType=n.LINES,o.vertexDimensions=3,o.verticies=e,o.vertexCount=e.length/o.vertexDimensions,o.colorDimensions=3,o.colors=t,o.uvDimensions=2,o.uvs=r,o.normalDimensions=3,o.normals=a,o.tangents=null,o.bitangents=null,o.extractTriangles=function(){},o},o.setLineStrip=function(e,t,r,a){return o.primitiveType=n.LINE_STRIP,o.vertexDimensions=3,o.verticies=e,o.vertexCount=e.length/o.vertexDimensions,o.colorDimensions=3,o.colors=t,o.uvDimensions=2,o.uvs=r,o.normalDimensions=3,o.normals=a,o.tangents=null,o.bitangents=null,o.extractTriangles=function(){},o},o}},3798:()=>{window.frag.createShader=function(e,t,n,r){const o=e.gl;e.debugShaderBuilder&&console.log("\n// "+t+" "+(n===o.VERTEX_SHADER?"vertex":"fragment")+" shader\n"+r);var a=o.createShader(n);if(o.shaderSource(a,r),o.compileShader(a),o.getShaderParameter(a,o.COMPILE_STATUS))return a;console.error("Failed to compile shader "+t),console.log(o.getShaderInfoLog(a)),o.deleteShader(a)},window.frag.createProgram=function(e,t,n,r){const o=e.gl;var a=o.createProgram();if(o.attachShader(a,n),o.attachShader(a,r),o.linkProgram(a),o.getProgramParameter(a,o.LINK_STATUS))return a;console.error("Failed to link shaders into program "+t),console.log(o.getProgramInfoLog(a)),o.deleteProgram(a)},window.frag.CustomShader=function(e,t){const n=window.frag,r=e.gl,o={name:"Custom",vertexShaderSource:null,fragmentShaderSource:null,bindList:[],unbindList:[]},a={__private:o,attributes:{},uniforms:{},is3d:void 0===t||t,dispose:function(){r.deleteProgram(a.program)},name:function(e){return o.name=e,a},getName:function(){return o.name},source:function(t,i){o.vertexShaderSource=t,o.fragmentShaderSource=i;const s=n.createShader(e,o.name,r.VERTEX_SHADER,t),c=n.createShader(e,o.name,r.FRAGMENT_SHADER,i);return a.program=n.createProgram(e,o.name,s,c),a},onBind:function(e){return o.bindList.push(e),a},onUnbind:function(e){return o.unbindList.push(e),a},attribute:function(e){if(!a.program)return console.error("You must set the "+o.name+" shader source before defining attributes"),a;const t=r.getAttribLocation(a.program,"a_"+e);return void 0===t?(console.error("Shader program "+o.name+" does not have attribute a_"+e),a):(a.attributes[e]=t,a)},uniform:function(e,t,n){if(!a.program)return console.error("You must set the "+o.name+" shader source before defining uniforms"),a;const i=r.getUniformLocation(a.program,"u_"+e);return i?(a.uniforms[e]=i,t&&(o[e]=n,a[e]=function(t){return o[e]=t,a},o.bindList.push((function(n){void 0!==o[e]&&n["uniform"+t](i,o[e])}))),a):(console.error("Shader program "+o.name+" does not have uniform u_"+e),a)},bind:function(){const t=e.gl;return t.useProgram(a.program),o.bindList.forEach((e=>e(t))),a},unbind:function(){const t=e.gl;return o.unbindList.forEach((e=>e(t))),a}};return a}},7218:()=>{window.frag.FontShader=function(e){return e.fontShader||(e.fontShader=frag.CustomShader(e).name("Font").source("attribute vec4 a_position;\nattribute vec2 a_texcoord;\nuniform mat4 u_clipMatrix;\nvarying vec2 v_texcoord;\nvoid main() {\n  gl_Position = u_clipMatrix * a_position;\n  v_texcoord = a_texcoord;\n}","precision mediump float;\nuniform sampler2D u_diffuse;\nuniform vec4 u_fgcolor;\nuniform vec4 u_bgcolor;\nvarying vec2 v_texcoord;\nvoid main() {\n  vec4 texture = texture2D(u_diffuse, vec2(v_texcoord.x, 1.0 - v_texcoord.y));\n  gl_FragColor = mix(u_bgcolor, u_fgcolor, length(texture.rgb));\n}\n").attribute("position").attribute("texcoord").uniform("clipMatrix").uniform("bgcolor","4fv",[1,1,1,1]).uniform("fgcolor","4fv",[0,0,0,1]).uniform("diffuse")),e.fontShader}},2198:()=>{window.frag.Shader=function(e){const t=window.frag,n=(e.gl,"None"),r={name:"Custom",verticies:"XYZ",x:0,y:0,z:0,colors:n,matrix:"mat4",textureCoords:n,diffuseTexture:n,emmissiveTexture:n,displacementTexture:n,normalMap:n,roughnessTexture:n,shininessTexture:n,metalinessTexture:n,normals:n,tangents:n,bitangents:n,directionalLight:n,ambientLight:n},o={__private:r,name:function(e){return r.name=e,o},verticiesXY:function(e){return r.verticies="XY",r.z=e,o},verticiesXZ:function(e){return r.verticies="XZ",r.y=e,o},verticiesYZ:function(e){return r.verticies="YZ",r.x=e,o},verticiesXYZ:function(){return r.verticies="XYZ",o},verticiesNone:function(){return r.verticies=n,o},matrix2D:function(){return r.matrix="mat3",o},matrix3D:function(){return r.matrix="mat4",o},matrixNone:function(){return r.matrix=n,o},normals:function(){return r.normals="vec3",o},colorsRGB:function(){return r.colors="vec3",o},colorsRGBA:function(){return r.colors="vec4",o},colorsNone:function(){return r.colors=n,o},diffuseTexture:function(){return r.diffuseTexture="RGB",r.colors=n,r.textureCoords===n&&(r.textureCoords="vec2"),o},emmissiveTexture:function(){return r.emmissiveTexture="RGB",r.textureCoords===n&&(r.textureCoords="vec2"),o},normalMapStandard:function(){return r.normalMap="Standard",r.textureCoords===n&&(r.textureCoords="vec2"),r.normals===n&&(r.normals="vec3"),r.tangents===n&&(r.tangents="vec3"),o},normalMapOpenGL:function(){return r.normalMap="OpenGL",r.textureCoords===n&&(r.textureCoords="vec2"),r.normals===n&&(r.normals="vec3"),r.tangents===n&&(r.tangents="vec3"),o},displacementTextureRaised:function(){return r.displacementTexture="Raised",r.textureCoords===n&&(r.textureCoords="vec2"),r.normals===n&&(r.normals="vec3"),o},displacementTextureSunken:function(){return r.displacementTexture="Sunken",r.textureCoords===n&&(r.textureCoords="vec2"),r.normals===n&&(r.normals="vec3"),o},displacementTextureSigned:function(){return r.displacementTexture="Signed",r.textureCoords===n&&(r.textureCoords="vec2"),r.normals===n&&(r.normals="vec3"),o},tangents:function(){return r.tangents="vec3",r.normals===n&&(r.normals="vec3"),o},bitangents:function(){return r.bitangents="vec3",r.normals===n&&(r.normals="vec3"),o},directionalLightColor:function(){return o.matrix3D(),r.directionalLight="Color",r.ambientLight===n&&(r.ambientLight="Balanced"),r.normals===n&&(r.normals="vec3"),o},directionalLightWhite:function(){return o.matrix3D(),r.directionalLight="White",r.ambientLight===n&&(r.ambientLight=n),r.normals===n&&(r.normals="vec3"),o},directionalLightGrey:function(){return o.matrix3D(),r.directionalLight="Grey",r.ambientLight===n&&(r.ambientLight="Balanced"),r.normals===n&&(r.normals="vec3"),o},directionalLightNone:function(){return r.directionalLight=n,o},ambientLightBalanced:function(){return r.ambientLight="Balanced",o},ambientLightNone:function(){return r.ambientLight=n,o},ambientLightFixed:function(){return r.ambientLight="Fixed",o},ambientTexture:function(){return r.ambientLight="Texture",o}};return r.addAttributeDeclarations=function(e){"XYZ"===r.verticies?e.vectorShader+="attribute vec4 a_position;\n":r.verticies!==n&&(e.vectorShader+="attribute vec2 a_position;\n"),r.colors!==n&&(e.vectorShader+="attribute "+r.colors+" a_color;\n"),r.textureCoords!==n&&(e.vectorShader+="attribute "+r.textureCoords+" a_texcoord;\n"),r.normals!==n&&(e.vectorShader+="attribute "+r.normals+" a_normal;\n"),r.tangents!==n&&(e.vectorShader+="attribute "+r.tangents+" a_tangent;\n"),r.bitangents!==n&&(e.vectorShader+="attribute "+r.bitangents+" a_bitangent;\n")},r.addUniformDeclarations=function(e){r.matrix!==n&&(r.directionalLight!==n&&(e.vectorShader+="uniform "+r.matrix+" u_modelMatrix;\n"),e.vectorShader+="uniform "+r.matrix+" u_clipMatrix;\n"),r.directionalLight!==n&&(e.vectorShader+="uniform vec3 u_lightDirection;\n"),"Color"===r.directionalLight&&(e.vectorShader+="uniform vec3 u_lightColor;\n"),r.displacementTexture!==n&&(e.vectorShader+="uniform sampler2D u_height;\n",e.vectorShader+="uniform float u_displacementScale;\n"),r.roughnessTexture!==n&&(e.vectorShader+="uniform sampler2D u_roughness;\n"),r.shininessTexture!==n&&(e.vectorShader+="uniform sampler2D u_glossiness;\n"),"Texture"===r.ambientLight&&(e.vectorShader+="uniform sampler2D u_ambient;\n"),r.normalMap!==n&&(e.fragmentShader+="uniform sampler2D u_normal;\n"),r.textureCoords!==n&&(r.diffuseTexture!==n&&(e.fragmentShader+="uniform sampler2D u_diffuse;\n"),r.emmissiveTexture!==n&&(e.fragmentShader+="uniform sampler2D u_emmissive;\n")),r.ambientLight!==n&&(e.fragmentShader+="uniform float u_ambientLight;\n")},r.addVaryingDeclarations=function(e){const t=function(t,n){const r="varying "+t+" "+n+";\n";e.vectorShader+=r,e.fragmentShader+=r};r.textureCoords!==n&&t(r.textureCoords,"v_texcoord"),r.colors!==n&&t(r.colors,"v_color"),r.directionalLight!==n&&(t("vec3","v_lightDirection"),"Color"===r.directionalLight&&t("vec3","v_lightColor"),r.normalMap===n&&t(r.normals,"v_normal"))},r.addLogic=function(e){"XYZ"===r.verticies?e.vectorShader+="  vec4 position = a_position;\n":r.verticies!==n&&(e.vectorShader+="  vec2 position = a_position;\n"),r.roughnessTexture!==n&&(e.vectorShader+="  vec4 roughness = texture2D(u_roughness, vec2(a_texcoord.x, 1.0 - a_texcoord.y));\n"),r.shininessTexture!=n&&(e.vectorShader+="  vec4 glossiness = texture2D(u_glossiness, vec2(a_texcoord.x, 1.0 - a_texcoord.y));\n"),r.displacementTexture!==n&&(e.vectorShader+="  vec4 height = texture2D(u_height, vec2(a_texcoord.x, 1.0 - a_texcoord.y));\n","XYZ"===r.verticies&&"vec3"===r.normals&&("Sunken"===r.displacementTexture?e.vectorShader+="  float displacement = -height.r;\n":"Signed"===r.displacementTexture?e.vectorShader+="  float displacement = height.r * 2.0 - 1.0;\n":"Raised"===r.displacementTexture&&(e.vectorShader+="  float displacement = height.r;\n"),e.vectorShader+="  position = vec4(position.xyz + (a_normal * displacement * u_displacementScale), position.w);\n")),"XYZ"===r.verticies?e.vectorShader+="  position = u_clipMatrix * position;\n":r.verticies!==n&&(e.vectorShader+="  position = (u_clipMatrix * vec3(position, 1)).xy;\n"),"XYZ"===r.verticies?e.vectorShader+="  gl_Position = position;\n":"XY"===r.verticies?e.vectorShader+="  gl_Position = vec4(position, "+r.z+", 1);\n":"XZ"===r.verticies?e.vectorShader+="  gl_Position = vec4(position.x, "+r.y+", position.y, 1);\n":"YZ"===r.verticies&&(e.vectorShader+="  gl_Position = vec4("+r.x+", position, 1);\n"),r.textureCoords!==n&&(e.vectorShader+="  v_texcoord = a_texcoord;\n"),r.directionalLight!==n?(r.normalMap!==n?(e.vectorShader+="  vec3 T = normalize(vec3(u_modelMatrix * vec4(a_tangent, 0.0)));\n",r.bitangents!==n?e.vectorShader+="  vec3 B = normalize(vec3(u_modelMatrix * vec4(a_bitangent, 0.0)));\n":e.vectorShader+="  vec3 B = normalize(vec3(u_modelMatrix * vec4(cross(a_normal, a_tangent), 0.0)));\n",e.vectorShader+="  vec3 N = normalize(vec3(u_modelMatrix * vec4(a_normal, 0.0)));\n",e.vectorShader+="  mat3 TBN = transpose(mat3(T, B, N));\n",e.vectorShader+="  v_lightDirection = TBN * u_lightDirection;\n",e.fragmentShader+="  vec3 normal = texture2D(u_normal, vec2(v_texcoord.x, 1.0 - v_texcoord.y)).rgb * 2.0 - 1.0;\n"):(e.vectorShader+="  v_normal = (u_modelMatrix * vec4(a_normal, 0)).xyz;\n",e.vectorShader+="  v_lightDirection = u_lightDirection;\n",e.fragmentShader+="  vec3 normal = normalize(v_normal);\n"),e.fragmentShader+="  vec3 lightDirection = v_lightDirection;\n",e.fragmentShader+="  float light = max(dot(normal, lightDirection), 0.0);\n",r.ambientLight!==n&&(e.fragmentShader+="  light += u_ambientLight;\n")):r.ambientLight!==n&&(e.fragmentShader+="  float light = u_ambientLight;\n"),"Color"===r.directionalLight&&(e.vectorShader+="  v_lightColor = u_lightColor;\n"),r.colors===n?e.fragmentShader+="  gl_FragColor = vec4(0, 0, 0, 1.0);\n":"vec4"===r.colors?(e.vectorShader+="  v_color = a_color;\n",e.fragmentShader+="  gl_FragColor = v_color;\n"):(e.vectorShader+="  v_color = a_color;\n",e.fragmentShader+="  gl_FragColor = vec4(v_color, 1.0);\n"),"vec2"===r.textureCoords&&"RGB"===r.diffuseTexture&&(e.fragmentShader+="  gl_FragColor += texture2D(u_diffuse, vec2(v_texcoord.x, 1.0 - v_texcoord.y));\n"),r.ambientLight===n&&r.directionalLight===n||(e.fragmentShader+="  gl_FragColor.rgb *= light;\n"),"vec2"===r.textureCoords&&"RGB"===r.emmissiveTexture&&(e.fragmentShader+="  gl_FragColor.rgb += texture2D(u_emmissive, vec2(v_texcoord.x, 1.0 - v_texcoord.y)).rgb;\n")},o.compile=function(){const o=t.CustomShader(e,"mat4"===r.matrix).name(r.name),a={vectorShader:"",fragmentShader:"precision mediump float;\n"};if(r.addAttributeDeclarations(a),r.addUniformDeclarations(a),r.addVaryingDeclarations(a),r.directionalLight!==n&&r.normalMap!==n&&(a.vectorShader+="highp mat3 transpose(in highp mat3 inMatrix) {\n",a.vectorShader+="    highp vec3 i0 = inMatrix[0];\n",a.vectorShader+="    highp vec3 i1 = inMatrix[1];\n",a.vectorShader+="    highp vec3 i2 = inMatrix[2];\n",a.vectorShader+="    highp mat3 outMatrix = mat3(\n",a.vectorShader+="        vec3(i0.x, i1.x, i2.x),\n",a.vectorShader+="        vec3(i0.y, i1.y, i2.y),\n",a.vectorShader+="        vec3(i0.z, i1.z, i2.z)\n",a.vectorShader+="    );\n",a.vectorShader+="    return outMatrix;\n",a.vectorShader+="}\n"),a.vectorShader+="void main() {\n",a.fragmentShader+="void main() {\n",r.addLogic(a),a.vectorShader+="}\n",a.fragmentShader+="}\n",o.source(a.vectorShader,a.fragmentShader),r.verticies!==n&&o.attribute("position"),r.colors!==n&&o.attribute("color"),r.textureCoords!==n&&o.attribute("texcoord"),r.normals!==n&&o.attribute("normal"),r.tangents!==n&&o.attribute("tangent"),r.bitangents!==n&&o.attribute("bitangent"),r.diffuseTexture!==n&&o.uniform("diffuse"),r.emmissiveTexture!==n&&o.uniform("emmissive"),r.normalMap!==n&&o.uniform("normal"),r.roughnessTexture!==n&&o.uniform("roughness"),r.shininessTexture!=n&&o.uniform("glossiness"),r.ambientLight!==n&&("Texture"===r.ambientLight?o.uniform("ambient"):o.uniform("ambientLight","1f",.5)),r.displacementTexture!==n&&(o.uniform("height"),o.uniform("displacementScale","1f",.2)),r.matrix!==n&&(r.directionalLight!==n&&o.uniform("modelMatrix"),o.uniform("clipMatrix")),r.directionalLight!==n){o.uniform("lightDirection","3fv"),"Color"===r.directionalLight&&o.uniform("lightColor","3fv");const e="Balanced"===r.ambientLight&&o.ambientLight,n=o.lightDirection;o.lightDirection=function(r){const a=t.Vector.length(r);return a>1?(n([-r[0]/a,-r[1]/a,-r[2]/a]),e&&o.ambientLight(0)):(n([-r[0],-r[1],-r[2]]),e&&o.ambientLight(1-a)),o},"White"===r.directionalLight?o.lightDirection([.8,-.2,.8]):"Grey"===r.directionalLight&&o.lightDirection([.5,-.1,.5])}return o},o}},3743:()=>{window.frag.UiShader=function(e){return e.uiShader||(e.uiShader=window.frag.Shader(e).name("UI").verticiesXY(-1).matrix2D().diffuseTexture().compile()),e.uiShader}},9914:()=>{window.frag.Cube=function(e,t,n){void 0===(n=n||{}).drawFront&&(n.drawFront=!0),void 0===n.drawBack&&(n.drawBack=!0),void 0===n.drawTop&&(n.drawTop=!0),void 0===n.drawBottom&&(n.drawBottom=!0),void 0===n.drawLeft&&(n.drawLeft=!0),void 0===n.drawRight&&(n.drawRight=!0);let r=1/4,o=.5,a=1/3,i=2/3;const s=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[1,-1,1],[-1,-1,1],[-1,1,1],[1,1,1]],c=[],u=[],l=n.color?[]:void 0,d=function(e){c.push(e[0]),c.push(e[1]),c.push(e[2]),n.color&&n.color.forEach((e=>{l.push(e)}))},f=function(e,t){u.push(e),u.push(t)},m=function(e,t,n,r){d(e),d(t),d(n),d(r),d(n),d(t)},g=function(e,t,n,r){f(n,t),f(n,r),f(e,t),f(e,r),f(e,t),f(n,r)},h=function(e,n,r,o,a,i,c){for(var u=0;u<t;u++){const l=u/t,d=(u+1)/t,f=(c-a)*l+a,h=(c-a)*d+a;for(hFacet=0;hFacet<t;hFacet++){const a=hFacet/t,c=(hFacet+1)/t,u=window.frag.Vector,v=u.sub(s[r],s[n]),p=u.sub(s[e],s[n]),x=u.add(u.add(s[n],u.mult(p,a)),u.mult(v,l)),T=u.add(u.add(s[n],u.mult(p,c)),u.mult(v,l)),b=u.add(u.add(s[n],u.mult(p,a)),u.mult(v,d)),w=u.add(u.add(s[n],u.mult(p,c)),u.mult(v,d));m(T,w,x,b),g((i-o)*a+o,f,(i-o)*c+o,h)}}};return n.duplicateTexture?(n.drawFront&&h(1,0,3,1,1,0,0),n.drawBottom&&h(4,5,0,1,1,0,0),n.drawLeft&&h(0,5,6,1,1,0,0),n.drawRight&&h(4,1,2,1,1,0,0),n.drawBack&&h(5,4,7,1,1,0,0),n.drawTop&&h(6,7,2,1,1,0,0)):(n.drawFront&&h(1,0,3,r,i,0,a),n.drawBottom&&h(4,5,0,o,i,r,a),n.drawLeft&&h(0,5,6,o,i,r,1),n.drawRight&&h(4,1,2,r,a,o,0),n.drawBack&&h(5,4,7,o,a,.75,i),n.drawTop&&h(6,7,2,.75,a,1,i)),window.frag.Mesh(e).addTriangles(c,l,u)}},6499:()=>{window.frag.Cylinder=function(e,t,n){t=t||32;const r=[0,0,-1],o=[.5,.5],a=[0,0,-1],i=(n=n||{}).color?Array.from(n.color):void 0,s=[0,0,1],c=[.5,.5],u=[0,0,1],l=n.color?Array.from(n.color):void 0,d=[],f=n.color?[]:void 0,m=[],g=[],h=2*Math.PI/t;for(var v=0;v<=t;v++){const e=-v*h,t=Math.sin(e),s=Math.cos(e);r.push(t),r.push(s),r.push(-1),n.color&&n.color.forEach((e=>i.push(e))),o.push(.5*(t+1)),o.push(.5*(s+1)),a.push(t),a.push(s),a.push(-1),d.push(t),d.push(s),d.push(-1),d.push(t),d.push(s),d.push(1),n.color&&(n.color.forEach((e=>f.push(e))),n.color.forEach((e=>f.push(e)))),m.push(.5*(t+1)),m.push(.5*(s+1)),m.push(.5*(t+1)),m.push(.5*(s+1)),g.push(t),g.push(s),g.push(0),g.push(t),g.push(s),g.push(0)}for(v=0;v<=t;v++){const e=v*h,t=Math.sin(e),r=Math.cos(e);s.push(t),s.push(r),s.push(1),n.color&&n.color.forEach((e=>l.push(e))),c.push(.5*(t+1)),c.push(.5*(r+1)),u.push(t),u.push(r),u.push(1)}return d.push(0),d.push(1),d.push(1),n.color&&n.color.forEach((e=>f.push(e))),m.push(.5),m.push(1),g.push(0),g.push(1),g.push(0),window.frag.Mesh(e).addTriangleFan(r,i,o,a).addTriangleFan(s,l,c,u).addTriangleStrip(d,f,m,g)}},9022:()=>{window.frag.Disc=function(e,t,n){t=t||32,n=n||{};const r=[0,0,0],o=[.5,.5],a=[0,0,-1],i=2*Math.PI/t;for(var s=0;s<=t;s++){const e=-s*i,t=Math.sin(e),n=Math.cos(e);r.push(t),r.push(n),r.push(0),a.push(0),a.push(0),a.push(-1),o.push(.5*(t+1)),o.push(.5*(n+1))}return window.frag.Mesh(e).addTriangleFan(r,o,a)}},1950:()=>{window.frag.Plane=function(e,t,n){if(n=n||{},1===(t=t||1)){const t=n.color||[0,0,0],r=new Float32Array([1,-1,0,1,1,0,-1,-1,0,-1,1,0,t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],1,0,1,1,0,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0]);return window.frag.Mesh(e).fromBuffer(r.buffer,3,4,e.gl.TRIANGLE_STRIP,0*Float32Array.BYTES_PER_ELEMENT,12*Float32Array.BYTES_PER_ELEMENT,24*Float32Array.BYTES_PER_ELEMENT,32*Float32Array.BYTES_PER_ELEMENT,44*Float32Array.BYTES_PER_ELEMENT,56*Float32Array.BYTES_PER_ELEMENT)}const r=[],o=[],a=[],i=n.color?[]:void 0,s=function(e,t){r.push(2*e-1),r.push(2*t-1),r.push(0),n.color&&n.color.forEach((e=>i.push(e))),o.push(e),o.push(t),a.push(0),a.push(0),a.push(-1)};for(let e=0;e<t;e++){const n=e/t,r=(e+1)/t;for(let e=0;e<t;e++){const o=e/t,a=(e+1)/t;s(o,n),s(a,n),s(a,r),s(o,n),s(a,r),s(o,r)}}return window.frag.Mesh(e).addTriangles(r,i,o,a)}},3614:()=>{window.frag.Sphere=function(e,t,n){void 0===t&&(t=12),t<2&&(t=2),void 0===(n=n||{}).startLatitude&&(n.latitudeStart=0),void 0===n.endLatitude&&(n.latitudeLength=Math.PI),void 0===n.startLongitude&&(n.longitudeStart=0),void 0===n.endLongitude&&(n.longitudeLength=2*Math.PI),void 0===n.longitudeFacets&&(n.longitudeFacets=t),n.longitudeFacets<3&&(n.longitudeFacets=3);const r=[],o=[];for(let e=0;e<=t;e++){const a=e/t;let i=0;for(0===e&&0===n.latitudeStart?i=.5/n.longitudeFacets:e===t&&n.latitudeStart+n.latitudeLength===Math.PI&&(i=-.5/n.longitudeFacets),ix=0;ix<=n.longitudeFacets;ix++){const e=ix/n.longitudeFacets;vertex={x:Math.cos(n.longitudeStart+e*n.longitudeLength)*Math.sin(n.latitudeStart+a*n.latitudeLength),y:Math.cos(n.latitudeStart+a*n.latitudeLength),z:Math.sin(n.longitudeStart+e*n.longitudeLength)*Math.sin(n.latitudeStart+a*n.latitudeLength)},r.push(vertex),o.push({u:e,v:a})}}const a=[],i=n.color?[]:void 0,s=[],c=function(e){const t=r[e];a.push(t.x),a.push(t.y),a.push(t.z);const c=o[e];s.push(c.u),s.push(c.v),n.color&&n.color.forEach((e=>{i.push(e)}))},u=function(e,t,n){c(e),c(t),c(n)};for(let e=0;e<t;e++){const r=e*(t+1),o=(e+1)*(t+1);for(let a=0;a<n.longitudeFacets;a++)(0!==e||n.latitudeStart>0)&&u(r+a+1,r+a,o+a+1),(e!==t-1||n.latitudeStart+n.latitudeLength<Math.PI)&&u(r+a,o+a,o+a+1)}return window.frag.Mesh(e).addTriangles(a,i,s)}}},n={};function r(e){var o=n[e];if(void 0!==o)return o.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r(6601),r(8197),r(7996),r(9607),r(1346),r(9670),r(7008),r(1821),r(3163),r(3798),r(2198),r(3743),r(7218),r(8394),r(2636),r(4655),r(9288),r(9521),r(1003),r(2816),r(7266),r(8390),r(5312),r(3533),r(5123),r(6611),r(3270),r(3014),r(3906),r(2588),r(6627),r(9023),r(5363),r(3890),r(9889),r(4600),r(9622),r(666),r(2201),r(9914),r(6499),r(9022),r(1950),r(3614),r(6237),r(956),r(7802),r(3235),r(6784),r(8562),r(280),r(8853),r(5217)})();
//# sourceMappingURL=frag.min.js.map