(()=>{var t={627:()=>{window.frag.Animation=function(t,e){const r={stopAfter:0},n=t||{};n.__private=r;const a=100;return n.setDuration=function(t){return n.duration=t,n},n.setInterval=function(t){return n.interval=t,n},n.action=function(t,e,o){if(void 0!==r.stopAfter&&(r.stopAt=e+r.stopAfter,delete r.stopAfter),void 0!==r.stopAt&&e>=r.stopAt)r.disposeOnStop&&n.dispose();else{if(r.sequence){let t=r.sequence[r.sequenceIndex];r.nextStepTick?e>=r.nextStepTick&&(t.stop&&t.stop(n,e),r.sequenceIndex++,r.sequenceIndex===r.sequence.length?r.autoRestart?(r.sequenceIndex=0,t=r.sequence[r.sequenceIndex],t.start&&t.start(n,e),r.nextStepTick=e+(t.duration||a)):r.stopAt=e:(t=r.sequence[r.sequenceIndex],t.start&&t.start(n,e),n.interval=t.interval,r.nextStepTick=e+(t.duration||a))):(r.nextStepTick=e+(t.duration||a),t.start&&t.start(n,e)),r.action=t.action,n.nextGameTick=e+(t.interval||5)}else void 0!==r.frameRepeat?n.nextFrameTick=o+r.frameRepeat:void 0!==r.tickRepeat&&(n.nextGameTick=e+r.tickRepeat);r.action&&r.action(n,e,o)}},n.sequence=function(t,e){return Array.isArray(t)?r.sequence=t:r.sequence=[t],r.sequenceIndex=0,r.autoRestart=e,n.duration=0,r.sequence.forEach((t=>{t.duration?n.duration+=t.duraton:n.duration+=a})),n},n.perform=function(t,e){return n.sequence(t,e)},n.start=function(){return delete r.nextStepTick,delete r.stopAfter,delete r.stopAt,n},n.stop=function(){return r.stopAfter=0,n},n.repeatTicks=function(t,e){return delete r.autoRestart,delete r.frameRepeat,delete r.sequence,r.tickRepeat=e||t.interval||20,r.action=t,n},n.repeatFrames=function(t,e){return delete r.autoRestart,delete r.tickRepeat,delete r.sequence,r.frameRepeat=e||1,r.action=t,n},n.stopAfter=function(t){return r.stopAfter=t,delete r.stopAt,n},n.disposeOnStop=function(t){r.disposeOnStop=t},e||window.frag.addAnimation(n),n.dispose=function(){window.frag.removeAnimation(n)},n}},600:()=>{window.frag.KeyframeAnimationAction=function(){const t={startTick:void 0,currentFrame:void 0,keyframes:{}},e={__private:t,interval:10,frames:100,start:function(r,n){return t.startTick=n,t.currentFrame=-1,e},action:function(r,n){let a=Math.floor((n-t.startTick)/e.interval);for(;t.currentFrame<a;){t.currentFrame++;const e=t.keyframes[t.currentFrame];if(e)for(let r=0;r<e.length;r++)e[r].action(t.currentFrame,e[r].data,n)}return e},setFrames:function(t,r){return e.interval=t,e.frames=r||e.frames,e.duration=e.interval*e.frames,e},add:function(r,n,a){let o=t.keyframes[r];return o||(o=[],t.keyframes[r]=o),o.push({action:n,data:a}),e}};return e}},363:()=>{window.frag.ModelAnimation=function(){const t={loop:!1,interval:10,frames:50,channelGraphs:[],name:""},e={__private:t,getChannelGraphs:function(){return t.channelGraphs},name:function(r){return t.name=r,e},getName:function(){return t.name},loop:function(r){return t.loop=r,e},getLoop:function(){return t.loop},interval:function(r){return t.interval=r,e},getInterval:function(){return t.interval},frames:function(r){return t.frames=r,e},getFrames:function(){return t.frames}},r=function(e){const r=[];let n;r.length=t.frames;let a=0;for(let o=0;o<t.frames;o++){const t=e[o];if(void 0!==t){if(n=t.value,"linear"===t.transition){const t=r[a],e=(n-t)/(o-a);for(let n=a+1;n<o;n++)r[n]=t+(n-a)*e}a=o}r[o]=n}return r};return e.addChannel=function(e){t.channelGraphs.push({pattern:e.pattern,channel:e.channel,frameValues:r(e.keyframes)})},e}},23:()=>{window.frag.ObjectAnimationState=function(){const t={is3d:!0,matrix:null,translateX:0,translateY:0,translateZ:0,scaleX:1,scaleY:1,scaleZ:1,rotateX:0,rotateY:0,rotateZ:0};return{__private:t,getMatrix:function(){if(!t.matrix){let e;e=t.is3d?window.frag.Transform().translateXYZ(t.translateX,t.translateY,t.translateZ).rotateXYZ(t.rotateX,t.rotateY,t.rotateZ).scaleXYZ(t.scaleX,t.scaleY,t.scaleZ):window.frag.Transform2D().translateXY(t.translateX,t.translateY).rotate(t.rotateZ).scaleXY(t.scaleX,t.scaleY),t.matrix=e.getMatrix()}return t.matrix},getUpdateFunction:function(e){switch(e){case"translate-x":return t.is3d?function(e){t.translateX=e,t.matrix&&(t.matrix[12]=e)}:function(e){t.translateX=e,t.matrix&&(t.matrix[6]=e)};case"translate-y":return t.is3d?function(e){t.translateY=e,t.matrix&&(t.matrix[13]=e)}:function(e){t.translateY=e,t.matrix&&(t.matrix[7]=e)};case"translate-z":if(t.is3d)return function(e){t.translateZ=e,t.matrix&&(t.matrix[14]=e)};case"scale-x":return function(e){t.scaleX=e,t.matrix=null};case"scale-y":return function(e){t.scaleY=e,t.matrix=null};case"scale-z":if(t.is3d)return function(e){t.scaleZ=e,t.matrix=null};case"rotate-x":if(t.is3d)return function(e){t.rotateX=e,t.matrix=null};case"rotate-y":if(t.is3d)return function(e){t.rotateY=e,t.matrix=null};case"rotate-z":return function(e){t.rotateZ=e,t.matrix=null}}return console.warn("Unsupported animation channel "+e),function(){}}}}},622:()=>{window.frag.ParallelAnimationAction=function([t]){const e={actions:t},r={__private:e,duration:30,interval:5,setDuration:function(t){return r.duration=t,r},setInterval:function(t){return r.interval=t,r},start:function(t,n){return e.actions.forEach((e=>{e.start&&e.start(t,n)})),r},action:function(t,n){return e.actions.forEach((e=>{e.action&&e.action(t,n)})),r},stop:function(t,r){e.actions.forEach((e=>{e.stop&&e.stop(t,r)}))}};return r}},201:()=>{window.frag.PositionAnimationAction=function(t,e){const r=window.frag.Vector,n={scenePosition:t,ticksPerDistance:e,startLocation:void 0,startRotate:void 0,moveBy:void 0,rotateBy:void 0},a={__private:n,setInterval:function(t){return a.interval=t,a},moveBy:function(t){let e=r.length(t);return n.moveBy=t,a.duration=Math.floor(n.ticksPerDistance*e+1),a},moveByXYZ:function(t,e,r){return a.moveBy([t,e,r])},moveByXY:function(t,e){return a.moveBy([t,e])},rotateBy:function(t){return n.rotateBy=t,a},moveTo:function(t){let e=n.scenePosition.getLocation();return a.moveBy(r.sub(e,t)),a},moveToXYZ:function(t,e,r){return a.moveTo([t,e,r])},moveToXY:function(t,e){return a.moveTo([t,e])},onStart:function(t){return n.onStart=t,a},onStop:function(t){return n.onStop=t,a},start:function(t,e){return n.startLocation=n.scenePosition.getLocation(),n.startRotate=n.scenePosition.getRotate(),n.startTick=e,n.endTick=e+a.duration,n.onStart&&n.onStart(t,a,e),a},action:function(t,e){const o=(e-n.startTick)/a.duration;return n.moveBy&&n.scenePosition.location(r.add(n.startLocation,r.mult(n.moveBy,o))),n.rotateBy&&n.scenePosition.rotate(r.add(n.startRotate,r.mult(n.rotateBy,o))),a},stop:function(t,e){return n.onStop&&n.onStop(t,a,e),a}};return a}},666:()=>{window.frag.RepeatAnimationAction=function(t,e){return{duration:t.duration*e,interval:t.interval,start:t.start,stop:t.stop,action:t.action}}},890:()=>{window.frag.SceneObjectAnimation=function(t,e){const r=t.modelAnimation,n=t.childAnimations,a=[];for(let t=0;t<n.length;t++){const r=n[t],o=r.model.getName();if(animationState=e[o],animationState){const t=r.graph,e=animationState.getUpdateFunction(t.channel);a.push((function(r){e(t.frameValues[r])}))}}const o=function(t){for(let e=0;e<a.length;e++)a[e](t)},i=window.frag.KeyframeAnimationAction().setFrames(r.getInterval(),r.getFrames());for(let t=0;t<r.getFrames();t++)i.add(t,o);return window.frag.Animation().perform(i,r.getLoop())}},889:()=>{window.frag.ValueAnimationAction=function(){const t={},e={__private:t,duration:30,interval:5,setDuration:function(t){return e.duration=t,e},setInterval:function(t){return e.interval=t,e},onStart:function(r){return t.onStart=r,e},onStop:function(r){return t.onStop=r,e},onStep:function(r){return t.onStep=r,e},start:function(r,n){return t.startTick=n,t.endTick=n+e.duration,t.onStart&&t.onStart(r,e,n),e},action:function(r,n){if(t.onStep){const a=(n-t.startTick)/e.duration;t.onStep(r,a,e,n)}return e},stop:function(r,n){return t.onStop&&t.onStop(r,e,n),e}};return e}},14:()=>{window.frag.OrthographicCamera=function(){const t={x:0,y:0,z:-200,fov:35*Math.PI/180,zNear:-100,zFar:100,xScale:100,aspectRatio:1},e={__private:t,worldToClipTransform:window.frag.Transform()},r=function(){const r=1/t.xScale,n=t.aspectRatio/t.xScale,a=2/(t.zFar-t.zNear),o=1-t.zFar*a;e.worldToClipTransform.identity().translateZ(o).scaleXYZ(r,n,a).translateXY(-t.x,-t.y)};return e.moveToXY=function(n,a){return t.x=n,t.y=a,r(),e},e.moveToXYZ=function(n,a,o){return t.x=n,t.y=a,t.z=o,r(),e},e.moveToZ=function(n){return t.z=n,r(),e},e.frustrum=function(n,a,o){return t.fov=n,t.zNear=a,t.zFar=o,r(),e},e.scaleX=function(n){return t.xScale=n,r(),e},e.setViewport=function(t){return t.viewport(0,0,t.canvas.clientWidth,t.canvas.clientHeight),t.canvas.width=t.canvas.clientWidth,t.canvas.height=t.canvas.clientHeight,e.adjustToViewport(t)},e.adjustToViewport=function(r){const n=r.drawingBufferWidth/r.drawingBufferHeight;if(n!=t.aspectRatio){t.aspectRatio=n;const r=e.worldToClipTransform.getMatrix();r[5]=r[0]*n,e.worldToClipTransform.setMatrix(r)}return e},e}},906:()=>{window.frag.PerspectiveCamera=function(){const t=window.frag,e={locationTransform:window.frag.Transform(),worldTransform:window.frag.Transform(),perspectiveTransform:window.frag.Transform(),x:0,y:0,z:-200,xRot:0,yRot:0,zRot:0,fov:45*Math.PI/180,zNear:-100,zFar:100,xScale:100,aspectRatio:1,transformChanged:!0},r={__private:e,worldToClipTransform:window.frag.Transform()};return e.computeCameraTransforms=function(){e.locationTransform.identity().translateXYZ(e.x,e.y,e.z).rotateXYZ(e.xRot,e.yRot,e.zRot),e.worldTransform.identity().rotateXYZ(-e.xRot,-e.yRot,-e.zRot).scaleXYZ(1/e.xScale,e.aspectRatio/e.xScale,2/(e.zFar-e.zNear)).translateXYZ(-e.x,-e.y,-e.z),e.transformChanged=!0},e.computePerspectiveTransform=function(){const t=-2*(e.zNear-e.z)/(e.zFar-e.zNear)-1;e.perspectiveTransform.setMatrix([1,0,0,0,0,1,0,0,0,0,1,.5,0,0,t,.7]),e.transformChanged=!0},e.computeTransform=function(){const n=t.Matrix.m4Xm4(e.perspectiveTransform.getMatrix(),e.worldTransform.getMatrix());r.worldToClipTransform.setMatrix(n)},e.computeCameraTransforms(),e.computePerspectiveTransform(),r.moveToXY=function(t,n){return e.x=t,e.y=n,e.computeCameraTransforms(),r},r.moveToZ=function(t){return e.z=t,e.computeCameraTransforms(),e.computePerspectiveTransform(),r},r.moveToXYZ=function(t,n,a){return e.x=t,e.y=n,e.z=a,e.computeCameraTransforms(),e.computePerspectiveTransform(),r},r.frustrum=function(t,n,a){return e.fov=t,e.zNear=n,e.zFar=a,e.computePerspectiveTransform(),r},r.scaleX=function(t){return e.xScale=t,e.computeCameraTransforms(),r},r.setViewport=function(t){return t.viewport(0,0,t.canvas.clientWidth,t.canvas.clientHeight),t.canvas.width=t.canvas.clientWidth,t.canvas.height=t.canvas.clientHeight,r.adjustToViewport(t)},r.adjustToViewport=function(t){const n=t.drawingBufferWidth/t.drawingBufferHeight;return n!=e.aspectRatio&&(e.aspectRatio=n,e.computeCameraTransforms()),e.transformChanged&&(e.computeTransform(),e.transformChanged=!1),r},r}},270:()=>{window.frag.UiCamera=function(){const t={aspectRatio:1},e={worldToClipTransform:window.frag.Transform2D().identity(),scaleX:function(r){var n=e.worldToClipTransform.getMatrix();return n[0]=1/r,e.worldToClipTransform.setMatrix(n),t.aspectRatio=-1,e},setViewport:function(t){return t.viewport(0,0,t.canvas.clientWidth,t.canvas.clientHeight),t.canvas.width=t.canvas.clientWidth,t.canvas.height=t.canvas.clientHeight,e.adjustToViewport(t)},adjustToViewport:function(r){const n=r.drawingBufferWidth/r.drawingBufferHeight;if(t.aspectRatio!=n){const r=e.worldToClipTransform.getMatrix();r[4]=r[0]*n,e.worldToClipTransform.setMatrix(r),t.aspectRatio=n}return e}};return e}},437:()=>{!function(){const t=window.frag,e=[],r=[];let n=performance.now(),a=0,o=0,i=null;t.correctClock=function(e){let r=e-a;r>0?n+=t.gameTickMs:r<0&&(n-=t.gameTickMs)},t.mainScene=function(e){return i&&i.dispose(),i=e,t},t.addScene=function(r){return e.push(r),t},t.removeScene=function(t){for(let r=0;r<e.length;r++)if(e[r]===t)return e.splice(r,1),!0;return!1},t.addAnimation=function(e){return r.push(e),t},t.removeAnimation=function(t){for(let e=0;e<r.length;e++)if(r[e]===t)return r.splice(e,1),!0;return!1};const s=function(){if(i){let s=t.gl;const c=performance.now();a=Math.floor((c-n)/window.frag.gameTickMs),o++,function(t,e){for(let n=0;n<r.length;n++){let a=r[n];void 0!==a.nextFrameTick?e>=a.nextFrameTick&&(a.nextFrameTick=e+10,a.action(null,t,e)):null!=a.nextGameTick?t>=a.nextGameTick&&(a.nextGameTick=t+5,a.action(null,t,e)):a.nextGameTick=t+5}}(a,o),s.bindFramebuffer(s.FRAMEBUFFER,null),i.setViewport(s),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),i.draw(s);for(let t=0;t<e.length;t++)e[t].adjustToViewport(s),e[t].draw(s);const u=performance.now();t.fps=1e3/(u-c)}setTimeout(s,t.renderInterval)};s()}()},904:()=>{window.frag=function(t){if(t.canvas=t.canvas||document.getElementById("scene"),!t.canvas)return console.error('No canvas with id of "scene" in the page'),null;const e=t.canvas.getContext("webgl");return e?(t.gl=e,e.clearColor(1,1,1,1),e.enable(e.CULL_FACE),e.enable(e.DEPTH_TEST),t.renderInterval=15,t.gameTickMs=10,t.debugMaterialLoader=!1,t.debugModelLoader=!1,t.debugShaderBuilder=!1,t.debugAnimations=!1,t.maxTextureUnits=t.gl.getParameter(t.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),t.nextTextureUnit=0,t.allocateTextureUnit=function(){const e=t.nextTextureUnit;return t.nextTextureUnit=(t.nextTextureUnit+1)%t.maxTextureUnits,e},t.init&&t.init(t),t):(alert("WebGL is not available"),null)}(window.frag||{})},607:()=>{window.frag.Observable=function(t){const e={notify:t,observers:[]};return{__private:e,subscribe:function(t){e.observers.push(t),e.notify(t)},unsubscribe:function(t){for(let r=0;r<e.observers.length;r++)if(e.observers[r]===t)return e.observers.splice(r,1),!0;return!1},notify:function(t){t=t||e.notify||function(t){t()};for(let r=0;r<e.observers.length;r++)t(e.observers[r])}}},window.frag.ObservableValue=function(){let t=null;const e=frag.Observable((e=>{e(t)}));return{get:function(){return t},set:function(r){t=r,e.notify()},subscribe:function(t){return e.subscribe(t)},unsubscribe:function(t){return e.unsubscribe(t)}}}},346:()=>{window.frag.Transform=function(t){const e=window.frag,r={matrix:t},n={__private:r,observableMatrix:window.frag.Observable((t=>{t(r.matrix)})),is3d:!0,clone:function(t){return window.frag.Transform(t||r.matrix)},getMatrix:function(){return r.matrix},setMatrix:function(t){return r.matrix=t,n.observableMatrix.notify(),n}};return r.transform=function(t){return r.matrix?n.setMatrix(e.Matrix.m4Xm4(r.matrix,t)):n.setMatrix(t)},n.identity=function(){return n.setMatrix([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},n.scale=function(t){return r.transform([t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1])},n.scaleX=function(t){return r.transform([t,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])},n.scaleY=function(t){return r.transform([1,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1])},n.scaleZ=function(t){return r.transform([1,0,0,0,0,1,0,0,0,0,t,0,0,0,0,1])},n.scaleXY=function(t,e){return r.transform([t,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1])},n.scaleXYZ=function(t,e,n){return r.transform([t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1])},n.translateX=function(t){return r.transform([1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1])},n.translateY=function(t){return r.transform([1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1])},n.translateZ=function(t){return r.transform([1,0,0,0,0,1,0,0,0,0,1,0,0,0,t,1])},n.translateXY=function(t,e){return r.transform([1,0,0,0,0,1,0,0,0,0,1,0,t,e,0,1])},n.translateXYZ=function(t,e,n){return r.transform([1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1])},n.rotateX=function(t){var e=Math.cos(t),n=Math.sin(t);return r.transform([1,0,0,0,0,e,n,0,0,-n,e,0,0,0,0,1])},n.rotateY=function(t){var e=Math.cos(t),n=Math.sin(t);return r.transform([e,0,-n,0,0,1,0,0,n,0,e,0,0,0,0,1])},n.rotateZ=function(t){var e=Math.cos(t),n=Math.sin(t);return r.transform([e,n,0,0,-n,e,0,0,0,0,1,0,0,0,0,1])},n.rotateXYZ=function(t,e,r){return t&&n.rotateX(t),e&&n.rotateY(e),r&&n.rotateZ(r),n},n.apply=function(t,e){return void 0!==e&&t.uniformMatrix4fv(e,!1,n.getMatrix()),n},n},window.tests=window.tests||{},window.tests.transform={check:function(t,e,r,n){const a=window.frag.Matrix.m4Xv4(e.getMatrix(),r);window.tests.expectArray(t,n,a)},t1:window.frag.Transform().identity(),t2:window.frag.Transform().scaleXYZ(2,3,4).translateXYZ(1,2,3),t3:window.frag.Transform().translateXYZ(1,2,3).scaleXYZ(2,3,4),run:function(t){t.check("Identity matrix",t.t1,[9,13,56,1],[9,13,56,1]),t.check("Scale+translate matrix",t.t2,[1,1,1,1],[4,9,16,1]),t.check("Translate+scale matrix",t.t3,[1,1,1,1],[3,5,7,1])}},window.tests.transform.run(window.tests.transform)},670:()=>{window.frag.Transform2D=function(t){const e=window.frag,r={matrix:t},n={__private:r,observableMatrix:window.frag.Observable((t=>{t(r.matrix)})),is3d:!1,clone:function(t){return window.frag.Transform2D(t||r.matrix)},getMatrix:function(){return r.matrix},setMatrix:function(t){return r.matrix=t,n.observableMatrix.notify(),n}};return r.transform=function(t){return r.matrix?n.setMatrix(e.Matrix.m3Xm3(r.matrix,t)):n.setMatrix(t)},n.identity=function(){return n.setMatrix([1,0,0,0,1,0,0,0,1])},n.scale=function(t){return r.transform([t,0,0,0,t,0,0,0,1])},n.scaleXY=function(t,e){return r.transform([t,0,0,0,e,0,0,0,1])},n.translateX=function(t){return r.transform([1,0,0,0,1,0,t,0,1])},n.translateY=function(t){return r.transform([1,0,0,0,1,0,0,t,1])},n.translateXY=function(t,e){return r.transform([1,0,0,0,1,0,t,e,1])},n.rotate=function(t){var e=Math.cos(t),n=Math.sin(t);return r.transform([e,-n,0,n,e,0,0,0,1])},n.apply=function(t,e){return void 0!==e&&t.uniformMatrix3fv(e,!1,n.getMatrix()),n},n}},237:()=>{window.frag.AssetCatalog=function(t,e){const r=window.frag,n=new Uint8Array([127,127,127,255,0,0,255,0,0,0,0,127,127,255]);e||(e={}),e.diffuse||(e.diffuse=r.Texture().name("default-diffuse-texture").dataFormat(r.gl.RGBA).fromArrayBuffer(0,n.buffer,0,1,1)),e.surface||(e.surface=r.Texture().name("default-surface-texture").dataFormat(r.gl.RGBA).fromArrayBuffer(0,n.buffer,4,1,1)),e.emmissive||(e.emmissive=r.Texture().name("default-emmissive-texture").dataFormat(r.gl.RGB).fromArrayBuffer(0,n.buffer,8,1,1)),e.normal||(e.normal=r.Texture().name("default-normal-map-texture").dataFormat(r.gl.RGB).fromArrayBuffer(0,n.buffer,11,1,1)),t||(t=r.Shader().name("Model").verticiesXYZ().matrix3D().diffuseTexture().directionalLightGrey().compile());const a={defaultTextures:e,materials:{},models:{}},o={__private:a,shader:t,getMaterial:function(t){var e=a.materials[t];return e||(e=r.Material().name(t).disposeTextures(!1).setTexture("diffuse",a.defaultTextures.diffuse).setTexture("emmissive",a.defaultTextures.emmissive).setTexture("surface",a.defaultTextures.surface).setTexture("normalMap",a.defaultTextures.normal),a.materials[t]=e),e},getModel:function(t,e){var n=e?void 0:a.models[t];return n||(n=r.Model().name(t).shader(o.shader),e||(a.models[t]=n)),n}};return o}},583:()=>{window.frag.MaterialLoader=function(){const t=window.frag,e=new Uint32Array([287454020]),r=68===new Uint8Array(e.buffer)[0],n={},a={__private:n,littleEndian:r};return n.loadMipV1=function(e,n,a,o,i,s,c,u){const l=e.getUint8(n++),f=e.getUint32(n,r);t.debugMaterialLoader&&console.log("Color data at "+f),n+=4;const m=t.Texture().dataFormat(1==(1&l)?t.gl.RGBA:t.gl.RGB).fromArrayBuffer(s,a,o+f,c,u);if(i.setTexture("diffuse",m),2==(2&l)){const l=e.getUint32(n,r);t.debugMaterialLoader&&console.log("Surface data at "+l),n+=4;const f=t.Texture().dataFormat(t.gl.RGBA).fromArrayBuffer(s,a,o+l,c,u);i.setTexture("surface",f)}if(4==(4&l)){const l=e.getUint32(n,r);t.debugMaterialLoader&&console.log("Normal map at "+l),n+=4;const f=t.Texture().dataFormat(t.gl.RGB).fromArrayBuffer(s,a,o+l,c,u);i.setTexture("normalMap",f)}if(8==(8&l)){const l=e.getUint32(n,r);t.debugMaterialLoader&&console.log("PBR data at "+l),n+=4;const f=t.Texture().dataFormat(t.gl.RGBA).fromArrayBuffer(s,a,o+l,c,u);i.setTexture("pbr",f)}return n},n.loadMaterialV1=function(e,r,a,o,i){const s=r.getUint8(a++);var c="";for(let t=0;t<s;t++)c+=String.fromCharCode(r.getUint8(a++));const u=e.getMaterial(c);t.debugMaterialLoader&&(console.log(""),console.log("Loading "+c+" material textures"));var l,f=1<<r.getUint8(a++),m=f,d=0;do{l=r.getUint8(a++),t.debugMaterialLoader&&console.log("Loading MIP level "+l+" at "+f+" x "+m+" pixels"),l!==d&&console.error("Mip levels are wrong for "+c+" texture"),a=n.loadMipV1(r,a,o,i,u,l,f,m),d++,f>>>=1,m>>>=1}while(0!==l)},a.loadMaterialsFromBuffer=function(e,a){a||(a=t.AssetCatalog());const o=new Uint8Array(e),i=new DataView(e,0,o.length),s=o[0],c=i.getUint16(2,r);var u=4;const l=u+c;if(t.debugMaterialLoader&&console.log("Material pack V"+s+" is "+o.length+" bytes with "+c+" header bytes"),1===s)for(var f=i.getUint16(u,r);0!==f;)n.loadMaterialV1(materialStore,i,u+2,e,l),u+=f,f=i.getUint16(u,r);else console.error("Version "+s+" texture packs are not supported");return a},a.loadMaterialsFromUrl=function(t,e,r){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onreadystatechange=function(){4==this.readyState&&200==this.status&&(e=a.loadMaterialsFromBuffer(this.response,e),r&&r(e))},n.open("GET",t,!0),n.send()},a}()},96:()=>{window.frag.ModelLoader=function(){const t=window.frag,e=new Uint32Array([287454020]),r=68===new Uint8Array(e.buffer)[0],n={},a={__private:n,littleEndian:r};return n.loadMaterialV1=function(e,r,n){const a=e.header.getUint8(n++);var o="";for(let t=0;t<a;t++)o+=String.fromCharCode(e.header.getUint8(n++));const i=e.assetCatalog.getMaterial(o);return t.debugModelLoader&&console.log("Object["+r+"] is material "+o),i},n.loadMeshV1=function(e,n,a){const o=t.MeshData(),i=e.header.getUint16(a,r);a+=2,t.debugModelLoader&&console.log("Object["+n+"] is a mesh with "+i+" fragments");for(let n=0;n<i;n++){const i=e.header.getUint8(a),s=e.header.getUint8(a+1),c=e.header.getUint8(a+2),u=e.header.getUint8(a+3),l=e.header.getUint8(a+4),f=e.header.getUint8(a+5),m=e.header.getUint8(a+6),d=e.header.getUint32(a+7,r),g=e.header.getUint32(a+11,r);let h=e.header.getUint32(a+15,r)+e.dataOffset;a+=19;const v=1==(1&s),p=2==(2&s);let x=0;if(1===i?x=d/3:2===i?x=d/2:(3===i||4===i)&&(x=d-2),t.debugModelLoader){let t="  fragment["+n+"] has "+d+" verticies forming ";switch(1===i?t+=x+" triangles":2===i?t+=x/2+" rectangles":3===i?t+="a strip of "+x+"triangles":4===i&&(t+="a fan of "+x+" triangles"),v&&(t+=" indexed"),p||(t+=" in 2D"),c){case 1:t+=" with custom normals";break;case 2:t+=" with indexed normals";break;case 3:t+=" with triangle normals"}switch(u){case 1:t+=" with custom tangents";break;case 2:t+=" with indexed tangents";break;case 3:t+=" with triangle tangents";break;case 4:t+=" with single tangent"}switch(l){case 1:t+=" with bitangents"}switch(f){case 1:t+=" with custom uvs";break;case 2:t+=" with indexed uvs";break;case 3:t+=" with triangle uvs"}switch(m){case 1:t+=" with custom colors";break;case 2:t+=" with custom colors and transparency";break;case 3:t+=" with indexed colors";break;case 4:t+=" with indexed colors and transparency"}console.log(t)}const T=v?[]:void 0;if(v){indexArray=new Int16Array(e.data,h);for(let t=0;t<d;t++)T.push(indexArray[t]);h+=2*d,1==(1&d)&&(h+=2)}const w=[],b=0===c?void 0:[],D=0===u?void 0:[],y=0===l?void 0:[],F=0===f?void 0:[],S=void 0,_=new Float32Array(e.data,h);for(let t=0;t<d;t++){let e=v?T[t]:t,r=Math.trunc(t/3);2===i?r=Math.trunc(t/4):3!==i&&4!==i||(r=t<3?0:t-2);let n=0,a=p?3*e:2*e;switch(w.push(_[a]),w.push(_[a+1]),p?(w.push(_[a+2]),n+=3*g):n+=2*g,c){case 1:a=n+3*t,n+=3*d;break;case 2:a=n+3*e,n+=3*g;break;case 3:a=n+3*r,n+=3*x}0!==c&&(b.push(_[a]),b.push(_[a+1]),b.push(_[a+2]))}const M=t.VertexData();1===i||2===i?p?M.setTriangles(w,S,F,b,D,y):M.setTriangles2D(w,S,F,b,D,y):3===i?M.setTriangleStrip(w,S,F,b,D,y):4===i&&M.setTriangleFan(w,S,F,b,D,y),o.addVertexData(M)}return o},n.loadAnimationV1=function(e,n,a){const o=e.header.getUint8(a++);var i="";for(let t=0;t<o;t++)i+=String.fromCharCode(e.header.getUint8(a++));const s=e.header.getUint8(a),c=e.header.getUint16(a+1,r),u=e.header.getUint16(a+3,r),l=e.header.getUint8(a+5);a+=6;const f=1==(1&s),m=2==(2&s);if(t.debugModelLoader){let t="Object["+n+"] is '"+i+"' animation which runs for "+c+"x"+u+" frames";f&&(t+=". Repeats until stopped"),m&&(t+=". Plays in reverse after playing forwards"),console.log(t)}const d=t.ModelAnimation().name(i).loop(f).frames(c).interval(u/window.frag.gameTickMs);for(let t=0;t<l;t++){const t=e.header.getUint8(a++);var g="";for(let r=0;r<t;r++)g+=String.fromCharCode(e.header.getUint8(a++));const n=e.header.getUint8(a++);var h="";for(let t=0;t<n;t++)h+=String.fromCharCode(e.header.getUint8(a++));const o={},i=e.header.getUint16(a,r);a+=2;for(let t=0;t<i;t++){const t=e.header.getUint16(a,r),n=e.header.getUint8(a+2),i=e.header.getFloat32(a+3,r);a+=7;var v="step";1===n?v="linear":2===n&&(v="spline"),o[t]={value:i,transition:v}}d.addChannel({channel:h,pattern:new RegExp(g,"i"),keyframes:o})}return d},n.loadModelV1=function(e,n,a){const o=e.header.getUint8(a++);var i="";for(let t=0;t<o;t++)i+=String.fromCharCode(e.header.getUint8(a++));const s=e.header.getUint8(a),c=e.header.getUint16(a+1,r),u=e.header.getUint16(a+3,r);a+=5;const l=t.Transform().translateXYZ(e.header.getFloat32(a+0,r),e.header.getFloat32(a+4,r),e.header.getFloat32(a+8,r)).rotateXYZ(e.header.getFloat32(a+12,r),e.header.getFloat32(a+16,r),e.header.getFloat32(a+20,r)).scaleXYZ(e.header.getFloat32(a+24,r),e.header.getFloat32(a+28,r),e.header.getFloat32(a+32,r));a+=36;const f=e.header.getUint16(a,r),m=e.header.getUint16(a+2,r);a+=4;const d=1==(1&s),g=2==(2&s),h=4==(4&s);t.debugModelLoader&&console.log("Object["+n+"] is "+(d?"root ":"")+"model "+i+" with "+f+" children and "+m+" animations. Paint mesh "+u+" with material "+c);const v=e.assetCatalog.getModel(i,!d).transform(l);g&&v.material(e.materials[c]),h&&v.mesh(e.meshes[u]);for(let t=0;t<f;t++){const t=e.header.getUint16(a,r);a+=2,v.addChild(e.models[t])}if(d){t.debugAnimations&&m>0&&console.log("Model #"+n+" '"+i+"' has "+m+" animations");for(let n=0;n<m;n++){const n=e.header.getUint16(a,r);a+=2;const o=e.animations[n];if(t.debugAnimations){const t=o.getChannelGraphs();console.log("  Animation '"+o.getName()+"' has "+t.length+" channels."+(o.__private.loop?" Loop ":"")+o.__private.frames+"x"+o.__private.interval+" frames");for(let e=0;e<t.length;e++)console.log("    Animates "+t[e].channel+" for children matching "+t[e].pattern)}v.addAnimation(o)}}else m>0&&console.warn("Model #"+n+" '"+i+"' has "+m+" animations but is not a root");return v},a.loadModelsFromBuffer=function(e,a){a||(a=t.AssetCatalog());const o=new Uint8Array(e),i=new DataView(e,0,o.length),s=o[0],c=i.getUint32(4,r);var u=8;const l=u+c;t.debugModelLoader&&console.log("Model pack V"+s+" is "+o.length+" bytes with "+c+" header bytes");const f={assetCatalog:a,header:i,data:e,dataOffset:l,materials:{},meshes:{},animations:{},models:{}};if(1===s)for(var m=i.getUint16(u,r),d=0;0!==m;){const t=i.getUint16(u+2,r),e=i.getUint8(u+4),a=u+5;if(t!==d++)return void console.error("Object indexes are not consecutive");if(0===e)break;1===e?f.materials[t]=n.loadMaterialV1(f,t,a):2===e?f.meshes[t]=n.loadMeshV1(f,t,a):3===e?f.animations[t]=n.loadAnimationV1(f,t,a):4===e?f.models[t]=n.loadModelV1(f,t,a):console.error("Unknown object type "+e),u+=m,m=i.getUint16(u,r)}else console.error("Version "+s+" model packs are not supported");return a},a.loadModelsFromUrl=function(t,e,r){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.onreadystatechange=function(){4==this.readyState&&200==this.status&&(e=a.loadModelsFromBuffer(this.response,e),r&&r(e))},n.open("GET",t,!0),n.send()},a}()},655:()=>{window.frag.Material=function(){const t={textures:{},disposeTextures:!1},e={__private:t,dispose:function(){if(t.disposeTextures)for(let e in t.textures){const r=t.textures[e];r&&r.dispose()}t.textures={}},disposeTextures:function(r){return t.disposeTextures=r,e},name:function(r){return t.name=r,e},setTexture:function(r,n){if(t.disposeTextures){const e=t.textures[r];e&&e.dispose()}return t.textures[r]=n,e},apply:function(r,n){for(let e in t.textures){const a=t.textures[e];a&&a.apply(e,r,n)}return e}};return e}},394:()=>{window.frag.Texture=function(){const t=window.frag.gl,e={glTexture:null,generated:!1,internalFormat:t.RGBA,format:t.RGBA,dataType:t.UNSIGNED_BYTE,valuesPerPixel:4},r={__private:e,textureUnit:window.frag.allocateTextureUnit(),dispose:function(){e.glTexture&&(t.deleteTexture(e.glTexture),e.glTexture=null,e.disposed=!0)},name:function(t){return e.name=t,r},dataFormat:function(n){return e.internalFormat=n,e.format=n,n===t.RGBA?(e.dataType=t.UNSIGNED_BYTE,e.valuesPerPixel=4):n===t.RGB?(e.dataType=t.UNSIGNED_BYTE,e.valuesPerPixel=3):n===t.LUMINANCE_ALPHA?(e.dataType=t.UNSIGNED_BYTE,e.valuesPerPixel=2):n!==t.LUMINANCE&&formaat!==t.ALPHA||(e.dataType=t.UNSIGNED_BYTE,e.valuesPerPixel=1),r}};return e.setup=function(r,n){e.width=r,e.height=n,e.glTexture||(e.glTexture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,e.glTexture),0==(r&r-1)&&0==(n&n-1)||(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),e.generated=!0)},r.fromArrayBuffer=function(n,a,o,i,s){let c;return e.dataType===t.UNSIGNED_BYTE&&(c=new Uint8Array(a,o,i*s*e.valuesPerPixel)),e.setup(i,s),t.texImage2D(t.TEXTURE_2D,n,e.internalFormat,i,s,0,e.format,e.dataType,c),r},r.fromImage=function(n,a){const o=function(){e.setup(a.width,a.height),t.texImage2D(t.TEXTURE_2D,n,e.internalFormat,e.format,e.dataType,a)};return a.onload?o():a.onload=o,r},r.fromUrl=function(t,e,n){const a=new Image;return r.fromImage(t,a),void 0!==n&&(a.crossOrigin=n),a.src=e,r},r.update=function(t,n){const a=window.frag.gl;return e.scene&&(void 0!==t&&void 0!==n&&(t===e.width&&n===e.height||r.fromScene(e.scene,t,n)),a.bindFramebuffer(a.FRAMEBUFFER,e.frameBuffer),a.viewport(0,0,e.width,e.height),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),e.scene.adjustToViewport(a),e.scene.draw(a)),r},r.fromScene=function(t,n,a){const o=window.frag.gl;return e.setup(n,a),o.texImage2D(o.TEXTURE_2D,0,e.internalFormat,n,a,0,e.format,e.dataType,null),e.scene=t,e.frameBuffer=o.createFramebuffer(),o.bindFramebuffer(o.FRAMEBUFFER,e.frameBuffer),o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e.glTexture,0),e.depthBuffer=o.createRenderbuffer(),o.bindRenderbuffer(o.RENDERBUFFER,e.depthBuffer),o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,n,a),o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e.depthBuffer),r.update(n,a)},r.apply=function(t,n,a){return a.uniforms[t]&&e.glTexture?(n.activeTexture(n.TEXTURE0+r.textureUnit),n.bindTexture(n.TEXTURE_2D,e.glTexture),e.generated||(n.generateMipmap(n.TEXTURE_2D),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),e.generated=!0),n.uniform1i(a.uniforms[t],r.textureUnit),r):r},r}},996:()=>{window.frag=window.frag||{},window.frag.Matrix={m3Identity:function(){return[1,0,0,0,1,0,0,0,1]},m3Invert:function(t){return t},m3Transpose:function(t){return[t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]]},m3Xm3:function(t,e){const r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=e[0],m=e[1],d=e[2],g=e[3],h=e[4],v=e[5],p=e[6],x=e[7],T=e[8];return[f*r+m*o+d*c,f*n+m*i+d*u,f*a+m*s+d*l,g*r+h*o+v*c,g*n+h*i+v*u,g*a+h*s+v*l,p*r+x*o+T*c,p*n+x*i+T*u,p*a+x*s+T*l]},m3Xv3:function(t,e){const r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=e[0],m=e[1],d=e[2];return[f*r+m*o+d*c,f*n+m*i+d*u,f*a+m*s+d*l]},m4Identity:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},m4Invert:function(t){return[t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10],t[3],t[7],t[11]]},m4Transpose:function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},m4Xm4:function(t,e){const r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=t[9],m=t[10],d=t[11],g=t[12],h=t[13],v=t[14],p=t[15],x=e[0],T=e[1],w=e[2],b=e[3],D=e[4],y=e[5],F=e[6],S=e[7],_=e[8],M=e[9],A=e[10],E=e[11],C=e[12],R=e[13],L=e[14],U=e[15];return[x*r+T*i+w*l+b*g,x*n+T*s+w*f+b*h,x*a+T*c+w*m+b*v,x*o+T*u+w*d+b*p,D*r+y*i+F*l+S*g,D*n+y*s+F*f+S*h,D*a+y*c+F*m+S*v,D*o+y*u+F*d+S*p,_*r+M*i+A*l+E*g,_*n+M*s+A*f+E*h,_*a+M*c+A*m+E*v,_*o+M*u+A*d+E*p,C*r+R*i+L*l+U*g,C*n+R*s+L*f+U*h,C*a+R*c+L*m+U*v,C*o+R*u+L*d+U*p]},m4Xv4:function(t,e){const r=t[0],n=t[1],a=t[2],o=t[3],i=t[4],s=t[5],c=t[6],u=t[7],l=t[8],f=t[9],m=t[10],d=t[11],g=t[12],h=t[13],v=t[14],p=t[15],x=e[0],T=e[1],w=e[2],b=e[3];return[x*r+T*i+w*l+b*g,x*n+T*s+w*f+b*h,x*a+T*c+w*m+b*v,x*o+T*u+w*d+b*p]}},window.tests=window.tests||{},window.tests.expectArray=function(t,e,r){r.length!==e.length&&console.log("Test "+t+" wrong length array");for(let n=0;n<e.length;n++)Math.abs(e[n]-r[n])>.001&&console.log("Test "+t+" index "+n+" was "+r[n]+" expecting "+e[n])},window.tests.matrix={t1:window.frag.Matrix.m4Transpose([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),run:function(t){window.tests.expectArray("Transpose matrix",t.t1,[1,5,9,13,2,6,10,14,3,7,11,15,4,8,12,16])}},window.tests.matrix.run(window.tests.matrix)},197:()=>{window.frag=window.frag||{},window.frag.Triangle={makeTriangleFromVectors:function(t,e,r){return{a:t,b:e,c:r}},makeTriangleFromArray2D:function(t,e,r,n){return t?{a:[t[e],t[e+1]],b:[t[r],t[r+1]],c:[t[n],t[n+1]]}:null},makeTriangleFromArray3D:function(t,e,r,n){return t?{a:[t[e],t[e+1],t[e+2]],b:[t[r],t[r+1],t[r+2]],c:[t[n],t[n+1],t[n+2]]}:null},normal:function(t){const e=window.frag.Vector,r=e.sub(t.a,t.b),n=e.sub(t.c,t.b);return e.normalize(e.cross(r,n))}}},601:()=>{window.frag=window.frag||{},window.frag.Vector={makeVectorFromArray2D:function(t,e){return t?[t[e],t[e+1]]:null},makeVectorFromArray3D:function(t,e){return t?[t[e],t[e+1],t[e+2]]:null},zero:function(t){const e=[0,0,0,0,0];return e.length=t,e},add:function(t,e){const r=[];if(Array.isArray(e))for(let n=0;n<t.length;n++)r.push(t[n]+e[n]);else for(let n=0;n<t.length;n++)r.push(t[n]+e);return r},sub:function(t,e){const r=[];if(Array.isArray(e))for(let n=0;n<t.length;n++)r.push(t[n]-e[n]);else for(let n=0;n<t.length;n++)r.push(t[n]-e);return r},mult:function(t,e){const r=[];if(Array.isArray(e))for(let n=0;n<t.length;n++)r.push(t[n]*e[n]);else for(let n=0;n<t.length;n++)r.push(t[n]*e);return r},div:function(t,e){const r=[];if(Array.isArray(e))for(let n=0;n<t.length;n++)r.push(t[n]/e[n]);else for(let n=0;n<t.length;n++)r.push(t[n]/e);return r},length:function(t){let e=0;for(let r=0;r<t.length;r++)e+=t[r]*t[r];return Math.sqrt(e)},average:function(t,e){const r=[];for(let n=0;n<t.length;n++)r.push((t[n]+e[n])/2);return r},cross:function(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]},normalize:function(t){const e=window.frag.Vector.length(t);if(e<1e-5)return t;const r=[];for(let n=0;n<t.length;n++)r.push(t[n]/e);return r}}},175:()=>{window.frag.MeshData=function(){const t=window.frag,e=t.gl,r={glBuffer:e.createBuffer(),meshFragments:[],debugFragments:[],finalized:!1,fromBuffer:!1,smoothShading:!0,smoothTexture:!1,wireframe:!1,normalLength:0,normalColor:[0,0,255]},n={__private:r,calcNormals:!0,calcTangents:!0,calcBitangents:!1,dispose:function(){r.glBuffer&&(e.deleteBuffer(r.glBuffer),r.glBuffer=null)},name:function(t){return r.name=t,n},clear:function(){return r.meshFragments.length=0,r.finalized=!1,n},shadeSmooth:function(){return r.smoothShading=!0,r.finalized=!1,n},shadeFlat:function(){return r.smoothShading=!1,r.finalized=!1,n},textureSmooth:function(){return r.smoothTexture=!0,r.finalized=!1,n},textureFlat:function(){return r.smoothTexture=!1,r.finalized=!1,n},wireframe:function(t){return r.wireframe=!!t,r.finalized=!1,n},drawNormals:function(t,e){return r.normalLength=t,void 0!==e&&(r.normalColor=e),r.finalized=!1,n}};return r.Fragment=function(t){return{vertexData:t,renderData:null,vertexDataOffset:void 0,colorDataOffset:void 0,uvDataOffset:void 0,normalDataOffset:void 0,tangentDataOffset:void 0,bitangentDataOffset:void 0}},r.addFragment=function(t){return r.meshFragments.push(r.Fragment(t)),r.finalized=!1,n},n.addVertexData=function(t){return r.addFragment(t)},n.addTriangles2D=function(e,n,a,o,i,s){const c=t.VertexData().setTriangles2D(e,n,a,o,i,s);return r.addFragment(c)},n.addTriangles=function(e,n,a,o,i,s){const c=t.VertexData().setTriangles(e,n,a,o,i,s);return r.addFragment(c)},n.addTriangleStrip=function(e,n,a,o,i,s){const c=t.VertexData().setTriangleStrip(e,n,a,o,i,s);return r.addFragment(c)},n.addTriangleFan=function(e,n,a,o,i,s){const c=t.VertexData().setTriangleFan(e,n,a,o,i,s);return r.addFragment(c)},n.fromBuffer=function(a,o,i,s,c,u,l,f,m,d){const g=t.VertexData();g.vertexDimensions=o,g.vertexCount=i,g.primitiveType=s,g.extractTriangles=function(){},r.addFragment(g);const h=r.meshFragments[r.meshFragments.length-1];return h.renderData=g,h.vertexDataOffset=c,h.colorDataOffset=u,h.uvDataOffset=l,h.normalDataOffset=f,h.tangentDataOffset=m,h.bitangentDataOffset=d,e.bindBuffer(e.ARRAY_BUFFER,r.glBuffer),e.bufferData(e.ARRAY_BUFFER,a,e.STATIC_DRAW),r.finalized=!0,r.fromBuffer=!0,n},r.addFragmentDebugInfo=function(e){if(!r.wireframe&&0==r.normalLength)return;let n=e;r.wireframe||(n=r.Fragment(e.vertexData),r.debugFragments.push(n));const a=[],o=[],i=[],s=[],c=function(t){const n=e.renderData.getVertexVector(t),c=e.renderData.getColor(t),u=e.renderData.getUvVector(t),l=e.renderData.getNormalVector(t);n&&n.forEach((t=>a.push(t))),c?c.forEach((t=>o.push(t))):r.normalColor.forEach((()=>o.push(0))),u&&u.forEach((t=>i.push(t))),l&&l.forEach((t=>s.push(t)))},u=function(t){const n=e.renderData.getVertexVector(t),c=e.renderData.getUvVector(t),u=e.renderData.getNormalVector(t);if(n){for(let t=0;t<n.length;t++)a.push(n[t]);for(let t=0;t<n.length;t++)a.push(n[t]+u[t]*r.normalLength)}r.normalColor.forEach((t=>o.push(t))),r.normalColor.forEach((t=>o.push(t))),c&&(c.forEach((t=>i.push(t))),c.forEach((t=>i.push(t)))),u&&(u.forEach((t=>s.push(t))),u.forEach((t=>s.push(t))))};e.vertexData.extractTriangles((function(t,e,n){r.wireframe&&(c(t),c(e),c(e),c(n),c(n),c(t)),r.normalLength>0&&(u(t),u(e),u(e))})),2==e.vertexData.vertexDimensions?n.renderData=t.VertexData().setLines2D(a,o,i,s):n.renderData=t.VertexData().setLines(a,o,i,s)},r.finalize=function(){r.finalized=!0;const a=t.MeshOptimizer().setFragments(r.meshFragments).initialize(r.smoothShading,r.smoothTexture);n.calcTangents&&a.calcTangentsFromUvs(),n.calcBitangents&&a.calcBitangentsFromUvs(),n.calcNormals&&a.calcNormalsFromCross(),n.calcNormals&&a.calcNormalsFromGeometry(),n.calcBitangents&&a.calcBitangentsFromCross(),r.debugFragments=[],r.meshFragments.forEach((t=>{r.addFragmentDebugInfo(t)}));let o=0;const i=function(t){o+=t.renderData.verticies.length,t.renderData.colors&&(o+=t.renderData.colors.length),t.renderData.uvs&&(o+=t.renderData.uvs.length),t.renderData.normals&&(o+=t.renderData.normals.length),t.renderData.tangents&&(o+=t.renderData.tangents.length),t.renderData.bitangents&&(o+=t.renderData.bitangents.length)};r.meshFragments.forEach(i),r.debugFragments.forEach(i);const s=new Float32Array(o);let c=0;const u=function(t){if(!t)return;for(let e=0;e<t.length;e++)s[c+e]=t[e];const e=c;return c+=t.length,e*Float32Array.BYTES_PER_ELEMENT},l=function(t){t.vertexDataOffset=u(t.renderData.verticies),t.colorDataOffset=u(t.renderData.colors),t.uvDataOffset=u(t.renderData.uvs),t.normalDataOffset=u(t.renderData.normals),t.tangentDataOffset=u(t.renderData.tangents),t.bitangentDataOffset=u(t.renderData.bitangents)};return r.meshFragments.forEach(l),r.debugFragments.forEach(l),e.bindBuffer(e.ARRAY_BUFFER,r.glBuffer),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),n},r.drawFragmentPosition=function(t,r){t.attributes.position>=0&&(null!=r.vertexDataOffset?(e.enableVertexAttribArray(t.attributes.position),e.vertexAttribPointer(t.attributes.position,r.renderData.vertexDimensions,e.FLOAT,!1,0,r.vertexDataOffset)):e.disableVertexAttribArray(t.attributes.position))},r.drawFragmentColor=function(t,r){t.attributes.color>=0&&(null!=r.colorDataOffset?(e.enableVertexAttribArray(t.attributes.color),e.vertexAttribPointer(t.attributes.color,r.renderData.colorDimensions,e.FLOAT,!1,0,r.colorDataOffset)):e.disableVertexAttribArray(t.attributes.color))},r.drawFragmentTexture=function(t,r){t.attributes.texture>=0&&(null!=r.uvDataOffset?(e.enableVertexAttribArray(t.attributes.texture),e.vertexAttribPointer(t.attributes.texture,r.renderData.uvDimensions,e.FLOAT,!1,0,r.uvDataOffset)):e.disableVertexAttribArray(t.attributes.texture))},r.drawFragmentNormals=function(t,r){t.attributes.normal>=0&&(null!=r.normalDataOffset?(e.enableVertexAttribArray(t.attributes.normal),e.vertexAttribPointer(t.attributes.normal,r.renderData.normalDimensions,e.FLOAT,!0,0,r.normalDataOffset)):e.disableVertexAttribArray(t.attributes.normal))},r.drawFragmentTangents=function(t,r){t.attributes.tangent>=0&&(null!=r.tangentDataOffset?(e.enableVertexAttribArray(t.attributes.tangent),e.vertexAttribPointer(t.attributes.tangent,r.renderData.normalDimensions,e.FLOAT,!0,0,r.tangentDataOffset)):e.disableVertexAttribArray(t.attributes.tangent))},r.drawFragmentBitangents=function(t,r){t.attributes.bitangent>=0&&(null!=r.bitangentDataOffset?(e.enableVertexAttribArray(t.attributes.bitangent),e.vertexAttribPointer(t.attributes.bitangent,r.renderData.normalDimensions,e.FLOAT,!0,0,r.bitangentDataOffset)):e.disableVertexAttribArray(t.attributes.bitangent))},r.drawFragment=function(t,n){r.drawFragmentPosition(t,n),r.drawFragmentColor(t,n),r.drawFragmentTexture(t,n),r.drawFragmentNormals(t,n),r.drawFragmentTangents(t,n),r.drawFragmentBitangents(t,n),e.drawArrays(n.renderData.primitiveType,0,n.renderData.vertexCount)},n.draw=function(t,e){r.finalized||r.fromBuffer||r.finalize(),t.bindBuffer(t.ARRAY_BUFFER,r.glBuffer);for(let t=0;t<r.meshFragments.length;t++){const n=r.meshFragments[t];r.drawFragment(e,n)}for(let t=0;t<r.debugFragments.length;t++){const n=r.debugFragments[t];r.drawFragment(e,n)}return n},n}},3:()=>{window.frag.MeshOptimizer=function(){const t=window.frag,e={meshFragments:null,smoothShading:!0,smoothTexture:!1,fragmentTriangles:null,groups:null,groupIndecies:null},r={__private:e};return e.ensureTriangles=function(){e.fragmentTriangles||(e.fragmentTriangles=[],e.meshFragments.forEach((r=>{const n=r.vertexData,a={triangles:[],vertexTriangleIndecies:[]};a.vertexTriangleIndecies.length=n.vertexCount,n.verticies&&n.extractTriangles((function(e,r,o){const i=n.getVertexVector(e),s=n.getVertexVector(r),c=n.getVertexVector(o),u={triangle:t.Triangle.makeTriangleFromVectors(i,s,c),normal:null,tangent:null,bitangent:null};if(u.normal=t.Triangle.normal(u.triangle),n.uvs){const a=n.getUvVector(e),l=n.getUvVector(r),f=n.getUvVector(o),m=t.Vector.sub(s,i),d=t.Vector.sub(c,i),g=t.Vector.sub(l,a),h=t.Vector.sub(f,a),v=g[0]*h[1]-g[1]*h[0];if(0===v)u.tangent=t.Vector.zero(n.normalDimensions),u.bitangent=t.Vector.zero(n.normalDimensions);else{const e=1/v;u.tangent=t.Vector.normalize(t.Vector.mult(t.Vector.sub(t.Vector.mult(m,h[1]),t.Vector.mult(d,g[1])),e)),u.bitangent=t.Vector.normalize(t.Vector.mult(t.Vector.sub(t.Vector.mult(d,g[0]),t.Vector.mult(m,h[0])),e))}}a.triangles.push(u);const l=a.triangles.length-1;a.vertexTriangleIndecies[e]=l,a.vertexTriangleIndecies[r]=l,a.vertexTriangleIndecies[o]=l})),e.fragmentTriangles.push(a)})))},e.ensureGroups=function(){if(e.groups)return;e.groups=[],e.groupIndecies={};const r=function(t,e,r){if(t.vertexDimensions!==r.length)return!1;const n=t.vertexIndex(e);for(var a=0;a<r.length;a++)if(Math.abs(t.verticies[n+a]-r[a])>1e-5)return!1;return!0};for(let a=0;a<e.meshFragments.length;a++){const o=e.meshFragments[a],i=e.groupIndecies[a]||[];if(e.groupIndecies[a]=i,o.vertexData.verticies)for(let s=0;s<o.vertexData.vertexCount;s++){let c=!1;for(var n=0;!c&&n<e.groups.length;n++){const t=e.groups[n];r(o.vertexData,s,t.vertex)&&(t.fragmentIndecies[a]=t.fragmentIndecies[a]||[],t.fragmentIndecies[a].push(s),i.push(n),c=!0)}if(!c){i.push(e.groups.length);const r={vertex:o.vertexData.getVertexVector(s),fragmentIndecies:{},normal:t.Vector.zero(o.vertexData.normalDimensions),uv:t.Vector.zero(o.vertexData.uvDimensions)};r.fragmentIndecies[a]=[s],e.groups.push(r)}}}},e.calcGroupNormals=function(){e.ensureGroups();for(let r=0;r<e.groups.length;r++){const n=e.groups[r];n.normal=t.Vector.zero(e.meshFragments[0].renderData.normalDimensions);for(const r in n.fragmentIndecies){const a=e.meshFragments[r],o=a.renderData?a.renderData:a.vertexData;if(o&&o.normals){const e=n.fragmentIndecies[r];for(let r=0;r<e.length;r++){const a=e[r],i=o.getNormalVector(a);n.normal=t.Vector.add(n.normal,i)}}}n.normal=t.Vector.normalize(n.normal)}},e.calcGroupUvs=function(){e.ensureGroups();for(let t=0;t<e.groups.length;t++){const r=e.groups[t];for(const t in r.fragmentIndecies){const n=e.meshFragments[t],a=n.renderData?n.renderData:n.vertexData;if(a){const e=r.fragmentIndecies[t];if(e.length>0){const t=e[0];r.uv=a.getUvVector(t)}}}}},e.calcSmoothShading=function(){for(let t=0;t<e.meshFragments.length;t++)if(!e.meshFragments[t].renderData.normals)return;e.calcGroupNormals();for(let n=0;n<e.meshFragments.length;n++){const a=e.meshFragments[n].renderData,o=e.groupIndecies[n];if(o.length){a.normals=[];for(var t=0;t<a.vertexCount;t++){const n=e.groups[o[t]];for(var r=0;r<a.normalDimensions;r++)a.normals.push(n.normal[r])}}}},e.calcSmoothTexture=function(){e.calcGroupUvs();for(let n=0;n<e.meshFragments.length;n++){const a=e.meshFragments[n].renderData,o=e.groupIndecies[n];if(o.length){a.uvs=[];for(var t=0;t<a.vertexCount;t++){const n=e.groups[o[t]];for(var r=0;r<a.uvDimensions;r++)a.uvs.push(n.uv[r])}}}},r.setFragments=function(t){return e.meshFragments=t,r},r.initialize=function(t,n){return e.smoothShading=t,e.smoothTexture=n,e.meshFragments.forEach((t=>{t.renderData=t.vertexData.clone()})),n&&e.calcSmoothTexture(),r},r.calcTangentsFromUvs=function(){for(let r=0;r<e.meshFragments.length;r++){const n=e.meshFragments[r],a=n.renderData,o=n.vertexData;if(!a.tangents)if(o.tangents){a.tangents=[];for(let e=0;e<o.vertexCount;e++)for(var t=0;t<o.normalDimensions;t++)a.tangents.push(o.tangents[o.tangentIndex(e,t)])}else if(a.uvs){e.ensureTriangles();const t=e.fragmentTriangles[r];if(t&&t.triangles){a.tangents=[],a.tangents.length=a.normalDimensions*a.vertexCount;for(let e=0;e<a.vertexCount;e++){const r=t.vertexTriangleIndecies[e],n=t.triangles[r];n&&a.setTangentVector(e,n.tangent)}}}}return r},r.calcBitangentsFromUvs=function(){for(let r=0;r<e.meshFragments.length;r++){const n=e.meshFragments[r],a=n.renderData,o=n.vertexData;if(!a.bitangents)if(o.bitangents){a.bitangents=[];for(let e=0;e<o.vertexCount;e++)for(var t=0;t<o.normalDimensions;t++)a.bitangents.push(o.bitangents[o.bitangentIndex(e,t)])}else if(a.uvs){e.ensureTriangles();const t=e.fragmentTriangles[r];if(t&&t.triangles){a.bitangents=[],a.bitangents.length=a.normalDimensions*a.vertexCount;for(let e=0;e<a.vertexCount;e++){const r=t.vertexTriangleIndecies[e],n=t.triangles[r];n&&a.setBitangentVector(e,n.bitangent)}}}}return r},r.calcNormalsFromCross=function(){for(let r=0;r<e.meshFragments.length;r++){const a=e.meshFragments[r],o=a.renderData,i=a.vertexData;if(!o.normals)if(i.normals){o.normals=[];for(let t=0;t<i.vertexCount;t++)for(var n=0;n<i.normalDimensions;n++)o.normals.push(i.normals[i.normalIndex(t,n)])}else if(o.tangents&&o.bitangents){o.normals=[];for(let e=0;e<i.vertexCount;e++){const r=o.getTangentVector(e),a=o.getBitangentVector(e),i=t.Vector.cross(r,a);for(n=0;n<i.length;n++)o.normals.push(i[n])}}}return e.smoothShading&&e.calcSmoothShading(),r},r.calcNormalsFromGeometry=function(){for(let r=0;r<e.meshFragments.length;r++){const n=e.meshFragments[r],a=n.renderData,o=n.vertexData;if(!a.normals)if(o.normals){a.normals=[];for(let e=0;e<o.vertexCount;e++)for(var t=0;t<o.normalDimensions;t++)a.normals.push(o.normals[o.normalIndex(e,t)])}else{e.ensureTriangles();const t=e.fragmentTriangles[r];if(t&&t.triangles){a.normals=[],a.normals.length=a.normalDimensions*a.vertexCount;for(let e=0;e<a.vertexCount;e++){const r=t.vertexTriangleIndecies[e],n=t.triangles[r];n&&a.setNormalVector(e,n.normal)}}}}return e.smoothShading&&e.calcSmoothShading(),r},r.calcBitangentsFromCross=function(){for(let r=0;r<e.meshFragments.length;r++){const a=e.meshFragments[r],o=a.renderData,i=a.vertexData;if(!o.bitangents)if(i.bitangents){o.bitangents=[];for(let t=0;t<i.vertexCount;t++)for(var n=0;n<i.normalDimensions;n++)o.bitangents.push(i.bitangents[i.bitangentIndex(t,n)])}else if(o.tangents&&o.normals){o.bitangents=[];for(let e=0;e<i.vertexCount;e++){const r=o.getNormalVector(e),a=o.getTangentVector(e),i=t.Vector.cross(r,a);for(n=0;n<i.length;n++)o.bitangents.push(i[n])}}}return r},r}},816:()=>{window.frag.Model=function(t){const e=window.frag,r={name:null,parent:t,children:[],meshData:null,shader:null,material:null,transform:e.Transform().identity()},n={__private:r,animations:[],addFlattenedChildren:function(t,e){for(let n=0;n<r.children.length;n++){let a=r.children[n];e(a)&&t.push(a),a.addFlattenedChildren(t,e)}},name:function(t){return r.name=t,n},getName:function(){return r.name},transform:function(t){return r.transform=t,n},getTransform:function(){return r.transform},shader:function(t){if(t.is3d!==r.transform.is3d){const t=r.transform.is3d?"3D":"2D";console.error("Model '"+r.name+"' has a "+t+" transform and must use a "+t+" shader")}return r.shader=t,n},getShader:function(){return r.shader?r.shader:r.parent?r.parent.getShader():void 0},mesh:function(t){return r.meshData=t,n},material:function(t){return r.material=t,n},getMaterial:function(){return r.material?r.material:r.parent?r.parent.getMaterial():void 0},addChild:function(t){return t?t.__private.parent=n:t=window.frag.Model(n),r.children.push(t),t},shadeSmooth:function(t){return void 0===t&&(t=-1),r.meshData&&r.meshData.shadeSmooth(),0===t||r.children.forEach((e=>{e.shadeSmooth(t-1)})),n},shadeFlat:function(t){return void 0===t&&(t=-1),r.meshData&&r.meshData.shadeFlat(),0===t||r.children.forEach((e=>{e.shadeFlat(t-1)})),n},textureSmooth:function(t){return void 0===t&&(t=-1),r.meshData&&r.meshData.textureSmooth(),0===t||r.children.forEach((e=>{e.textureSmooth(t-1)})),n},textureFlat:function(t){return void 0===t&&(t=-1),r.meshData&&r.meshData.textureFlat(),0===t||r.children.forEach((e=>{e.textureFlat(t-1)})),n},wireframe:function(t,e){return void 0===e&&(e=-1),r.meshData&&r.meshData.wireframe(),0===e||r.children.forEach((t=>{t.wireframe(e-1)})),n},drawNormals:function(t,e,a){return void 0===a&&(a=-1),r.meshData&&r.meshData.drawNormals(t,e),0===a||r.children.forEach((r=>{r.drawNormals(t,e,a-1)})),n},addAnimation:function(t){const e=[];n.addFlattenedChildren(e,(function(t){return t.getName()}));const r=[],a=t.getChannelGraphs();for(let t=0;t<e.length;t++){const n=e[t],o=n.getName();for(let t=0;t<a.length;t++){const e=a[t];e.pattern.test(o)&&r.push({graph:e,model:n})}}return r.length>0&&n.animations.push({modelAnimation:t,childAnimations:r}),n},draw:function(t,a,o,i){let s;if(i&&r.name){const t=i[r.name];t&&(s=t.getMatrix())}let c=r.transform.getMatrix();s&&(c=r.transform.is3d?e.Matrix.m4Xm4(c,s):e.Matrix.m3Xm3(c,s));const u=a.getMatrix(),l=o.getMatrix();r.transform.is3d?(a=e.Transform(e.Matrix.m4Xm4(u,c)),o=e.Transform(e.Matrix.m4Xm4(l,c))):(a=e.Transform2D(e.Matrix.m3Xm3(u,c)),o=e.Transform2D(e.Matrix.m3Xm3(l,c)));const f=n.getShader();if(void 0!==f&&r.meshData){f.bind(t);var m=n.getMaterial();m&&m.apply(t,f),void 0!==f.uniforms.clipMatrix&&o.apply(t,f.uniforms.clipMatrix),void 0!==f.uniforms.modelMatrix&&a.apply(t,f.uniforms.modelMatrix),r.meshData.draw(t,f),f.unbind(t)}for(let e=0;e<r.children.length;e++)r.children[e].draw(t,a,o,i);return n}};return n}},312:()=>{window.frag.Scene=function(){const t={sceneObjects:[],activeCamera:null,cameraUpdated:function(){}},e={__private:t,dispose:function(){t.activeCamera&&t.activeCamera.worldToClipTransform.observableMatrix.unsubscribe(t.cameraUpdated)},addObject:function(r){return t.sceneObjects.push(r),e},removeObject:function(e){for(let r=0;r<t.sceneObjects.length;r++)if(t.sceneObjects[r]===e)return t.sceneObjects.splice(r,1),!0;return!1},camera:function(r){return t.activeCamera&&t.activeCamera.worldToClipTransform.observableMatrix.unsubscribe(t.cameraUpdated),t.activeCamera=r,r&&r.worldToClipTransform.observableMatrix.subscribe(t.cameraUpdated),e},setViewport:function(r){return t.activeCamera&&t.activeCamera.setViewport(r),e},adjustToViewport:function(r){return t.activeCamera&&t.activeCamera.adjustToViewport(r),e},draw:function(e){if(t.activeCamera)for(let r=0;r<t.sceneObjects.length;r++)t.sceneObjects[r].draw(e,t.activeCamera.worldToClipTransform)}};return e}},390:()=>{window.frag.SceneObject=function(t){const e={model:t,enabled:!0,position:null,animationPosition:null,animationMap:{}},r={__private:e,animations:{}};for(let n=0;n<t.animations.length;n++){const a=t.animations[n];for(let r=0;r<a.childAnimations.length;r++){const n=a.childAnimations[r].model.getName();if(!e.animationMap[n]){const r=window.frag.ObjectAnimationState();window.frag.debugAnimations&&(r.__private.modelName=t.getName(),r.__private.childModelName=n),e.animationMap[n]=r}}const o=window.frag.SceneObjectAnimation(a,e.animationMap);r.animations[a.modelAnimation.getName()]=o}const n=function(t,e){const r=t.getMatrix(),n=e.getMatrix();return t.is3d?frag.Transform(frag.Matrix.m4Xm4(r,n)):frag.Transform2D(frag.Matrix.m3Xm3(r,n))};return r.getPosition=function(){if(e.position)return e.position;const t=e.model.getTransform();return e.position=window.frag.ScenePosition(t.clone()),e.position},r.ensureAnimationPosition=function(){if(e.animationPosition)return e.animationPosition;const t=e.model.getTransform();return t?(e.animationPosition=window.frag.ScenePosition(t.clone()),e.animationPosition):null},r.deleteAnimationPosition=function(){return e.animationPosition=null,r},e.getModelToWorldTransform=function(){const t=r.getPosition();let a=n(e.model.getTransform(),t.getTransform());if(!e.animationPosition)return a;const o=e.animationPosition.getTransform();return n(a,o)},r.enable=function(){return e.enabled=!0,r},r.disable=function(){return e.enabled=!1,r},r.dispose=function(){return r.disable(),r},r.draw=function(t,a){if(!e.enabled)return r;const o=e.getModelToWorldTransform();if(!o)return r;let i=n(a,o);return e.model.draw(t,o,i,e.animationMap),r},r}},266:()=>{window.frag.ScenePosition=function(t){const e={scale:{x:1,y:1,z:1},rotation:{x:0,y:0,z:0},translation:{x:0,y:0,z:0},transform:t,isDirty:!0},r={__private:e};return e.ensureTransform=function(){e.isDirty&&(e.isDirty=!1,e.transform.is3d?e.transform.identity().translateXYZ(e.translation.x,e.translation.y,e.translation.z).rotateXYZ(e.rotation.x,e.rotation.y,e.rotation.z).scaleXYZ(e.scale.x,e.scale.y,e.scale.z):e.transform.identity().translateXY(e.translation.x,e.translation.y).rotate(e.rotation.z).scaleXY(e.scale.x,e.scale.y))},r.transform=function(t){return e.transform=t,e.isDirty=!0,r},r.getTransform=function(){return e.ensureTransform(),e.transform},r.getScaleX=function(){return e.scale.x},r.getScaleY=function(){return e.scale.y},r.getScaleZ=function(){return e.scale.z},r.scale=function(t){return e.scale.x=t,e.scale.y=t,e.scale.z=t,e.isDirty=!0,r},r.scaleXYZ=function(t,n,a){return e.scale.x=t,e.scale.y=n,e.scale.z=a,e.isDirty=!0,r},r.scaleX=function(t){return e.scale.x=t,e.isDirty=!0,r},r.scaleY=function(t){return e.scale.y=t,e.isDirty=!0,r},r.scaleZ=function(t){return e.scale.z=t,e.isDirty=!0,r},r.scaleBy=function(t){r.rotateXYZ(e.scale.x*t[0],e.scale.y*t[1],e.scale.z*t[2])},r.scaleByXYZ=function(t,n,a){r.rotateXYZ(e.scale.x*t,e.scale.y*n,e.scale.z*a)},r.getRotateX=function(){return e.rotation.x},r.getRotateY=function(){return e.rotation.y},r.getRotateZ=function(){return e.rotation.z},r.getRotate=function(){return e.transform.is3d?[e.rotation.x,e.rotation.y,e.rotation.z]:[e.rotation.x,e.rotation.y]},r.rotate=function(t){return e.rotation.x=t[0],t.length>1&&(e.rotation.y=t[1]),t.length>2&&(e.rotation.z=t[2]),e.isDirty=!0,r},r.rotateXYZ=function(t,n,a){return e.rotation.x=t,e.rotation.y=n,e.rotation.z=a,e.isDirty=!0,r},r.rotateX=function(t){return e.rotation.x=t,e.isDirty=!0,r},r.rotateY=function(t){return e.rotation.y=t,e.isDirty=!0,r},r.rotateZ=function(t){return e.rotation.z=t,e.isDirty=!0,r},r.rotateBy=function(t){r.rotateXYZ(e.rotation.x+t[0],e.rotation.y+t[1],e.rotation.z+t[2])},r.rotateByXYZ=function(t,n,a){r.rotateXYZ(e.rotation.x+t,e.rotation.y+n,e.rotation.z+a)},r.getLocationX=function(){return e.translation.x},r.getLocationY=function(){return e.translation.y},r.getLocationZ=function(){return e.translation.z},r.getLocation=function(){return e.transform.is3d?[e.translation.x,e.translation.y,e.translation.z]:[e.translation.x,e.translation.y]},r.location=function(t){return e.translation.x=t[0],t.length>1&&(e.translation.y=t[1]),t.length>2&&(e.translation.z=t[2]),e.isDirty=!0,r},r.locationXYZ=function(t,n,a){return e.translation.x=t,e.translation.y=n,e.translation.z=a,e.isDirty=!0,r},r.locationX=function(t){return e.translation.x=t,e.isDirty=!0,r},r.locationY=function(t){return e.translation.y=t,e.isDirty=!0,r},r.locationZ=function(t){return e.translation.z=t,e.isDirty=!0,r},r.moveBy=function(t){r.locationXYZ(e.translation.x+t[0],e.translation.y+t[1],e.translation.z+t[2])},r.moveByXYZ=function(t,n,a){r.locationXYZ(e.translation.x+t,e.translation.y+n,e.translation.z+a)},r}},288:()=>{window.frag.VertexData=function(){const t=window.frag,e=t.gl,r={},n={__private:r,primitiveType:e.TRIANGLES,vertexCount:0,verticies:void 0,vertexDimensions:3,colors:void 0,colorDimensions:3,uvs:void 0,uvDimensions:2,normals:void 0,normalDimensions:3,tangents:void 0,bitangents:void 0,clone:function(){const e=t.VertexData();return e.primitiveType=n.primitiveType,e.vertexCount=n.vertexCount,e.vertexDimensions=n.vertexDimensions,e.colorDimensions=n.colorDimensions,e.uvDimensions=n.uvDimensions,e.normalDimensions=n.normalDimensions,e.verticies=n.verticies,n.colors&&(e.colors=Array.from(n.colors)),n.uvs&&(e.uvs=Array.from(n.uvs)),n.normals&&(e.normals=Array.from(n.normals)),n.tangents&&(e.tangents=Array.from(n.tangents)),n.bitangents&&(e.bitangents=Array.from(n.bitangents)),e},vertexIndex:function(t,e){return t*n.vertexDimensions+(e||0)},colorIndex:function(t,e){return t*n.colorDimensions+(e||0)},uvIndex:function(t,e){return t*n.uvDimensions+(e||0)},normalIndex:function(t,e){return t*n.normalDimensions+(e||0)},tangentIndex:function(t,e){return t*n.normalDimensions+(e||0)},bitangentIndex:function(t,e){return t*n.normalDimensions+(e||0)}};return r.getVector=function(e,r,n){return 2===n?t.Vector.makeVectorFromArray2D(e,r):t.Vector.makeVectorFromArray3D(e,r)},r.setVector=function(t,e,r){for(i=0;i<r.length;i++)t[e+i]=r[i]},n.getVertexVector=function(t){return r.getVector(n.verticies,n.vertexIndex(t),n.vertexDimensions)},n.setVertexVector=function(t,e){return r.setVector(n.verticies,n.vertexIndex(t),e)},n.getColor=function(t){return r.getVector(n.colors,n.colorIndex(t),n.colorDimensions)},n.setColor=function(t,e){return r.setVector(n.colors,n.colorIndex(t),e)},n.getUvVector=function(t){return r.getVector(n.uvs,n.uvIndex(t),n.uvDimensions)},n.setUvVector=function(t,e){return r.setVector(n.uvs,n.uvIndex(t),e)},n.getNormalVector=function(t){return r.getVector(n.normals,n.normalIndex(t),n.normalDimensions)},n.setNormalVector=function(t,e){return r.setVector(n.normals,n.normalIndex(t),e)},n.getTangentVector=function(t){return r.getVector(n.tangents,n.tangentIndex(t),n.normalDimensions)},n.setTangentVector=function(t,e){return r.setVector(n.tangents,n.tangentIndex(t),e)},n.getBitangentVector=function(t){return r.getVector(n.bitangents,n.bitangentIndex(t),n.normalDimensions)},n.setBitangentVector=function(t,e){return r.setVector(n.bitangents,n.bitangentIndex(t),e)},n.setTriangles2D=function(t,r,a,o,i,s){return n.primitiveType=e.TRIANGLES,n.vertexDimensions=2,n.verticies=t,n.vertexCount=t.length/n.vertexDimensions,n.colorDimensions=3,n.colors=r,n.uvDimensions=2,n.uvs=a,n.normalDimensions=3,n.normals=o,n.tangents=i,n.bitangents=s,n.extractTriangles=function(t){for(let e=0;e<n.vertexCount;e+=3)t(e,e+1,e+2)},n},n.setTriangles=function(t,r,a,o,i,s){return n.primitiveType=e.TRIANGLES,n.vertexDimensions=3,n.verticies=t,n.vertexCount=t.length/n.vertexDimensions,n.colorDimensions=3,n.colors=r,n.uvDimensions=2,n.uvs=a,n.normalDimensions=3,n.normals=o,n.tangents=i,n.bitangents=s,n.extractTriangles=function(t){for(let e=0;e<n.vertexCount;e+=3)t(e,e+1,e+2)},n},n.setTriangleStrip=function(t,r,a,o,i,s){return n.primitiveType=e.TRIANGLE_STRIP,n.vertexDimensions=3,n.verticies=t,n.vertexCount=t.length/n.vertexDimensions,n.colorDimensions=3,n.colors=r,n.uvDimensions=2,n.uvs=a,n.normalDimensions=3,n.normals=o,n.tangents=i,n.bitangents=s,n.extractTriangles=function(t){const e=n.vertexCount-2;for(let r=0;r<e;r++)0==(1&r)?t(r,r+1,r+2):t(r+2,r+1,r)},n},n.setTriangleFan=function(t,r,a,o,i,s){return n.primitiveType=e.TRIANGLE_FAN,n.vertexDimensions=3,n.verticies=t,n.vertexCount=t.length/n.vertexDimensions,n.colorDimensions=3,n.colors=r,n.uvDimensions=2,n.uvs=a,n.normalDimensions=3,n.normals=o,n.tangents=i,n.bitangents=s,n.extractTriangles=function(t){const e=n.vertexCount-2;for(let r=0;r<e;r++)t(0,r+1,r+2)},n},n.setLines2D=function(t,r,a,o){return n.primitiveType=e.LINES,n.vertexDimensions=2,n.verticies=t,n.vertexCount=t.length/n.vertexDimensions,n.colorDimensions=3,n.colors=r,n.uvDimensions=2,n.uvs=a,n.normalDimensions=3,n.normals=o,n.tangents=null,n.bitangents=null,n.extractTriangles=function(){},n},n.setLines=function(t,r,a,o){return n.primitiveType=e.LINES,n.vertexDimensions=3,n.verticies=t,n.vertexCount=t.length/n.vertexDimensions,n.colorDimensions=3,n.colors=r,n.uvDimensions=2,n.uvs=a,n.normalDimensions=3,n.normals=o,n.tangents=null,n.bitangents=null,n.extractTriangles=function(){},n},n.setLineStrip=function(t,r,a,o){return n.primitiveType=e.LINE_STRIP,n.vertexDimensions=3,n.verticies=t,n.vertexCount=t.length/n.vertexDimensions,n.colorDimensions=3,n.colors=r,n.uvDimensions=2,n.uvs=a,n.normalDimensions=3,n.normals=o,n.tangents=null,n.bitangents=null,n.extractTriangles=function(){},n},n}},198:()=>{window.frag.createShader=function(t,e,r){const n=window.frag.gl;var a=n.createShader(e);if(n.shaderSource(a,r),n.compileShader(a),n.getShaderParameter(a,n.COMPILE_STATUS))return a;console.error("Failed to compile shader "+t),console.log(n.getShaderInfoLog(a)),n.deleteShader(a)},window.frag.createProgram=function(t,e,r){const n=window.frag,a=n.gl;var o=a.createProgram();if(a.attachShader(o,e),a.attachShader(o,r),a.linkProgram(o),a.getProgramParameter(o,a.LINK_STATUS))return o;console.error("Failed to link shaders into program "+t),console.log(n.gl.getProgramInfoLog(o)),a.deleteProgram(o)},window.frag.Shader=function(){const t="None",e={name:"Custom",verticies:"XYZ",x:0,y:0,z:0,colors:t,matrix:"mat4",textureCoords:t,diffuseTexture:t,emmissiveTexture:t,displacementTexture:t,normalMap:t,roughnessTexture:t,shininessTexture:t,metalinessTexture:t,normals:t,tangents:t,bitangents:t,directionalLight:t,ambientLight:t},r={__private:e,name:function(t){return e.name=t,r},verticiesXY:function(t){return e.verticies="XY",e.z=t,r},verticiesXZ:function(t){return e.verticies="XZ",e.y=t,r},verticiesYZ:function(t){return e.verticies="YZ",e.x=t,r},verticiesXYZ:function(){return e.verticies="XYZ",r},verticiesNone:function(){return e.verticies=t,r},matrix2D:function(){return e.matrix="mat3",r},matrix3D:function(){return e.matrix="mat4",r},matrixNone:function(){return e.matrix=t,r},normals:function(){return e.normals="vec3",r},colorsRGB:function(){return e.colors="vec3",r},colorsRGBA:function(){return e.colors="vec4",r},colorsNone:function(){return e.colors=t,r},diffuseTexture:function(){return e.diffuseTexture="RGB",e.colors=t,e.textureCoords===t&&(e.textureCoords="vec2"),r},emmissiveTexture:function(){return e.emmissiveTexture="RGB",e.textureCoords===t&&(e.textureCoords="vec2"),r},normalMapStandard:function(){return e.normalMap="Standard",e.textureCoords===t&&(e.textureCoords="vec2"),e.normals===t&&(e.normals="vec3"),e.tangents===t&&(e.tangents="vec3"),r},normalMapOpenGL:function(){return e.normalMap="OpenGL",e.textureCoords===t&&(e.textureCoords="vec2"),e.normals===t&&(e.normals="vec3"),e.tangents===t&&(e.tangents="vec3"),r},displacementTextureRaised:function(){return e.displacementTexture="Raised",e.textureCoords===t&&(e.textureCoords="vec2"),e.normals===t&&(e.normals="vec3"),r},displacementTextureSunken:function(){return e.displacementTexture="Sunken",e.textureCoords===t&&(e.textureCoords="vec2"),e.normals===t&&(e.normals="vec3"),r},displacementTextureSigned:function(){return e.displacementTexture="Signed",e.textureCoords===t&&(e.textureCoords="vec2"),e.normals===t&&(e.normals="vec3"),r},tangents:function(){return e.tangents="vec3",e.normals===t&&(e.normals="vec3"),r},bitangents:function(){return e.bitangents="vec3",e.normals===t&&(e.normals="vec3"),r},directionalLightColor:function(){return r.matrix3D(),e.directionalLight="Color",e.ambientLight===t&&(e.ambientLight="Balanced"),e.normals===t&&(e.normals="vec3"),r},directionalLightWhite:function(){return r.matrix3D(),e.directionalLight="White",e.ambientLight===t&&(e.ambientLight=t),e.normals===t&&(e.normals="vec3"),r},directionalLightGrey:function(){return r.matrix3D(),e.directionalLight="Grey",e.ambientLight===t&&(e.ambientLight="Balanced"),e.normals===t&&(e.normals="vec3"),r},directionalLightNone:function(){return e.directionalLight=t,r},ambientLightBalanced:function(){return e.ambientLight="Balanced",r},ambientLightNone:function(){return e.ambientLight=t,r},ambientLightFixed:function(){return e.ambientLight="Fixed",r}};return e.addAttributeDeclarations=function(r){"XYZ"===e.verticies?r.vSource+="attribute vec4 a_position;\n":e.verticies!==t&&(r.vSource+="attribute vec2 a_position;\n"),e.colors!==t&&(r.vSource+="attribute "+e.colors+" a_color;\n"),e.textureCoords!==t&&(r.vSource+="attribute "+e.textureCoords+" a_texcoord;\n"),e.normals!==t&&(r.vSource+="attribute "+e.normals+" a_normal;\n"),e.tangents!==t&&(r.vSource+="attribute "+e.tangents+" a_tangent;\n"),e.bitangents!==t&&(r.vSource+="attribute "+e.bitangents+" a_bitangent;\n")},e.addUniformDeclarations=function(r){e.matrix!==t&&(e.directionalLight!==t&&(r.vSource+="uniform "+e.matrix+" u_modelMatrix;\n"),r.vSource+="uniform "+e.matrix+" u_clipMatrix;\n"),e.directionalLight!==t&&(r.vSource+="uniform vec3 u_lightDirection;\n"),"Color"===e.directionalLight&&(r.vSource+="uniform vec3 u_lightColor;\n"),e.displacementTexture!==t&&(r.vSource+="uniform float u_displacementScale;\n"),e.displacementTexture===t&&e.roughnessTexture===t&&e.shininessTexture==t||(r.vSource+="uniform sampler2D u_surface;\n"),e.normalMap!==t&&(r.fSource+="uniform sampler2D u_normalMap;\n"),e.textureCoords!==t&&(e.diffuseTexture!==t&&(r.fSource+="uniform sampler2D u_diffuse;\n"),e.emmissiveTexture!==t&&(r.fSource+="uniform sampler2D u_emmissive;\n")),e.ambientLight!==t&&(r.fSource+="uniform float u_ambientLight;\n")},e.addVaryingDeclarations=function(r){const n=function(t,e){const n="varying "+t+" "+e+";\n";r.vSource+=n,r.fSource+=n};e.textureCoords!==t&&n(e.textureCoords,"v_texcoord"),e.colors!==t&&n(e.colors,"v_color"),e.directionalLight!==t&&(n("vec3","v_lightDirection"),"Color"===e.directionalLight&&n("vec3","v_lightColor"),e.normalMap===t&&n(e.normals,"v_normal"))},e.addLogic=function(r){"XYZ"===e.verticies?r.vSource+="  vec4 position = a_position;\n":e.verticies!==t&&(r.vSource+="  vec2 position = a_position;\n"),e.displacementTexture===t&&e.roughnessTexture===t&&e.shininessTexture==t||(r.vSource+="  vec4 surface = texture2D(u_surface, a_texcoord);\n"),e.displacementTexture!==t&&"XYZ"===e.verticies&&"vec3"===e.normals&&("Sunken"===e.displacementTexture?r.vSource+="  float displacement = -surface.r;\n":"Signed"===e.displacementTexture?r.vSource+="  float displacement = surface.r * 2.0 - 1.0;\n":"Raised"===e.displacementTexture&&(r.vSource+="  float displacement = surface.r;\n"),r.vSource+="  position = vec4(position.xyz + (a_normal * displacement * u_displacementScale), position.w);\n"),"XYZ"===e.verticies?r.vSource+="  position = u_clipMatrix * position;\n":e.verticies!==t&&(r.vSource+="  position = (u_clipMatrix * vec3(position, 1)).xy;\n"),"XYZ"===e.verticies?r.vSource+="  gl_Position = position;\n":"XY"===e.verticies?r.vSource+="  gl_Position = vec4(position, "+e.z+", 1);\n":"XZ"===e.verticies?r.vSource+="  gl_Position = vec4(position.x, "+e.y+", position.y, 1);\n":"YZ"===e.verticies&&(r.vSource+="  gl_Position = vec4("+e.x+", position, 1);\n"),e.textureCoords!==t&&(r.vSource+="  v_texcoord = a_texcoord;\n"),e.directionalLight!==t?(e.normalMap!==t?(r.vSource+="  vec3 T = normalize(vec3(u_modelMatrix * vec4(a_tangent, 0.0)));\n",e.bitangents!==t?r.vSource+="  vec3 B = normalize(vec3(u_modelMatrix * vec4(a_bitangent, 0.0)));\n":r.vSource+="  vec3 B = normalize(vec3(u_modelMatrix * vec4(cross(a_normal, a_tangent), 0.0)));\n",r.vSource+="  vec3 N = normalize(vec3(u_modelMatrix * vec4(a_normal, 0.0)));\n",r.vSource+="  mat3 TBN = transpose(mat3(T, B, N));\n",r.vSource+="  v_lightDirection = TBN * u_lightDirection;\n",r.fSource+="  vec3 normal = texture2D(u_normalMap, v_texcoord).rgb * 2.0 - 1.0;\n"):(r.vSource+="  v_normal = (u_modelMatrix * vec4(a_normal, 0)).xyz;\n",r.vSource+="  v_lightDirection = u_lightDirection;\n",r.fSource+="  vec3 normal = normalize(v_normal);\n"),r.fSource+="  vec3 lightDirection = v_lightDirection;\n",r.fSource+="  float light = max(dot(normal, lightDirection), 0.0);\n",e.ambientLight!==t&&(r.fSource+="  light += u_ambientLight;\n")):e.ambientLight!==t&&(r.fSource+="  float light = u_ambientLight;\n"),"Color"===e.directionalLight&&(r.vSource+="  v_lightColor = u_lightColor;\n"),e.colors===t?r.fSource+="  gl_FragColor = vec4(0, 0, 0, 1.0);\n":"vec4"===e.colors?(r.vSource+="  v_color = a_color;\n",r.fSource+="  gl_FragColor = v_color;\n"):(r.vSource+="  v_color = a_color;\n",r.fSource+="  gl_FragColor = vec4(v_color, 1.0);\n"),"vec2"===e.textureCoords&&"RGB"===e.diffuseTexture&&(r.fSource+="  gl_FragColor += texture2D(u_diffuse, v_texcoord);\n"),e.ambientLight===t&&e.directionalLight===t||(r.fSource+="  gl_FragColor.rgb *= light;\n"),"vec2"===e.textureCoords&&"RGB"===e.emmissiveTexture&&(r.fSource+="  gl_FragColor.rgb += texture2D(u_emmissive, v_texcoord).rgb;\n")},r.compile=function(){const r={name:e.name,vSource:"",fSource:"precision mediump float;\n",attributes:{},uniforms:{},is3d:"mat4"===e.matrix};e.addAttributeDeclarations(r),e.addUniformDeclarations(r),e.addVaryingDeclarations(r),e.directionalLight!==t&&(r.vSource+="highp mat3 transpose(in highp mat3 inMatrix) {\n",r.vSource+="    highp vec3 i0 = inMatrix[0];\n",r.vSource+="    highp vec3 i1 = inMatrix[1];\n",r.vSource+="    highp vec3 i2 = inMatrix[2];\n",r.vSource+="    highp mat3 outMatrix = mat3(\n",r.vSource+="        vec3(i0.x, i1.x, i2.x),\n",r.vSource+="        vec3(i0.y, i1.y, i2.y),\n",r.vSource+="        vec3(i0.z, i1.z, i2.z)\n",r.vSource+="    );\n",r.vSource+="    return outMatrix;\n",r.vSource+="}\n"),r.vSource+="void main() {\n",r.fSource+="void main() {\n",e.addLogic(r),r.vSource+="}\n",r.fSource+="}\n",frag.debugShaderBuilder&&(console.log("\n// "+r.name+" vertext shader\n"+r.vSource),console.log("\n// "+r.name+" fragment shader\n"+r.fSource));const n=frag.createShader(r.name,frag.gl.VERTEX_SHADER,r.vSource),a=frag.createShader(r.name,frag.gl.FRAGMENT_SHADER,r.fSource);if(r.program=frag.createProgram(r.name,n,a),!r.program)return null;const o=[],i=[];if(e.verticies!==t&&(r.attributes.position=frag.gl.getAttribLocation(r.program,"a_position")),e.colors!==t&&(r.attributes.color=frag.gl.getAttribLocation(r.program,"a_color")),e.textureCoords!==t&&(r.attributes.texture=frag.gl.getAttribLocation(r.program,"a_texcoord")),e.normals!==t&&(r.attributes.normal=frag.gl.getAttribLocation(r.program,"a_normal")),e.tangents!==t&&(r.attributes.tangent=frag.gl.getAttribLocation(r.program,"a_tangent")),e.bitangents!==t&&(r.attributes.bitangent=frag.gl.getAttribLocation(r.program,"a_bitangent")),e.matrix!==t&&(e.directionalLight!==t&&(r.uniforms.modelMatrix=frag.gl.getUniformLocation(r.program,"u_modelMatrix")),r.uniforms.clipMatrix=frag.gl.getUniformLocation(r.program,"u_clipMatrix")),e.diffuseTexture!==t&&(r.uniforms.diffuse=frag.gl.getUniformLocation(r.program,"u_diffuse")),e.emmissiveTexture!==t&&(r.uniforms.emmissive=frag.gl.getUniformLocation(r.program,"u_emmissive")),e.displacementTexture===t&&e.roughnessTexture===t&&e.shininessTexture==t||(r.uniforms.surface=frag.gl.getUniformLocation(r.program,"u_surface")),e.displacementTexture!==t&&(r.uniforms.displacementScale=frag.gl.getUniformLocation(r.program,"u_displacementScale"),o.push((function(t){t.uniform1f(r.uniforms.displacementScale,r._displacementScale)})),r._displacementScale=.2,r.displacementScale=function(t){return r._displacementScale=t,r}),e.normalMap!==t&&(r.uniforms.normalMap=frag.gl.getUniformLocation(r.program,"u_normalMap")),e.ambientLight!==t&&(r.uniforms.ambientLight=frag.gl.getUniformLocation(r.program,"u_ambientLight"),o.push((function(t){t.uniform1f(r.uniforms.ambientLight,r._ambientLight)})),r._ambientLight=.5),e.directionalLight!==t){r.uniforms.lightDirection=frag.gl.getUniformLocation(r.program,"u_lightDirection"),o.push((function(t){t.uniform3fv(r.uniforms.lightDirection,r._lightDirection)})),"Color"===e.directionalLight&&(r.uniforms.lightColor=frag.gl.getUniformLocation(r.program,"u_lightColor"),o.push((function(t){t.uniform3fv(r.uniforms.lightColor,r._lightColor)})),r.lightColor=function(t){return r._lightColor=t,r});const t="Balanced"===e.ambientLight;r.lightDirection=function(e){const n=window.frag.Vector.length(e);return n>1?(r._lightDirection=[-e[0]/n,-e[1]/n,-e[2]/n],t&&(r._ambientLight=0)):(r._lightDirection=[-e[0],-e[1],-e[2]],t&&(r._ambientLight=1-n)),r},"White"===e.directionalLight?r.lightDirection([.8,-.2,.8]):"Grey"===e.directionalLight&&r.lightDirection([.5,-.1,.5])}return r.bind=function(t){t.useProgram(r.program),o.forEach((e=>e(t)))},r.unbind=function(t){i.forEach((e=>e(t)))},r},r}},743:()=>{window.frag.uiShader=window.frag.Shader().name("UI").verticiesXY(-1).matrix2D().diffuseTexture().compile()},492:()=>{window.frag.BasicCube=function(t){const e=1/3,r=2/3,n=[1,1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1],a=[0,1,0,0,0,r,0,e,1,1,1,0,1,e,1,r];return function(e){const r=[],o=[],i=t.color?[]:void 0;for(var s=0;s<e.length;s++){const c=e[s];r.push(n[3*c+0]),r.push(n[3*c+1]),r.push(n[3*c+2]),t.color&&t.color.array.forEach((t=>{i.push(t)})),o.push(a[2*c+0]),o.push(a[2*c+1])}return window.frag.MeshData().addTriangleStrip(r,i,o,r)}([3,2,6,7,4,2,0,3,1,6,5,4,1,0])}},914:()=>{window.frag.Cube=function(t,e){void 0===(e=e||{}).drawFront&&(e.drawFront=!0),void 0===e.drawBack&&(e.drawBack=!0),void 0===e.drawTop&&(e.drawTop=!0),void 0===e.drawBottom&&(e.drawBottom=!0),void 0===e.drawLeft&&(e.drawLeft=!0),void 0===e.drawRight&&(e.drawRight=!0);let r=1/4,n=.5,a=1/3,o=2/3;const i=[[-1,-1,-1],[1,-1,-1],[1,1,-1],[-1,1,-1],[1,-1,1],[-1,-1,1],[-1,1,1],[1,1,1]],s=[],c=[],u=e.color?[]:void 0,l=function(t){s.push(t[0]),s.push(t[1]),s.push(t[2]),e.color&&e.color.forEach((t=>{u.push(t)}))},f=function(t,e){c.push(t),c.push(e)},m=function(t,e,r,n){l(t),l(e),l(r),l(n),l(r),l(e)},d=function(t,e,r,n){f(r,e),f(r,n),f(t,e),f(t,n),f(t,e),f(r,n)},g=function(e,r,n,a,o,s,c){for(var u=0;u<t;u++){const l=u/t,f=(u+1)/t,g=(c-o)*l+o,h=(c-o)*f+o;for(hFacet=0;hFacet<t;hFacet++){const o=hFacet/t,c=(hFacet+1)/t,u=window.frag.Vector,v=u.sub(i[n],i[r]),p=u.sub(i[e],i[r]),x=u.add(u.add(i[r],u.mult(p,o)),u.mult(v,l)),T=u.add(u.add(i[r],u.mult(p,c)),u.mult(v,l)),w=u.add(u.add(i[r],u.mult(p,o)),u.mult(v,f)),b=u.add(u.add(i[r],u.mult(p,c)),u.mult(v,f));m(T,b,x,w),d((s-a)*o+a,g,(s-a)*c+a,h)}}};return e.duplicateTexture?(e.drawFront&&g(1,0,3,1,1,0,0),e.drawBottom&&g(4,5,0,1,1,0,0),e.drawLeft&&g(0,5,6,1,1,0,0),e.drawRight&&g(4,1,2,1,1,0,0),e.drawBack&&g(5,4,7,1,1,0,0),e.drawTop&&g(6,7,2,1,1,0,0)):(e.drawFront&&g(1,0,3,r,o,0,a),e.drawBottom&&g(4,5,0,n,o,r,a),e.drawLeft&&g(0,5,6,n,o,r,1),e.drawRight&&g(4,1,2,r,a,n,0),e.drawBack&&g(5,4,7,n,a,.75,o),e.drawTop&&g(6,7,2,.75,a,1,o)),window.frag.MeshData().addTriangles(s,u,c)}},499:()=>{window.frag.Cylinder=function(t,e){t=t||32;const r=[0,0,-1],n=[.5,.5],a=[0,0,-1],o=e.color?Array.from(e.color):void 0,i=[0,0,1],s=[.5,.5],c=[0,0,1],u=e.color?Array.from(e.color):void 0,l=[],f=e.color?[]:void 0,m=[],d=[],g=2*Math.PI/t;for(var h=0;h<=t;h++){const t=-h*g,i=Math.sin(t),s=Math.cos(t);r.push(i),r.push(s),r.push(-1),e.color&&e.color.forEach((t=>o.push(t))),n.push(.5*(i+1)),n.push(.5*(s+1)),a.push(i),a.push(s),a.push(-1),l.push(i),l.push(s),l.push(-1),l.push(i),l.push(s),l.push(1),e.color&&(e.color.forEach((t=>f.push(t))),e.color.forEach((t=>f.push(t)))),m.push(.5*(i+1)),m.push(.5*(s+1)),m.push(.5*(i+1)),m.push(.5*(s+1)),d.push(i),d.push(s),d.push(0),d.push(i),d.push(s),d.push(0)}for(h=0;h<=t;h++){const t=h*g,r=Math.sin(t),n=Math.cos(t);i.push(r),i.push(n),i.push(1),e.color&&e.color.forEach((t=>u.push(t))),s.push(.5*(r+1)),s.push(.5*(n+1)),c.push(r),c.push(n),c.push(1)}return l.push(0),l.push(1),l.push(1),e.color&&e.color.forEach((t=>f.push(t))),m.push(.5),m.push(1),d.push(0),d.push(1),d.push(0),window.frag.MeshData().addTriangleFan(r,o,n,a).addTriangleFan(i,u,s,c).addTriangleStrip(l,f,m,d)}},22:()=>{window.frag.Disc=function(t,e){t=t||32;const r=[0,0,0],n=[.5,.5],a=[0,0,-1],o=2*Math.PI/t;for(var i=0;i<=t;i++){const t=-i*o,e=Math.sin(t),s=Math.cos(t);r.push(e),r.push(s),r.push(0),a.push(0),a.push(0),a.push(-1),n.push(.5*(e+1)),n.push(.5*(s+1))}return window.frag.MeshData().addTriangleFan(r,n,a)}},950:()=>{window.frag.Plane=function(t,e){if(e=e||{},1===(t=t||1)){const t=e.color||[0,0,0],r=new Float32Array([1,-1,0,1,1,0,-1,-1,0,-1,1,0,t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],t[0],t[1],t[2],1,0,1,1,0,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0]);return window.frag.MeshData().fromBuffer(r.buffer,3,4,window.frag.gl.TRIANGLE_STRIP,0*Float32Array.BYTES_PER_ELEMENT,12*Float32Array.BYTES_PER_ELEMENT,24*Float32Array.BYTES_PER_ELEMENT,32*Float32Array.BYTES_PER_ELEMENT,44*Float32Array.BYTES_PER_ELEMENT,56*Float32Array.BYTES_PER_ELEMENT)}const r=[],n=[],a=[],o=e.color?[]:void 0,i=function(t,i){r.push(t),r.push(i),r.push(0),e.color&&e.color.forEach((t=>o.push(t))),n.push(.5*(t+1)),n.push(.5*(i+1)),a.push(0),a.push(0),a.push(-1)};for(var s=0;s<t;s++){const e=2*(t-s-1)/t-1,r=2*(t-s)/t-1;if(0==(1&s)){i(1,e);for(var c=0;c<t;c++){const n=2*(t-c-1)/t-1;i(2*(t-c)/t-1,r),i(n,e)}i(-1,r)}else{for(i(-1,r),c=0;c<t;c++){const n=2*(c+1)/t-1;i(2*c/t-1,e),i(n,r)}i(1,e)}}return window.frag.MeshData().addTriangleStrip(r,o,n,a)}},306:()=>{window.frag.SeparatedCube=function(t,e){const r=window.frag.MeshData(),n=1/4,a=.5,o=1/3,i=2/3,s=[-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,1,-1,1,-1,-1,1,-1,1,1,1,1,1],c=function(t,n,a,o){for(var i=0;i<1;i++){const i=[a[0],n[1],a[0],a[1],n[0],n[1],n[0],a[1]],u=[],l=[],f=e.color?[]:void 0;for(hFacet=0;hFacet<1;hFacet++)for(var c=0;c<4;c++)u.push(s[3*t[c]+0]),u.push(s[3*t[c]+1]),u.push(s[3*t[c]+2]),e.color&&e.color.forEach((t=>f.push(t))),l.push(o[0]),l.push(o[1]),l.push(o[2]);r.addTriangleStrip(u,f,i,u)}};return c([1,2,0,3],[n,i],[0,o],[0,0,-1]),c([4,1,5,0],[a,i],[n,o],[0,-1,0]),c([0,3,5,6],[a,i],[n,1],[-1,0,0]),c([4,7,1,2],[n,o],[a,0],[1,0,0]),c([5,6,4,7],[a,o],[.75,i],[0,0,1]),c([6,3,7,2],[.75,o],[1,i],[0,1,0]),r}}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r(601),r(197),r(996),r(904),r(607),r(346),r(670),r(437),r(198),r(743),r(394),r(655),r(288),r(175),r(3),r(816),r(266),r(390),r(312),r(270),r(14),r(906),r(627),r(23),r(363),r(890),r(889),r(600),r(622),r(666),r(201),r(950),r(22),r(499),r(492),r(914),r(306),r(237),r(583),r(96)})();
//# sourceMappingURL=frag.min.js.map